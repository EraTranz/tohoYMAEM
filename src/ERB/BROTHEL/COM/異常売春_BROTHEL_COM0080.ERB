;=============================================================================
;特殊性癖売春の処理
;=============================================================================
;-------------------------------------------------
;売春コマンド実行可能判定処理
;-------------------------------------------------
@PROSTITUTE_ABLE_COM80, ARG
;キャラが売春可能であるかの共通判定処理を満たしている
SIF BROTHEL_COM_ABLE_COMMON(ARG) == 0
	RETURN 0
;娼館に淫具が無いとダメ
SIF (FLAG:3000 & 2) == 0
	RETURN 0
;異常経験が10以上あれば実行可能
SIF EXP:ARG:異常経験 >= 10
	RETURN 1
;一定の拡張経験がないとダメ
SIF EXP:ARG:Ｖ拡張経験 < 10 && EXP:ARG:Ａ拡張経験 < 10
	RETURN 0
;一定の調教排泄経験がないとダメ
SIF EXP:ARG:調教排泄経験 < 5
	RETURN 0
RETURN 1

;=============================================================================
;選択可能処理
;=============================================================================
@JUDGE_PROSTITUTE_COM81, ARG
RETURN 1
@JUDGE_PROSTITUTE_COM82, ARG
RETURN 1
@JUDGE_PROSTITUTE_COM83, ARG
;尿道開発経験10以上必要
SIF EXP:ARG:尿道開発経験 < 10
	RETURN 0
RETURN 1
@JUDGE_PROSTITUTE_COM84, ARG
;露出癖LV3以上必要人魚はダメ
SIF ABL:ARG:露出癖 < 3 || TALENT:ARG:人魚
	RETURN 0
RETURN 1
@JUDGE_PROSTITUTE_COM85, ARG
;尿道開発経験10以上必要
SIF EXP:ARG:尿道開発経験 < 10 || ABL:ARG:露出癖 < 3 || TALENT:ARG:人魚
	RETURN 0
RETURN 1
@JUDGE_PROSTITUTE_COM86, ARG
;当然、動物小屋持ちじゃないとダメ
SIF FLAG:72 < 3 || EXP:ARG:動物性愛経験 < 10 || EXP:ARG:異常経験 < 10
	RETURN 0
RETURN 1
;-------------------------------------------------
;売春コマンドの分岐処理
;-------------------------------------------------
@PROSTITUTE_COM80, ARG
#LOCALSIZE 1
CALL CHOOSE_PROSTITUTE_COM, ARG, 8
SELECTCOM = RESULT

SIF TALENT:MASTER:998
	PRINTFORML SELECTCOM = {SELECTCOM}

;顧客の設定
CALL PROSTITUTE_SET_NEW_CUSTOMER_TYPE1, ARG

;欲望をチェックする。欲望が相手の欲望を上回るかどうか。成功なら欲望レベルの２倍、失敗なら１倍入ります。
;CBVA売春では、相手の欲望の最大値が4です。
LOCAL = RAND:5
IF LOCAL <= ABL:ARG:欲望
	TFLAG:408 = LOCAL + ABL:ARG:欲望 * 2
ELSE
	TFLAG:408 = LOCAL + ABL:ARG:欲望
ENDIF

;相手からの行動が発生します。相手の技巧がこちらの欲望以下の場合、不満そうな表情が出る可能性があります。
;相手の技巧＋こちらの従順の２倍＞こちらの欲望＋３なら、問題なく行為を露出癖と奉仕精神を加える事が出来ます。
;足りない場合は加えられません。
LOCAL = MAX(RAND:3 + (ABL:ARG:従順 * 2) - 3, 0)
SIF LOCAL >= ABL:ARG:技巧
	TFLAG:408 += (ABL:ARG:奉仕精神 + ABL:ARG:露出癖)

;従順がLV3以上ないと、著しく微妙になります
SIF ABL:ARG:従順 < 3
	TFLAG:408 /= 10

;………………………………………………
;選択された売春コマンドを実行
;………………………………………………
;ここからは、プレイ内容の領分に入ってきますので、分岐後に任せます。
;ここまでの満足度は合計最大60点。
;プレイ内容の方で20点。
;結果、最大80ポイント、平均40程度の満足度になります。ランダムが40を占めるので、割と安定しません。
;ただし、素質的な要因がある場合は80ポイントを突破をしても構いません。割とアバウト。
TRYCCALLFORM PROSTITUTE_COM{SELECTCOM}, ARG
	SIF RESULT == 1
		RETURN 1
CATCH
ENDCATCH
RETURN 0

;=============================================================================
;異常売春(浣腸)の処理
;=============================================================================
;-------------------------------------------------
;売春コマンド処理
;-------------------------------------------------
@PROSTITUTE_COM81, ARG
LOCAL = TFLAG:401 / 5
DOWNBASE:ARG:0 += 25 * LOCAL
DOWNBASE:ARG:1 += 50 * LOCAL

PRINTL 特殊性癖売春 -浣腸-

;Ａ感覚、欲望、技巧、露出癖、マゾっ気、排泄中毒をみる
TFLAG:408 += ABL:ARG:Ａ感覚 + ABL:ARG:欲望 + ABL:ARG:技巧 + ABL:ARG:露出癖 + ABL:ARG:マゾっ気 + ABL:ARG:排泄中毒

;[汚れ無視]
SIF TALENT:ARG:汚れ無視
	TIMES TFLAG:408, 2.0

CALL PROSTITUTE_NEW_CUSTOMER_SATISFACTION, ARG

TCVAR:ARG:Ａ経験 = TFLAG:401 / 5
TCVAR:ARG:調教排泄経験 = TFLAG:401 / 5
TCVAR:ARG:露出快楽経験 = TFLAG:401 * 2
TCVAR:ARG:苦痛快楽経験 = TFLAG:401
TCVAR:ARG:Ａ拡張経験 = TFLAG:401 / 5
TCVAR:ARG:Ａ快楽経験 = TFLAG:401 / 5

;ビデオ撮影中
SIF TFLAG:403 & 16
	TCVAR:ARG:被写経験 = ( RAND:10 < 3 ) ? 2 # 1

TFLAG:405 = 80
RETURN 1

;-------------------------------------------------
;売春コマンドの地の文
;-------------------------------------------------
@SYSTXT_MESSAGE_PROSTITUTION_COM81

;=============================================================================
;異常売春(フィスト)の処理
;=============================================================================
;-------------------------------------------------
;売春コマンド処理
;-------------------------------------------------
@PROSTITUTE_COM82, ARG
LOCAL = TFLAG:401 / 5
DOWNBASE:ARG:0 += 30 * LOCAL
DOWNBASE:ARG:1 += 60 * LOCAL

LOCALS:0 = 特殊性癖売春 -ヴァギナフィスト-
LOCALS:1 = 特殊性癖売春 -アナルフィスト-

SELECTCASE (ABL:ARG:Ｖ感覚 - ABL:ARG:Ａ感覚)
	CASE IS < 0
		TFLAG:99 = 0
		LOCAL = EXP:ARG:Ｖ拡張経験
	CASE 0
		TFLAG:99 = RAND:2
		LOCAL = EXP:ARG:(32 + TFLAG:99)
	CASE IS > 0
		TFLAG:99 = 1
		LOCAL = EXP:ARG:Ａ拡張経験
ENDSELECT

PRINTFORML %LOCALS:(TFLAG:99)%

;Ｖ/Ａ感覚、欲望、技巧、露出癖、マゾっ気、排泄中毒をみる
TFLAG:408 += MAX(ABL:ARG:Ｖ感覚, ABL:ARG:Ａ感覚) + ABL:ARG:欲望 + ABL:ARG:技巧 + ABL:ARG:露出癖 + ABL:ARG:マゾっ気

SELECTCASE LOCAL
	CASE IS <= 15
		
	CASE IS <= 50
		TIMES TFLAG:408, 1.5
	CASE IS <= 99
		TIMES TFLAG:408, 1.8
	CASEELSE
		TIMES TFLAG:408, 2.0
ENDSELECT

CALL PROSTITUTE_NEW_CUSTOMER_SATISFACTION, ARG

TCVAR:ARG:(TFLAG:99) = TFLAG:401 / 5
TCVAR:ARG:絶頂経験 = TFLAG:401 / 5
TCVAR:ARG:露出快楽経験 = TFLAG:401 * 2
TCVAR:ARG:苦痛快楽経験 = TFLAG:401 * 3
TCVAR:ARG:(32 + TFLAG:99) = TFLAG:401 / 5

;ビデオ撮影中
SIF TFLAG:403 & 16
	TCVAR:ARG:被写経験 = ( RAND:10 < 3 ) ? 2 # 1
TFLAG:405 = 80
RETURN 1

;-------------------------------------------------
;売春コマンドの地の文
;-------------------------------------------------
@SYSTXT_MESSAGE_PROSTITUTION_COM82


;=============================================================================
;異常売春(放尿)の処理
;=============================================================================
;-------------------------------------------------
;売春コマンド処理
;-------------------------------------------------
@PROSTITUTE_COM83, ARG
DOWNBASE:ARG:0 += 20
DOWNBASE:ARG:1 += 50

PRINTL 特殊性癖売春 -放尿-

;欲望、技巧、露出癖、マゾっ気、排泄中毒をみる
TFLAG:408 += ABL:ARG:欲望 + ABL:ARG:技巧 + ABL:ARG:露出癖 + ABL:ARG:マゾっ気 + ABL:ARG:排泄中毒

;[汚れ無視]、
SIF TALENT:ARG:汚れ無視
	TIMES TFLAG:408, 2.0

CALL PROSTITUTE_NEW_CUSTOMER_SATISFACTION, ARG

TCVAR:ARG:放尿経験 = TFLAG:401 / 5
TCVAR:ARG:露出快楽経験 = TFLAG:401 * 2

;ビデオ撮影中
SIF TFLAG:403 & 16
	TCVAR:ARG:被写経験 = ( RAND:10 < 3 ) ? 2 # 1
TFLAG:405 = 80
RETURN 1

;-------------------------------------------------
;売春コマンドの地の文
;-------------------------------------------------
@SYSTXT_MESSAGE_PROSTITUTION_COM83

;=============================================================================
;異常売春(野外浣腸)の処理
;=============================================================================
;-------------------------------------------------
;売春コマンド処理
;-------------------------------------------------
@PROSTITUTE_COM84, ARG
LOCAL = TFLAG:401 / 5
DOWNBASE:ARG:0 += 25 * LOCAL
DOWNBASE:ARG:1 += 50 * LOCAL

PRINTL 特殊性癖売春 -野外浣腸-

;Ａ感覚、欲望、技巧、露出癖、マゾっ気、排泄中毒をみる
TFLAG:408 += ABL:ARG:Ａ感覚 + ABL:ARG:欲望 + ABL:ARG:技巧 + ABL:ARG:露出癖 + ABL:ARG:マゾっ気 + ABL:ARG:排泄中毒

;[汚れ無視]
SIF TALENT:ARG:汚れ無視
	TIMES TFLAG:408, 2.0

CALL PROSTITUTE_NEW_CUSTOMER_SATISFACTION, ARG

TCVAR:ARG:Ａ経験 = TFLAG:401 / 5
TCVAR:ARG:調教排泄経験 = TFLAG:401 / 5
TCVAR:ARG:露出快楽経験 = TFLAG:401 * 4
TCVAR:ARG:苦痛快楽経験 = TFLAG:401 * 2
TCVAR:ARG:Ａ拡張経験 = TFLAG:401 / 5
TCVAR:ARG:Ａ快楽経験 = TFLAG:401 / 5

;ビデオ撮影中
SIF TFLAG:403 & 16
	TCVAR:ARG:被写経験 = ( RAND:10 < 3 ) ? 2 # 1

TFLAG:405 = 80
RETURN 1

;-------------------------------------------------
;売春コマンドの地の文
;-------------------------------------------------
@SYSTXT_MESSAGE_PROSTITUTION_COM84

;=============================================================================
;異常売春(野外放尿)の処理
;=============================================================================
;-------------------------------------------------
;売春コマンド処理
;-------------------------------------------------
@PROSTITUTE_COM85, ARG
DOWNBASE:ARG:0 += 20
DOWNBASE:ARG:1 += 50

PRINTL 特殊性癖売春 -野外放尿-

;欲望、技巧、露出癖、マゾっ気、排泄中毒をみる
TFLAG:408 += ABL:ARG:欲望 + ABL:ARG:技巧 + ABL:ARG:露出癖 + ABL:ARG:マゾっ気 + ABL:ARG:排泄中毒

;[汚れ無視]、
SIF TALENT:ARG:汚れ無視
	TIMES TFLAG:408, 2.0

CALL PROSTITUTE_NEW_CUSTOMER_SATISFACTION, ARG

TCVAR:ARG:放尿経験 = TFLAG:401 / 5
TCVAR:ARG:露出快楽経験 = TFLAG:401 * 4

;ビデオ撮影中
SIF TFLAG:403 & 16
	TCVAR:ARG:被写経験 = ( RAND:10 < 3 ) ? 2 # 1

TFLAG:405 = 80
RETURN 1

;-------------------------------------------------
;売春コマンドの地の文
;-------------------------------------------------
@SYSTXT_MESSAGE_PROSTITUTION_COM85

;=============================================================================
;異常売春(獣姦ショー)の処理
;=============================================================================
;-------------------------------------------------
;売春コマンド処理
;-------------------------------------------------
@PROSTITUTE_COM86, ARG
DOWNBASE:ARG:0 += 35
DOWNBASE:ARG:1 += 50

PRINTL 特殊性癖売春 -獣姦ショー-

;欲望、技巧、露出癖、マゾっ気、獣姦中毒をみる
TFLAG:408 += ABL:ARG:欲望 + ABL:ARG:技巧 + ABL:ARG:マゾっ気 + ABL:ARG:獣姦中毒

;[汚れ無視]、
SIF TALENT:ARG:汚れ無視
	TIMES TFLAG:408, 2.0

CALL PROSTITUTE_NEW_CUSTOMER_SATISFACTION, ARG
IF TALENT:ARG:オトコ
	TCVAR:ARG:Ａ経験 = TFLAG:401 / 5
ELSE
	TCVAR:ARG:Ｖ経験 = TFLAG:401 / 5
ENDIF
TCVAR:ARG:絶頂経験 = TFLAG:401 / 5
TCVAR:ARG:精液経験 = TFLAG:401 / 5
TCVAR:ARG:露出快楽経験 = TFLAG:401
TCVAR:ARG:苦痛快楽経験 = TFLAG:401
TCVAR:ARG:動物性愛経験 = TFLAG:401 / 5

;ビデオ撮影中
SIF TFLAG:403 & 16
	TCVAR:ARG:被写経験 = ( RAND:10 < 3 ) ? 2 # 1
TFLAG:405 = 80
RETURN 1

;-------------------------------------------------
;売春コマンドの地の文
;-------------------------------------------------
@SYSTXT_MESSAGE_PROSTITUTION_COM86

