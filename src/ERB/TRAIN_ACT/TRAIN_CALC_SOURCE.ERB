;=============================================================================
;ソース計算(快楽系)
;=============================================================================
;-------------------------------------------------
;快Ｃのソース
;-------------------------------------------------
@CALC_SOURCE0
;Ｃ敏感とＣ鈍感はここで処理
IF TALENT:Ｃ敏感
	TIMES SOURCE:快Ｃ , 2.00
ELSEIF TALENT:Ｃ鈍感
	TIMES SOURCE:快Ｃ , 0.50
ENDIF

LOCAL = SOURCE:快Ｃ

;PALAM:欲情をみる
SELECTCASE PALAM:欲情
	CASE IS < PALAMLV:1
		TIMES LOCAL , 0.50
	CASE IS < PALAMLV:2
		TIMES LOCAL , 0.70
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.00
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.30
	CASEELSE
		TIMES LOCAL , 1.80
ENDSELECT

LOCAL:1 = SOURCE:快Ｃ

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL:1 , 0.10
	CASE 1
		TIMES LOCAL:1 , 0.15
	CASE 2
		TIMES LOCAL:1 , 0.20
	CASE 3
		TIMES LOCAL:1 , 0.25
	CASE 4
		TIMES LOCAL:1 , 0.30
	CASEELSE
		TIMES LOCAL:1 , 0.40
ENDSELECT

;快感の否定、抑圧、抵抗
IF TALENT:抑圧 || TALENT:抵抗 || TALENT:快感の否定
	LOCAL:2 = SOURCE:快Ｃ / 3
	LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
	LOCAL:2 = 0
ENDIF

LOCAL:3 = 0

;道具系コマンド実行時に実行者が[淫具知識]を持っている
SIF (TFLAG:98 == 1 && TALENT:PLAYER:淫具知識) || (TFLAG:98 == 2 && TALENT:淫具知識)
	TIMES LOCAL , 1.50
;淫核／淫茎
IF TALENT:淫核／淫茎
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 0.50
	LOCAL:3 = (LOCAL+LOCAL:1)/2
ENDIF

UP:0 += LOCAL
UP:13 += LOCAL:1
UP:22 += LOCAL:2
;淫核／淫茎持ちが対象なら潤滑と習得のパラも上昇する
IF LOCAL:3
	UP:10 += LOCAL:3
	LOCAL:3 = (LOCAL+LOCAL:1)/3
	UP:11 += LOCAL:3
ENDIF

;-------------------------------------------------
;快Ｖのソース
;-------------------------------------------------
@CALC_SOURCE1
;Ｖ敏感とＶ鈍感はここで処理
IF TALENT:Ｖ敏感
	TIMES SOURCE:快Ｖ , 2.00
ELSEIF TALENT:Ｖ鈍感
	TIMES SOURCE:快Ｖ , 0.50
ENDIF

LOCAL = SOURCE:快Ｖ

;PALAM:欲情をみる
SELECTCASE PALAM:欲情
	CASE IS < PALAMLV:1
		TIMES LOCAL , 0.30
	CASE IS < PALAMLV:2
		TIMES LOCAL , 0.50
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.00
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.50
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT

LOCAL:1 = SOURCE:快Ｖ

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL:1 , 0.10
	CASE 1
		TIMES LOCAL:1 , 0.15
	CASE 2
		TIMES LOCAL:1 , 0.20
	CASE 3
		TIMES LOCAL:1 , 0.25
	CASE 4
		TIMES LOCAL:1 , 0.30
	CASEELSE
		TIMES LOCAL:1 , 0.40
ENDSELECT

;快感の否定、抑圧、抵抗
IF TALENT:抑圧 || TALENT:抵抗 || TALENT:快感の否定
	LOCAL:2 = SOURCE:快Ｖ / 3
	LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
	LOCAL:2 = 0
ENDIF

LOCAL:3 = 0

;道具系コマンド実行時に実行者が[淫具知識]を持っている
SIF (TFLAG:98 == 1 && TALENT:PLAYER:淫具知識) || (TFLAG:98 == 2 && TALENT:淫具知識)
	TIMES LOCAL , 1.50
;小人体型
IF TALENT:小人体型
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.20
	UP:15 += LOCAL:1/2
ENDIF
;淫壷
IF TALENT:淫壷
	IF PLAYER == MASTER
		TIMES LOCAL , 2.50
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 0.30
	ELSE
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 1.20
		TIMES LOCAL:2 , 0.50
	ENDIF
	LOCAL:3 = (LOCAL+LOCAL:1)/3
ENDIF

UP:1 += LOCAL
UP:12 += LOCAL:1
UP:13 += LOCAL:1
UP:22 += LOCAL:2
;淫壷持ちが対象なら潤滑のパラも上昇する
SIF LOCAL:3
	UP:10 += LOCAL:3

;-------------------------------------------------
;快Ａのソース
;-------------------------------------------------
@CALC_SOURCE2
;Ａ敏感とＡ鈍感はここで処理
IF TALENT:Ａ敏感
	TIMES SOURCE:快Ａ , 2.00
ELSEIF TALENT:Ａ鈍感
	TIMES SOURCE:快Ａ , 0.50
ENDIF

LOCAL = SOURCE:快Ａ

;PALAM:欲情をみる
;快ＡはあまりPALAM:欲情では差が出ない
SELECTCASE PALAM:欲情
	CASE IS < PALAMLV:1
		TIMES LOCAL , 0.60
	CASE IS < PALAMLV:2
		TIMES LOCAL , 0.80
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.00
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.40
ENDSELECT

LOCAL:1 = SOURCE:快Ａ

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL:1 , 0.05
	CASE 1
		TIMES LOCAL:1 , 0.10
	CASE 2
		TIMES LOCAL:1 , 0.40
	CASE 3
		TIMES LOCAL:1 , 0.80
	CASE 4
		TIMES LOCAL:1 , 1.20
	CASEELSE
		TIMES LOCAL:1 , 1.80
ENDSELECT

;快感の否定、抑圧、抵抗
IF TALENT:抑圧 || TALENT:抵抗 || TALENT:快感の否定
	LOCAL:2 = SOURCE:快Ａ / 3
	LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
	LOCAL:2 = 0
ENDIF

;貞操観念
SIF TALENT:貞操観念
	TIMES LOCAL , 1.20

;道具系コマンド実行時に実行者が[淫具知識]を持っている
SIF (TFLAG:98 == 1 && TALENT:PLAYER:淫具知識) || (TFLAG:98 == 2 && TALENT:淫具知識)
	TIMES LOCAL , 1.50
;小人体型
IF TALENT:小人体型
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.20
	UP:17 += LOCAL/2
	UP:21 += LOCAL:1/2
ENDIF
;淫尻
IF TALENT:淫尻
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 0.50
ENDIF

UP:2 += LOCAL
UP:13 += LOCAL:1
UP:14 += LOCAL:1
UP:22 += LOCAL:2

;-------------------------------------------------
;快Ｂのソース
;-------------------------------------------------
@CALC_SOURCE3
;Ｂ敏感とＢ鈍感はここで処理
IF TALENT:Ｂ敏感
	TIMES SOURCE:快Ｂ , 2.00
ELSEIF TALENT:Ｂ鈍感
	TIMES SOURCE:快Ｂ , 0.50
ENDIF

LOCAL = SOURCE:快Ｂ

;PALAM:欲情をみる
SELECTCASE PALAM:欲情
	CASE IS < PALAMLV:1
		TIMES LOCAL , 0.50
	CASE IS < PALAMLV:2
		TIMES LOCAL , 0.70
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.00
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.30
	CASEELSE
		TIMES LOCAL , 1.80
ENDSELECT

LOCAL:1 = SOURCE:快Ｂ

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL:1 , 0.10
	CASE 1
		TIMES LOCAL:1 , 0.15
	CASE 2
		TIMES LOCAL:1 , 0.20
	CASE 3
		TIMES LOCAL:1 , 0.25
	CASE 4
		TIMES LOCAL:1 , 0.30
	CASEELSE
		TIMES LOCAL:1 , 0.40
ENDSELECT

;快感の否定、抑圧、抵抗
IF TALENT:抑圧 || TALENT:抵抗 || TALENT:快感の否定
	LOCAL:2 = SOURCE:快Ｂ / 3
	LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
	LOCAL:2 = 0
ENDIF

;道具系コマンド実行時に実行者が[淫具知識]を持っている
SIF (TFLAG:98 == 1 && TALENT:PLAYER:淫具知識) || (TFLAG:98 == 2 && TALENT:淫具知識)
	TIMES LOCAL , 1.50
;小人体型
IF TALENT:小人体型
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.20
	UP:12 += LOCAL:1/2
ENDIF
;淫乳
IF TALENT:淫乳
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 0.50
ENDIF

UP:3 += LOCAL
UP:13 += LOCAL:1
UP:22 += LOCAL:2

;-------------------------------------------------
;快楽のソース補助計算
;-------------------------------------------------
;………………………………………………
;快感の否定、抑圧、抵抗による抑鬱上昇
;………………………………………………
@CALC_CVAB_SOURCE_SUB(ARG)
#FUNCTION
;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES ARG , 1.00
	CASE 1
		TIMES ARG , 0.85
	CASE 2
		TIMES ARG , 0.70
	CASE 3
		TIMES ARG , 0.40
	CASE 4
		TIMES ARG , 0.30
	CASEELSE
		TIMES ARG , 0.10
ENDSELECT
RETURNF ARG

;=============================================================================
;ソース計算(快楽以外)
;=============================================================================
;-------------------------------------------------
;接触のソース
;-------------------------------------------------
@CALC_SOURCE10
LOCAL = SOURCE:接触
LOCAL:1 = SOURCE:接触
LOCAL:2 = SOURCE:接触
LOCAL:3 = SOURCE:接触

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.00
	CASE 1
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.05
	CASE 2
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 0.10
	CASE 3
		TIMES LOCAL , 0.30
		TIMES LOCAL:1 , 0.20
	CASE 4
		TIMES LOCAL , 0.10
		TIMES LOCAL:1 , 0.30
	CASEELSE
		TIMES LOCAL , 0.00
		TIMES LOCAL:1 , 0.40
ENDSELECT

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL:2 , 0.50
		TIMES LOCAL:3 , 0.00
	CASE 1
		TIMES LOCAL:2 , 0.40
		TIMES LOCAL:3 , 0.05
	CASE 2
		TIMES LOCAL:2 , 0.25
		TIMES LOCAL:3 , 0.10
	CASE 3
		TIMES LOCAL:2 , 0.10
		TIMES LOCAL:3 , 0.20
	CASE 4
		TIMES LOCAL:2 , 0.00
		TIMES LOCAL:3 , 0.30
	CASEELSE
		TIMES LOCAL:2 , 0.00
		TIMES LOCAL:3 , 0.40
ENDSELECT

;恋慕
IF TALENT:恋慕 && ASSIPLAY == 0
	LOCAL /= 5
	LOCAL:2 /= 5
	LOCAL:1 *= 2
	LOCAL:3 *= 2
ENDIF

;レズ調教・ＢＬ調教の場合
IF !(TALENT:PLAYER:オトコ ^^ TALENT:オトコ)
	LOCAL:4 = (TALENT:オトコ) ? ABL:ＢＬっ気 # ABL:レズっ気
	SELECTCASE LOCAL:4
		CASE 0
			TIMES LOCAL , 1.00
			TIMES LOCAL:2 , 1.00
			TIMES LOCAL:1 , 1.00
			TIMES LOCAL:3 , 1.00
		CASE 1
			TIMES LOCAL , 0.80
			TIMES LOCAL:2 , 0.80
			TIMES LOCAL:1 , 1.10
			TIMES LOCAL:3 , 1.10
		CASE 2
			TIMES LOCAL , 0.60
			TIMES LOCAL:2 , 0.60
			TIMES LOCAL:1 , 1.20
			TIMES LOCAL:3 , 1.20
		CASE 3
			TIMES LOCAL , 0.40
			TIMES LOCAL:2 , 0.40
			TIMES LOCAL:1 , 1.30
			TIMES LOCAL:3 , 1.30
		CASE 4
			TIMES LOCAL , 0.25
			TIMES LOCAL:2 , 0.25
			TIMES LOCAL:1 , 1.40
			TIMES LOCAL:3 , 1.40
		CASEELSE
			TIMES LOCAL , 0.15
			TIMES LOCAL:2 , 0.15
			TIMES LOCAL:1 , 1.50
			TIMES LOCAL:3 , 1.50
	ENDSELECT
ENDIF

;相性（この後出てくる「相性による上下の処理」と二重計算になるが問題なし）
LOCAL:4 = NO:PLAYER
IF RELATION:(LOCAL:4) != 0
	LOCAL *= 100
	LOCAL /= RELATION:(LOCAL:4)
	LOCAL:2 *= 100
	LOCAL:2 /= RELATION:(LOCAL:4)

	LOCAL:1 *= RELATION:(LOCAL:4)
	LOCAL:1 /= 100
	LOCAL:3 *= RELATION:(LOCAL:4)
	LOCAL:3 /= 100
ENDIF

UP:20 += LOCAL
UP:12 += LOCAL:1
UP:21 += LOCAL:2
UP:13 += LOCAL:3

;-------------------------------------------------
;情愛のソース
;-------------------------------------------------
@CALC_SOURCE11
LOCAL = SOURCE:情愛

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 0.10
	CASE 1
		TIMES LOCAL , 0.25
	CASE 2
		TIMES LOCAL , 0.40
	CASE 3
		TIMES LOCAL , 0.60
	CASE 4
		TIMES LOCAL , 0.80
	CASEELSE
		TIMES LOCAL , 1.00
ENDSELECT

LOCAL:1 = SOURCE:情愛

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL:1 , 0.00
	CASE 1
		TIMES LOCAL:1 , 0.05
	CASE 2
		TIMES LOCAL:1 , 0.10
	CASE 3
		TIMES LOCAL:1 , 0.20
	CASE 4
		TIMES LOCAL:1 , 0.30
	CASEELSE
		TIMES LOCAL:1 , 0.40
ENDSELECT

UP:12 += LOCAL
UP:13 += LOCAL:1

;-------------------------------------------------
;露出のソース
;-------------------------------------------------
@CALC_SOURCE12
;恥じらいと恥薄いはここで処理
IF TALENT:恥じらい
	TIMES SOURCE:露出 , 2.00
ELSEIF TALENT:恥薄い
	TIMES SOURCE:露出 , 0.50
ENDIF

;潤滑アップの50%から液体追加のソースを引いた残りを露出のソースに加える
SOURCE:露出 += (UP:10 - SOURCE:液体追加) / 2

LOCAL = SOURCE:露出
LOCAL:1 = SOURCE:露出
LOCAL:2 = SOURCE:露出

;PALAM:恥情をみる
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
SELECTCASE PALAM:恥情
	CASE IS < PALAMLV:1
		TIMES LOCAL:1 , 1.00
	CASE IS < PALAMLV:2
		TIMES LOCAL:1 , 0.90
	CASE IS < PALAMLV:3
		TIMES LOCAL:1 , 0.70
	CASE IS < PALAMLV:4
		TIMES LOCAL:1 , 0.50
	CASEELSE
		TIMES LOCAL:1 , 0.30
ENDSELECT

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL:2 , 0.50
	CASE 1
		TIMES LOCAL:2 , 0.30
	CASE 2
		TIMES LOCAL:2 , 0.15
	CASE 3
		TIMES LOCAL:2 , 0.05
	CASE 4
		TIMES LOCAL:2 , 0.00
	CASEELSE
		TIMES LOCAL:2 , 0.00
ENDSELECT

;ABL:露出癖をみる
SELECTCASE ABL:露出癖
	CASE 0
		TIMES LOCAL , 0.00
		TIMES LOCAL:2 , 1.00
	CASE 1
		TIMES LOCAL , 0.10
		TIMES LOCAL:2 , 0.90
	CASE 2
		TIMES LOCAL , 0.20
		TIMES LOCAL:2 , 0.70
	CASE 3
		TIMES LOCAL , 0.40
		TIMES LOCAL:2 , 0.50
	CASE 4
		TIMES LOCAL , 0.60
		TIMES LOCAL:2 , 0.30
	CASEELSE
		TIMES LOCAL , 0.80
		TIMES LOCAL:2 , 0.10
ENDSELECT

;パイパン
IF TALENT:パイパン
	TIMES LOCAL:1 , 2.50
	TIMES LOCAL:2 , 1.50
ENDIF
;マゾ
IF TALENT:マゾ
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 0.50
ENDIF

;クリトリスリング
IF CFLAG:42 & 1
	TIMES LOCAL:1 , 1.25
	TIMES LOCAL:2 , 1.40
ENDIF
;ラビアピアス
IF CFLAG:42 & 16
	TIMES LOCAL:1 , 1.30
	TIMES LOCAL:2 , 1.50
ENDIF
;ニプルピアス
IF CFLAG:42 & 32
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 1.30
ENDIF

UP:13 += LOCAL
UP:15 += LOCAL:1
UP:20 += LOCAL:2

;-------------------------------------------------
;主導権のソース
;-------------------------------------------------
@CALC_SOURCE14
LOCAL = SOURCE:主導権 / 5
LOCAL:1 = SOURCE:主導権
LOCAL:2 = SOURCE:主導権 / 2

;PALAM:欲情をみる
SELECTCASE PALAM:欲情
	CASE IS < PALAMLV:1
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.10
		TIMES LOCAL:2 , 1.00
	CASE IS < PALAMLV:2
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 0.25
		TIMES LOCAL:2 , 1.20
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 1.50
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.30
		TIMES LOCAL:1 , 0.75
		TIMES LOCAL:2 , 1.80
	CASEELSE
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 2.50
ENDSELECT

;ABL:技巧をみる
SELECTCASE ABL:技巧
	CASE 0
		TIMES LOCAL , 1.00
		TIMES LOCAL:2 , 0.80
	CASE 1
		TIMES LOCAL , 1.25
		TIMES LOCAL:2 , 1.00
	CASE 2
		TIMES LOCAL , 1.50
		TIMES LOCAL:2 , 1.20
	CASE 3
		TIMES LOCAL , 1.80
		TIMES LOCAL:2 , 1.40
	CASE 4
		TIMES LOCAL , 2.00
		TIMES LOCAL:2 , 1.60
	CASEELSE
		TIMES LOCAL , 2.40
		TIMES LOCAL:2 , 1.80
ENDSELECT

;ABL:奉仕精神をみる
SELECTCASE ABL:奉仕精神
	CASE 0
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.00
	CASE 1
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 0.90
	CASE 2
		TIMES LOCAL:1 , 0.90
		TIMES LOCAL:2 , 0.80
	CASE 3
		TIMES LOCAL:1 , 0.90
		TIMES LOCAL:2 , 0.70
	CASE 4
		TIMES LOCAL:1 , 0.75
		TIMES LOCAL:2 , 0.60
	CASEELSE
		TIMES LOCAL:1 , 0.75
		TIMES LOCAL:2 , 0.50
ENDSELECT

;ABL:マゾっ気をみる
SELECTCASE ABL:マゾっ気
	CASE 0
		TIMES LOCAL:2 , 1.00
	CASE 1
		TIMES LOCAL:2 , 0.90
	CASE 2
		TIMES LOCAL:2 , 0.80
	CASE 3
		TIMES LOCAL:2 , 0.70
	CASE 4
		TIMES LOCAL:2 , 0.60
	CASEELSE
		TIMES LOCAL:2 , 0.50
ENDSELECT

;サド
IF TALENT:サド
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.25
ENDIF

;調教者がマゾ
IF TALENT:PLAYER:マゾ
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.50
ENDIF

UP:11 += LOCAL
UP:13 += LOCAL:1

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL:2 , 1.00
	CASE 1
		TIMES LOCAL:2 , 0.80
	CASE 2
		TIMES LOCAL:2 , 0.60
	CASE 3
		TIMES LOCAL:2 , 0.50
	CASE 4
		TIMES LOCAL:2 , 0.80
	CASEELSE
		TIMES LOCAL:2 , 1.00
ENDSELECT

IF ABL:従順 < 4
	UP:14 += LOCAL:2
ELSE
	;MARK:反発刻印をみる
	SELECTCASE MARK:反発刻印
		CASE 0
			TIMES LOCAL:2 , 1.00
		CASE 1
			TIMES LOCAL:2 , 0.75
		CASE 2
			TIMES LOCAL:2 , 0.50
		CASEELSE
			TIMES LOCAL:2 , 0.25
	ENDSELECT
	UP:32 += LOCAL:2
ENDIF

;-------------------------------------------------
;性行動のソース
;-------------------------------------------------
@CALC_SOURCE15
LOCAL = SOURCE:性行動
LOCAL:1 = 0

;ABL:奉仕精神をみる
SELECTCASE ABL:奉仕精神
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.40
	CASEELSE
		TIMES LOCAL , 1.70
ENDSELECT

;調教者が[オトコ]の場合は＋補正
;主人調教なら補正率アップかつ[淫壷]補正あり
IF TALENT:PLAYER:オトコ && ASSIPLAY == 0
	TIMES LOCAL , 1.75
	SIF TALENT:淫壷
		TIMES LOCAL , 1.20
ELSEIF TALENT:PLAYER:オトコ
	TIMES LOCAL , 1.50
ENDIF

;抑圧か抵抗がある場合はPALAM:抑鬱が上がる
IF TALENT:抑圧 || TALENT:抵抗
	LOCAL:1 = SOURCE:性行動 / 5
	;ABL:奉仕精神をみる
	SELECTCASE ABL:奉仕精神
		CASE 0
			TIMES LOCAL:1 , 1.80
		CASE 1
			TIMES LOCAL:1 , 1.30
		CASE 2
			TIMES LOCAL:1 , 0.90
		CASE 3
			TIMES LOCAL:1 , 0.70
		CASE 4
			TIMES LOCAL:1 , 0.50
		CASEELSE
			TIMES LOCAL:1 , 0.30
	ENDSELECT
ENDIF

UP:11 += LOCAL
UP:22 += LOCAL:1

;-------------------------------------------------
;達成のソース
;-------------------------------------------------
@CALC_SOURCE16
LOCAL = SOURCE:達成感

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.40
	CASEELSE
		TIMES LOCAL , 1.60
ENDSELECT

;ABL:奉仕精神をみる
SELECTCASE ABL:奉仕精神
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.40
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.60
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT

;調教者が[オトコ]の場合は＋補正
;主人調教なら補正率アップかつ[淫壷]補正あり
IF TALENT:PLAYER:オトコ && ASSIPLAY == 0
	TIMES LOCAL , 1.50
	SIF TALENT:淫壷
		TIMES LOCAL , 1.10
ELSEIF TALENT:PLAYER:オトコ
	TIMES LOCAL , 1.25
ENDIF

UP:12 += LOCAL

;-------------------------------------------------
;恭順追加のソース
;-------------------------------------------------
@CALC_SOURCE17
LOCAL = SOURCE:恭順追加

;傷物
SIF TALENT:傷物
	TIMES LOCAL , 0.50
	
;時止め中
SIF TEQUIP:時間止め
    TIMES LOCAL , 0.30

UP:12 += LOCAL

;-------------------------------------------------
;欲情追加のソース
;-------------------------------------------------
@CALC_SOURCE18
LOCAL = SOURCE:欲情追加

;時止め中
SIF TEQUIP:時間止め
    TIMES LOCAL , 0.30

UP:13 += LOCAL

;-------------------------------------------------
;液体追加のソース
;-------------------------------------------------
@CALC_SOURCE19
;小人体型
IF TALENT:小人体型 && TALENT:PLAYER:小人体型 == 0
	;ローションとローションプレイでないときは
	SIF SELECTCOM != 60 && SELECTCOM != 625
		TIMES SOURCE:液体追加 , 0.40
ENDIF
LOCAL = SOURCE:液体追加

UP:10 += LOCAL

;-------------------------------------------------
;液体追加のソース
;-------------------------------------------------
@CALC_SOURCE19_2, ARG
;小人体型
IF TALENT:小人体型 && TALENT:PLAYER:小人体型 == 0
	;ローションとローションプレイでないときは
	SIF SELECTCOM != 60 && SELECTCOM != 625
		TIMES ARG , 0.40
ENDIF

UP:10 += ARG

;-------------------------------------------------
;痛覚のソース
;-------------------------------------------------
@CALC_SOURCE20
LOCAL = SOURCE:痛み
LOCAL:1 = SOURCE:痛み
LOCAL:2 = SOURCE:痛み
LOCAL:3 = SOURCE:痛み

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 0.80
	CASE 1
		TIMES LOCAL:1 , 0.90
		TIMES LOCAL:2 , 0.60
	CASE 2
		TIMES LOCAL:1 , 0.80
		TIMES LOCAL:2 , 0.50
	CASE 3
		TIMES LOCAL:1 , 0.70
		TIMES LOCAL:2 , 0.40
	CASE 4
		TIMES LOCAL:1 , 0.60
		TIMES LOCAL:2 , 0.20
	CASEELSE
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 0.00
ENDSELECT

;ABL:マゾっ気をみる
SELECTCASE ABL:マゾっ気
	CASE 0
		TIMES LOCAL:2 , 1.00
		TIMES LOCAL:3 , 0.00
	CASE 1
		TIMES LOCAL:2 , 0.80
		TIMES LOCAL:3 , 0.10
	CASE 2
		TIMES LOCAL:2 , 0.50
		TIMES LOCAL:3 , 0.20
	CASE 3
		TIMES LOCAL:2 , 0.30
		TIMES LOCAL:3 , 0.30
	CASE 4
		TIMES LOCAL:2 , 0.10
		TIMES LOCAL:3 , 0.45
	CASEELSE
		TIMES LOCAL:2 , 0.05
		TIMES LOCAL:3 , 0.60
ENDSELECT

;痛みに弱い
IF TALENT:痛みに弱い
	;難易度による修整
	IF FLAG:3 >= 4
		TIMES LOCAL , 4.00
	ELSEIF FLAG:3 == 3
		TIMES LOCAL , 2.00
	ELSE
		TIMES LOCAL , 1.50
	ENDIF
ENDIF
;ドＭ
IF TALENT:ドＭ
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 2.50
;マゾ
ELSEIF TALENT:マゾ
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 1.50
ENDIF
;道具系コマンド実行時に実行者が[淫具知識]を持っている
SIF (TFLAG:98 == 1 && TALENT:PLAYER:淫具知識) || (TFLAG:98 == 2 && TALENT:淫具知識)
	TIMES LOCAL , 1.50
;小人体型
IF TALENT:小人体型
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.20
	TIMES LOCAL:3 , 0.75
ENDIF

;助手によるプレイ
SIF ASSIPLAY
	TIMES LOCAL:2 , 0.40

;ABL:調教者のサドっ気をみる
SELECTCASE ABL:PLAYER:サドっ気
	CASE 0
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.00
	CASE IS <= 2
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 1.10
		TIMES LOCAL:2 , 1.20
	CASE IS <= 4
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.25
		TIMES LOCAL:2 , 1.40
	CASEELSE
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 1.80
ENDSELECT

;調教者がドＳ
IF TALENT:PLAYER:ドＳ
	TIMES LOCAL , 2.00
	TIMES LOCAL:3 , 1.50
;調教者がサド
ELSEIF TALENT:PLAYER:サド
	TIMES LOCAL , 1.20
	TIMES LOCAL:3 , 1.50
ENDIF

UP:16 += LOCAL
UP:17 += LOCAL:1
UP:20 += LOCAL:2
UP:13 += LOCAL:3
;マゾっ気があるとPALAM:欲情も上がる
;そのとき調教者が[サド]だと効果的

;-------------------------------------------------
;痒みのソース
;-------------------------------------------------
@CALC_SOURCE21
;LOCAL:0=苦痛,欲情
;LOCAL:1=屈服
;LOCAL:2=不快
;LOCAL:3=反感

LOCAL = SOURCE:痒み
LOCAL:1 = SOURCE:痒み
LOCAL:2 = 4 * SOURCE:痒み

SELECTCASE SOURCE:痒み
	CASE IS < 1000
		LOCAL:3 = 0
	CASE IS < 3000
		LOCAL:3 = 100
	CASE IS < 6000
		LOCAL:3 = 200
	CASE IS < 10000
		LOCAL:3 = 300
	CASE IS < 18000
		LOCAL:3 = 600
	CASE IS < 30000
		LOCAL:3 = 1200
	CASEELSE
		LOCAL:3 = 2400
ENDSELECT
SIF LOCAL:3 > 300
	LOCAL:3 += SOURCE:痒み

;ABL:マゾっ気をみる
SELECTCASE ABL:マゾっ気
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:2 , 3.00
		TIMES LOCAL:3 , 3.00
	CASE 1
		TIMES LOCAL , 0.80
		TIMES LOCAL:2 , 1.50
		TIMES LOCAL:3 , 1.50
	CASE 2
		TIMES LOCAL , 1.00
		TIMES LOCAL:2 , 1.00
		TIMES LOCAL:3 , 1.00
	CASE 3
		TIMES LOCAL , 1.20
		TIMES LOCAL:2 , 0.50
		TIMES LOCAL:3 , 0.50
	CASE 4
		TIMES LOCAL , 1.50
		TIMES LOCAL:2 , 0.10
		TIMES LOCAL:3 , 0.10
	CASEELSE
		TIMES LOCAL , 1.80
		TIMES LOCAL:2 , 0.02
		TIMES LOCAL:3 , 0.02
ENDSELECT

;ABL:自慰中毒をみる
SELECTCASE ABL:自慰中毒
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.10
		TIMES LOCAL:2 , 0.50
		TIMES LOCAL:3 , 0.50
	CASE 1
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 0.80
		TIMES LOCAL:3 , 0.80
	CASE 2
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.00
		TIMES LOCAL:3 , 1.00
	CASE 3
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 1.30
		TIMES LOCAL:3 , 1.50
	CASE 4
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 1.80
		TIMES LOCAL:2 , 1.60
		TIMES LOCAL:3 , 2.00
	CASEELSE
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 2.50
		TIMES LOCAL:2 , 2.00
		TIMES LOCAL:3 , 2.50
ENDSELECT

;濡れやすい
IF TALENT:濡れやすい
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 2.50
;濡れにくい
ELSEIF TALENT:濡れにくい
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.50
ENDIF
;倒錯的
IF TALENT:倒錯的
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.80
ENDIF
;マゾ
IF TALENT:マゾ
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 1.50
	TIMES LOCAL:3 , 0.50
ENDIF
;淫乱
IF TALENT:淫乱
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 1.80
	TIMES LOCAL:3 , 1.20
ENDIF

;調教者がサド
IF TALENT:PLAYER:サド
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 2.50
ENDIF

UP:13 += LOCAL
UP:16 += LOCAL
UP:14 += LOCAL:1
UP:21 += LOCAL:2
UP:20 += LOCAL:3

;-------------------------------------------------
;屈従のソース
;-------------------------------------------------
@CALC_SOURCE22
LOCAL = SOURCE:屈従
LOCAL:1 = SOURCE:屈従

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.12
	CASE 1
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.10
	CASE 2
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.05
	CASE 3
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 0.02
	CASE 4
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 0.00
	CASEELSE
		TIMES LOCAL , 1.30
		TIMES LOCAL:1 , 0.00
ENDSELECT

;ABL:サドっ気をみる
SELECTCASE ABL:サドっ気
	CASE 0
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.00
	CASE 1
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 0.80
	CASE 2
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 0.60
	CASE 3
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 0.50
	CASE 4
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 0.40
	CASEELSE
		TIMES LOCAL , 2.00
		TIMES LOCAL:1 , 0.25
ENDSELECT

;パイパン
IF TALENT:パイパン
	SIF TALENT:小柄体型 == 0
		TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 1.50
ENDIF

;クリトリスリング
IF CFLAG:42 & 1
	TIMES LOCAL , 1.40
	TIMES LOCAL:1 , 1.25
ENDIF
;ラビアピアス
IF CFLAG:42 & 16
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.30
ENDIF
;ニプルピアス
IF CFLAG:42 & 32
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 1.20
ENDIF

UP:14 += LOCAL
UP:22 += LOCAL:1

;-------------------------------------------------
;支配のソース
;-------------------------------------------------
;LOCAL:0=屈服,恐怖
;LOCAL:1=抑鬱
;LOCAL:2=反感
;LOCAL:3=欲情
@CALC_SOURCE23

LOCAL = SOURCE:支配
LOCAL:1 = SOURCE:支配
LOCAL:2 = SOURCE:支配
LOCAL:3 = SOURCE:支配

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 2.50
		TIMES LOCAL:2 , 2.00
	CASE 1
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 2.00
		TIMES LOCAL:2 , 1.50
	CASE 2
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 1.20
	CASE 3
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 1.20
		TIMES LOCAL:2 , 1.00
	CASE 4
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 0.80
	CASEELSE
		TIMES LOCAL , 1.30
		TIMES LOCAL:1 , 0.60
		TIMES LOCAL:2 , 0.50
ENDSELECT

;ABL:サドっ気をみる
SELECTCASE ABL:サドっ気
	CASE 0
		TIMES LOCAL:2 , 1.00
		TIMES LOCAL:3 , 0.20
	CASE 1
		TIMES LOCAL:2 , 1.20
		TIMES LOCAL:3 , 0.50
	CASE 2
		TIMES LOCAL:2 , 1.50
		TIMES LOCAL:3 , 0.80
	CASE 3
		TIMES LOCAL:2 , 1.80
		TIMES LOCAL:3 , 1.00
	CASE 4
		TIMES LOCAL:2 , 2.00
		TIMES LOCAL:3 , 1.30
	CASEELSE
		TIMES LOCAL:2 , 2.50
		TIMES LOCAL:3 , 1.60
ENDSELECT

;ABL:マゾっ気をみる
SELECTCASE ABL:マゾっ気
	CASE 0
		TIMES LOCAL:2 , 1.00
		TIMES LOCAL:3 , 0.00
	CASE 1
		TIMES LOCAL:2 , 0.80
		TIMES LOCAL:3 , 0.10
	CASE 2
		TIMES LOCAL:2 , 0.50
		TIMES LOCAL:3 , 0.20
	CASE 3
		TIMES LOCAL:2 , 0.30
		TIMES LOCAL:3 , 0.30
	CASE 4
		TIMES LOCAL:2 , 0.10
		TIMES LOCAL:3 , 0.45
	CASEELSE
		TIMES LOCAL:2 , 0.05
		TIMES LOCAL:3 , 0.60
ENDSELECT

;臆病
IF TALENT:臆病
	TIMES LOCAL , 3.00
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.50
ENDIF
;反抗的
IF TALENT:反抗的
	TIMES LOCAL , 0.70
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.50
ENDIF
;プライド高い
IF TALENT:プライド高い
	TIMES LOCAL , 0.70
	TIMES LOCAL:1 , 1.30
	TIMES LOCAL:2 , 1.30
;プライド低い
ELSEIF TALENT:プライド低い
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 0.90
	TIMES LOCAL:2 , 0.90
ENDIF
;自制心
IF TALENT:自制心
	TIMES LOCAL:1 , 0.80
	TIMES LOCAL:2 , 0.80
ENDIF
;悲観的
IF TALENT:悲観的
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.50
ENDIF
;弱味
IF TALENT:弱味
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 0.80
ENDIF
;献身的
IF TALENT:献身的
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 1.50
ENDIF
;倒錯的
IF TALENT:倒錯的
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.80
	TIMES LOCAL:3 , 2.00
ENDIF
;マゾ
IF TALENT:マゾ
	TIMES LOCAL , 1.50
	TIMES LOCAL:3 , 1.50
ENDIF

;調教者がサド
IF TALENT:PLAYER:サド
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.80
	TIMES LOCAL:2 , 1.20
ENDIF

;ABL:調教者のサドっ気をみる
SELECTCASE ABL:PLAYER:サドっ気
	CASE 0
		TIMES LOCAL , 1.00
		TIMES LOCAL:2 , 1.00
	CASE IS <= 2
		TIMES LOCAL , 1.10
		TIMES LOCAL:2 , 1.20
	CASE IS <= 4
		TIMES LOCAL , 1.20
		TIMES LOCAL:2 , 1.40
	CASEELSE
		TIMES LOCAL , 1.40
		TIMES LOCAL:2 , 1.80
ENDSELECT

;クリトリスリング
IF CFLAG:42 & 1
	TIMES LOCAL , 1.25
	TIMES LOCAL:1 , 1.25
	TIMES LOCAL:2 , 1.25
ENDIF
;ラビアピアス
IF CFLAG:42 & 16
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 1.30
	TIMES LOCAL:2 , 1.30
ENDIF
;ニプルピアス
IF CFLAG:42 & 32
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.20
ENDIF

UP:17 += LOCAL

;服従
IF TALENT:服従
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.50
ENDIF
;烙印
IF TALENT:烙印
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 0.10
ENDIF
;隷属
IF TALENT:隷属
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 0.10
	TIMES LOCAL:3 , 1.50
ENDIF

UP:14 += LOCAL
UP:22 += LOCAL:1
UP:20 += LOCAL:2
UP:13 += LOCAL:3

;-------------------------------------------------
;中毒充足のソース
;-------------------------------------------------
@CALC_SOURCE24
LOCAL = SOURCE:中毒充足
LOCAL:1 = SOURCE:中毒充足

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL , 0.10
		TIMES LOCAL:1 , 0.20
	CASE 1
		TIMES LOCAL , 0.15
		TIMES LOCAL:1 , 0.30
	CASE 2
		TIMES LOCAL , 0.20
		TIMES LOCAL:1 , 0.40
	CASE 3
		TIMES LOCAL , 0.25
		TIMES LOCAL:1 , 0.50
	CASE 4
		TIMES LOCAL , 0.30
		TIMES LOCAL:1 , 0.60
	CASEELSE
		TIMES LOCAL , 0.35
		TIMES LOCAL:1 , 0.70
ENDSELECT

;マゾ
IF TALENT:マゾ
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.50
ENDIF

UP:12 += LOCAL
UP:13 += LOCAL:1

;-------------------------------------------------
;トラウマのソース
;-------------------------------------------------
;LOCAL:0=屈服, LOCAL:1=恐怖, LOCAL:2=不快
@CALC_SOURCE25
LOCAL = SOURCE:トラウマ
LOCAL:1 = SOURCE:トラウマ
LOCAL:2 = SOURCE:トラウマ

;MARK:恐怖刻印をみる
SELECTCASE MARK:恐怖刻印
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.25
		TIMES LOCAL:2 , 0.30
	CASE 1
		TIMES LOCAL , 0.75
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 0.60
	CASE 2
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 1.00
	CASEELSE
		TIMES LOCAL , 1.25
		TIMES LOCAL:1 , 3.00
		TIMES LOCAL:2 , 1.50
ENDSELECT

;臆病
IF TALENT:臆病
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 7.50
ENDIF

UP:14 += LOCAL
UP:17 += LOCAL:1
UP:21 += LOCAL:2

;-------------------------------------------------
;薬物侵蝕のソース
;-------------------------------------------------
;LOCAL:0=欲情, LOCAL:1=不快, LOCAL:2=薬毒
@CALC_SOURCE26
;薬毒耐性
SIF TALENT:薬毒耐性
	TIMES SOURCE:薬物浸潤 , 0.25
;媚薬中毒
SIF TALENT:媚薬中毒
	TIMES SOURCE:薬物浸潤 , 1.50
;機械
SIF TALENT:機械
	TIMES SOURCE:薬物浸潤 , 0.25
;霊体または人形
SIF TALENT:霊体 || TALENT:人形
	TIMES SOURCE:薬物浸潤 , 0.50

LOCAL = SOURCE:薬物浸潤
LOCAL:1 = SOURCE:薬物浸潤
LOCAL:2 = SOURCE:薬物浸潤

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 0.10
		TIMES LOCAL:1 , 2.00
		TIMES LOCAL:2 , 0.10
	CASE 1
		TIMES LOCAL , 0.30
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 0.40
	CASE 2
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 0.70
	CASE 3
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.70
		TIMES LOCAL:2 , 1.00
	CASE 4
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.40
		TIMES LOCAL:2 , 1.50
	CASEELSE
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 0.10
		TIMES LOCAL:2 , 2.00
ENDSELECT

;ABL:○○中毒関係をみる
IF TALENT:オトコ
	LOCAL:3 = (ABL:自慰中毒+ABL:精液中毒+ABL:ＢＬ中毒+ABL:噴乳中毒+ABL:触手中毒+ABL:排泄中毒+ABL:射精中毒)/5
ELSE
	LOCAL:3 = (ABL:自慰中毒+ABL:精液中毒+ABL:レズ中毒+ABL:噴乳中毒+ABL:触手中毒+ABL:排泄中毒+ABL:射精中毒)/5
ENDIF
SELECTCASE LOCAL:3
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 2.50
		TIMES LOCAL:2 , 0.80
	CASE 1
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 1.80
		TIMES LOCAL:2 , 1.00
	CASE 2
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 1.10
	CASE 3
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.30
	CASE 4
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 1.60
	CASEELSE
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 0.10
		TIMES LOCAL:2 , 2.00
ENDSELECT

;喘息
SIF TALENT:喘息
	TIMES LOCAL:2 , 1.50

;MARK:反発刻印をみる
SELECTCASE MARK:反発刻印
	CASE 0
		TIMES LOCAL , 1.25
		TIMES LOCAL:1 , 0.25
		TIMES LOCAL:2 , 0.50
	CASE 1
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.00
	CASE 2
		TIMES LOCAL , 0.75
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 1.50
	CASEELSE
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 3.00
		TIMES LOCAL:2 , 2.00
ENDSELECT

;MARK:薬物刻印をみる
SELECTCASE MARK:薬物刻印
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 2.00
		TIMES LOCAL:2 , 1.00
	CASE 1
		TIMES LOCAL , 0.75
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.50
	CASE 2
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 2.00
	CASEELSE
		TIMES LOCAL , 1.75
		TIMES LOCAL:1 , 0.10
		LOCAL:2 = 0
ENDSELECT

UP:13 += LOCAL
UP:21 += LOCAL:1
UP:30 += LOCAL:2
DOWNBASE:9 += LOCAL:2 / 20

;-------------------------------------------------
;触手汚染のソース
;-------------------------------------------------
@CALC_SOURCE27
LOCAL = SOURCE:触手汚染
LOCAL:1 = SOURCE:触手汚染
LOCAL:2 = SOURCE:触手汚染

;EXP:触手経験をみる
SELECTCASE EXP:触手経験
	CASE IS < EXPLV:1
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 2.00
		TIMES LOCAL:2 , 0.60
	CASE IS < EXPLV:2
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 0.80
	CASE IS < EXPLV:3
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.00
	CASE IS < EXPLV:4
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 0.75
		TIMES LOCAL:2 , 2.00
	CASE IS < EXPLV:5
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 2.50
	CASEELSE
		TIMES LOCAL , 2.00
		TIMES LOCAL:1 , 0.25
		TIMES LOCAL:2 , 3.00
ENDSELECT

;ABL:触手中毒をみる
SELECTCASE ABL:触手中毒
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 3.50
		TIMES LOCAL:2 , 0.50
	CASE 1
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 2.00
		TIMES LOCAL:2 , 0.60
	CASE 2
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 0.70
	CASE 3
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 0.80
	CASE 4
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 0.10
		TIMES LOCAL:2 , 0.90
	CASEELSE
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.00
		TIMES LOCAL:2 , 1.00
ENDSELECT

;触手寄生LVの最大値に対する現在値の割合([寄生]が無い場合は0％扱い)
LOCAL:3 = (TALENT:寄生) ? (BASE:触手 *100) / MAXBASE:6 # 0
SELECTCASE LOCAL:3
	CASE 0
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.00
	CASE IS < 20
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 0.90
		TIMES LOCAL:2 , 1.25
	CASE IS < 40
		TIMES LOCAL , 1.30
		TIMES LOCAL:1 , 0.75
		TIMES LOCAL:2 , 1.50
	CASE IS < 60
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 0.60
		TIMES LOCAL:2 , 1.80
	CASE IS < 80
		TIMES LOCAL , 1.70
		TIMES LOCAL:1 , 0.20
		TIMES LOCAL:2 , 2.20
	CASE IS < 100
		TIMES LOCAL , 1.90
		TIMES LOCAL:1 , 0.10
		TIMES LOCAL:2 , 2.50
	CASEELSE
		TIMES LOCAL , 2.50
		TIMES LOCAL:1 , 0.00
		TIMES LOCAL:2 , 3.00
ENDSELECT

UP:14 += LOCAL
UP:21 += LOCAL:1

;侵蝕はそのコマンドの絶頂強度(回数)で増加
;増加量は調教者の触手使役Lvに依存
SELECTCASE ABL:PLAYER:触手使役
	CASE 0
		LOCAL:4 = 5
	CASE 1
		LOCAL:4 = 10
	CASE 2
		LOCAL:4 = 25
	CASE 3
		LOCAL:4 = 50
	CASE 4
		LOCAL:4 = 75
	CASEELSE
		LOCAL:4 = 100
ENDSELECT
REPEAT 4
	SIF NOWEX:COUNT
		LOCAL:2 += NOWEX:COUNT * LOCAL:4
	SIF NOWEX:(COUNT+10)
		LOCAL:2 += NOWEX:(COUNT+10) * (LOCAL:4 * 2)
REND

UP:31 += LOCAL:2

;-------------------------------------------------
;羞恥扇情のソース
;-------------------------------------------------
@CALC_SOURCE28
LOCAL = SOURCE:羞恥扇情
LOCAL:1 = SOURCE:羞恥扇情
LOCAL:2 = SOURCE:羞恥扇情

;MARK:恥辱刻印をみる
SELECTCASE MARK:恥辱刻印
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.75
		TIMES LOCAL:2 , 2.00
	CASE 1
		TIMES LOCAL , 0.75
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 1.00
	CASE 2
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 0.50
	CASEELSE
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 2.00
		TIMES LOCAL:2 , 0.25
ENDSELECT

UP:14 += LOCAL
UP:15 += LOCAL:1
UP:21 += LOCAL:2

;-------------------------------------------------
;性技学習のソース
;-------------------------------------------------
@CALC_SOURCE29
LOCAL = SOURCE:性技学習
LOCAL:1 = SOURCE:性技学習
LOCAL:2 = SOURCE:性技学習

;ABL:奉仕精神をみる
SELECTCASE ABL:奉仕精神
	CASE 0
		TIMES LOCAL , 0.20
		TIMES LOCAL:1 , 1.00
	CASE 1
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.90
	CASE 2
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.80
	CASE 3
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.70
	CASE 4
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 0.60
	CASEELSE
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 0.50
ENDSELECT

;ABL:露出癖をみる
SELECTCASE ABL:露出癖
	CASE 0
		TIMES LOCAL , 1.00
		TIMES LOCAL:2 , 1.50
	CASE 1
		TIMES LOCAL , 1.10
		TIMES LOCAL:2 , 1.25
	CASE 2
		TIMES LOCAL , 1.20
		TIMES LOCAL:2 , 1.00
	CASE 3
		TIMES LOCAL , 1.30
		TIMES LOCAL:2 , 0.75
	CASE 4
		TIMES LOCAL , 1.40
		TIMES LOCAL:2 , 0.50
	CASEELSE
		TIMES LOCAL , 1.50
		TIMES LOCAL:2 , 0.10
ENDSELECT

UP:11 += LOCAL
UP:14 += LOCAL:1
UP:22 += LOCAL:2

;-------------------------------------------------
;不潔のソース
;-------------------------------------------------
@CALC_SOURCE30
LOCAL = SOURCE:不潔
LOCAL:1 = SOURCE:不潔

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 1.40
	CASE 1
		TIMES LOCAL , 1.30
		TIMES LOCAL:1 , 1.20
	CASE 2
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 1.00
	CASE 3
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.80
	CASE 4
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.50
	CASEELSE
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.10
ENDSELECT

;ABL:排泄中毒をみる
SELECTCASE ABL:排泄中毒
	CASE 0
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.00
	CASE 1
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.80
	CASE 2
		TIMES LOCAL , 0.25
		TIMES LOCAL:1 , 0.60
	CASE 3
		TIMES LOCAL , 0.10
		TIMES LOCAL:1 , 0.30
	CASE 4
		TIMES LOCAL , 0.00
		TIMES LOCAL:1 , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
		TIMES LOCAL:1 , 0.00
ENDSELECT

UP:20 += LOCAL
UP:21 += LOCAL:1

;-------------------------------------------------
;逸脱のソース
;-------------------------------------------------
@CALC_SOURCE31
;好奇心と保守的はここで処理
SIF TALENT:好奇心
	TIMES SOURCE:逸脱 , 0.50
SIF TALENT:保守的
	TIMES SOURCE:逸脱 , 3.00

LOCAL = SOURCE:逸脱

;ABL:従順をみる
SELECTCASE ABL:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.70
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.20
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

;ABL:欲望をみる
SELECTCASE ABL:欲望
	CASE 0
		TIMES LOCAL , 0.90
	CASE 1
		TIMES LOCAL , 0.70
	CASE 2
		TIMES LOCAL , 0.50
	CASE 3
		TIMES LOCAL , 0.30
	CASE 4
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

;パイパン(小人体型もしくは小柄体型は除く)
SIF TALENT:パイパン && TALENT:小人体型 == 0 && TALENT:小柄体型 == 0
	TIMES LOCAL , 1.80
;マゾ
SIF TALENT:マゾ
	TIMES LOCAL , 0.50

;クリトリスリング
SIF CFLAG:42 & 1
	TIMES LOCAL , 1.25
;ラビアピアス
SIF CFLAG:42 & 16
	TIMES LOCAL , 1.30
;ニプルピアス
SIF CFLAG:42 & 32
	TIMES LOCAL , 1.20

UP:20 += LOCAL

;-------------------------------------------------
;反感追加のソース
;-------------------------------------------------
@CALC_SOURCE32
LOCAL = SOURCE:反感追加

;傷物
SIF TALENT:傷物
	TIMES LOCAL , 2.50
	
;時止め中
SIF TEQUIP:時間止め
    TIMES LOCAL , 0.30

UP:20 += LOCAL

;-------------------------------------------------
;酒酔いのソース
;-------------------------------------------------
@CALC_SOURCE40
LOCAL = SOURCE:酒酔い
LOCAL:1 = SOURCE:酒酔い * 4
LOCAL:2 = SOURCE:酒酔い * 2

;PALAM:欲情をみる
SELECTCASE PALAM:欲情
	CASE IS < PALAMLV:1
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 1.00
	CASE IS < PALAMLV:2
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 0.70
		TIMES LOCAL:2 , 0.75
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 0.50
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 1.30
		TIMES LOCAL:2 , 0.25
	CASEELSE
		TIMES LOCAL , 2.50
		TIMES LOCAL:1 , 1.80
		TIMES LOCAL:2 , 0.10
ENDSELECT

;人形
SIF TALENT:人形
	TIMES LOCAL , 0.75
;河童
SIF TALENT:河童
	TIMES LOCAL , 0.75
;鬼
SIF TALENT:鬼
	TIMES LOCAL , 0.25
;天狗
SIF TALENT:天狗
	TIMES LOCAL , 0.75
;黄昏の怪物
SIF TALENT:黄昏の怪物
	TIMES LOCAL , 0.25
;神霊
SIF TALENT:神霊
	TIMES LOCAL , 0.75
;半神
SIF TALENT:半神
	TIMES LOCAL , 0.75

BASE:酔い += LOCAL
DOWNBASE:9 += LOCAL * 2000 / MAXBASE:8
UP:13 += LOCAL:1
UP:21 += LOCAL:2

;-------------------------------------------------
;酒酔い(鬼殺し)のソース
;-------------------------------------------------
@CALC_SOURCE41
LOCAL = SOURCE:鬼殺し
LOCAL:1 = SOURCE:鬼殺し * 4
LOCAL:2 = SOURCE:鬼殺し * 2
LOCAL:3 = SOURCE:鬼殺し * 3

;PALAM:欲情をみる
SELECTCASE PALAM:欲情
	CASE IS < PALAMLV:1
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.50
		TIMES LOCAL:2 , 1.00
		TIMES LOCAL:3 , 0.50
	CASE IS < PALAMLV:2
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 0.70
		TIMES LOCAL:2 , 0.75
		TIMES LOCAL:3 , 0.80
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:2 , 0.50
		TIMES LOCAL:3 , 1.00
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 1.30
		TIMES LOCAL:2 , 0.25
		TIMES LOCAL:3 , 1.30
	CASEELSE
		TIMES LOCAL , 2.50
		TIMES LOCAL:1 , 1.80
		TIMES LOCAL:2 , 0.10
		TIMES LOCAL:3 , 1.60
ENDSELECT

;人形
SIF TALENT:人形
	TIMES LOCAL , 0.75
;河童
SIF TALENT:河童
	TIMES LOCAL , 0.75
;天狗
SIF TALENT:天狗
	TIMES LOCAL , 0.75
;鬼
SIF TALENT:鬼
	TIMES LOCAL , 2.50
;黄昏の怪物
SIF TALENT:黄昏の怪物
	TIMES LOCAL , 0.25
;神霊
SIF TALENT:神霊
	TIMES LOCAL , 0.75
;半神
SIF TALENT:半神
	TIMES LOCAL , 0.75

BASE:酔い += LOCAL
DOWNBASE:9 += LOCAL * 2000 / MAXBASE:8
UP:13 += LOCAL:1
UP:21 += LOCAL:2
UP:30 += LOCAL:3

;-------------------------------------------------
;媚薬浸潤のソース
;-------------------------------------------------
@CALC_SOURCE42, ARG
LOCAL = SOURCE:ARG:媚薬浸潤

;中毒しやすい
IF TALENT:ARG:中毒しやすい
	TIMES LOCAL , 1.25
;中毒しにくい
ELSEIF TALENT:ARG:中毒しにくい
	TIMES LOCAL , 0.75
ENDIF
;媚薬中毒
IF TALENT:ARG:媚薬中毒
	UP:12 += LOCAL*2
	UP:13 += LOCAL
	UP:14 += LOCAL*3
	CFLAG:ARG:32 = 0
ELSE
	;媚薬中毒レベルの上昇処理
	CFLAG:ARG:32 += SOURCE:ARG:媚薬浸潤
ENDIF
DOWNBASE:9 += LOCAL / 20