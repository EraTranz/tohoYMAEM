;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;調教中の追加処理及びサブイベント
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;=============================================================================
;調教経験関連の処理
;=============================================================================
;-------------------------------------------------
;主人調教経験・好感度
;-------------------------------------------------
;好感度は100万以上に上昇させることはできない
@MASTER_FLAG_CHECK
;絶頂(にここで調教対象の射精と噴乳と放尿を足している）
TFLAG:51 += TFLAG:30 + TFLAG:31 + TFLAG:32

LOCAL:1 = 0
;今回の調教ターンでのＣ絶頂、Ｖ絶頂、Ａ絶頂、Ｂ絶頂
REPEAT 4
	SIF NOWEX:COUNT > 0
		LOCAL:1 += 1
REND
;今回の調教ターンでの調教対象の射精
SIF TFLAG:30 > 0
	LOCAL:1 += 1
;今回の調教ターンでの調教対象の噴乳
SIF TFLAG:31 > 0
	LOCAL:1 += 1
;今回の調教ターンでの調教対象の放尿
SIF TFLAG:32 > 0
	LOCAL:1 += 1
;主人経験に絶頂＋色々追加されたものを加えている
TFLAG:50 += TFLAG:51 * LOCAL:1

;検討中……
TFLAG:51 -= TFLAG:30 + TFLAG:31 + TFLAG:32

;射精
FOR PC_VAR1, 10, 29
	SIF TFLAG:PC_VAR1 > 0 && (EXP:精液経験 + TCVAR:精液経験) >= EXPLV:3
		TFLAG:50 += TFLAG:PC_VAR1
NEXT

;主人(あなた)と対象の能力を計算
;ABL:従順をみる
TFLAG:97 = ABL:従順

;主人と対象が同性
IF !(TALENT:MASTER:オトコ ^^ TALENT:オトコ)
	;男ならＢＬっ気、女ならレズっ気を見る
	LOCAL = 22 + TALENT:オトコ
	SELECTCASE ABL:LOCAL
		CASE 0
			TFLAG:97 -= 1
		CASE IS < 3
			TFLAG:97 += 0
		CASE IS < 5
			TFLAG:97 += 1
		CASEELSE
			TFLAG:97 += 2
	ENDSELECT
	;男ならＢＬ中毒、女ならレズ中毒を見る
	LOCAL = 32 + TALENT:オトコ
	IF ABL:LOCAL > 4
		TFLAG:97 += 2
	ELSEIF ABL:LOCAL > 2
		TFLAG:97 += 1
	ENDIF
	;両刀
	SIF TALENT:両刀
		TFLAG:97 += 1
ENDIF
;素質による増減
;反抗的
SIF TALENT:反抗的
	TFLAG:97 -= 1
;素直
SIF TALENT:素直 && TFLAG:97 > 0
	TFLAG:97 += 1
;自制心
SIF TALENT:自制心
	TFLAG:97 -= 1
;感情乏しい
SIF TALENT:感情乏しい
	TFLAG:97 -= 1
;抵抗
SIF TALENT:抵抗
	TFLAG:97 -= 1
;献身的
SIF TALENT:献身的 && TFLAG:97 > 0
	TFLAG:97 += 1
;快感に素直
IF TALENT:快感に素直
	TFLAG:97 += 1
;快感の否定
ELSEIF TALENT:快感の否定
	TFLAG:97 -= 1
ENDIF
;男嫌い
IF TALENT:男嫌い && TALENT:MASTER:オトコ
	TFLAG:97 -= 1
;女嫌い
ELSEIF TALENT:女嫌い && TALENT:MASTER:オトコ == 0
	TFLAG:97 -= 1
ENDIF
;恋慕
SIF TALENT:恋慕
	TFLAG:97 += 2
;妄信・相愛
SIF TALENT:妄信 || TALENT:相愛
	TFLAG:97 += 2
;親愛・壊造人格
SIF TALENT:親愛 || TALENT:壊造人格
	TFLAG:97 += 3
;服従
SIF TALENT:服従
	TFLAG:97 += 2
;烙印
SIF TALENT:烙印
	TFLAG:97 += 1
;隷属
SIF TALENT:隷属
	TFLAG:97 += 3
;調教度
IF CFLAG:3668 >= 700
	TFLAG:97 += 1
ELSEIF CFLAG:3668 <= -700
	TFLAG:97 -= 1
ENDIF

;1週目
SIF FLAG:6 == 1
	TFLAG:97 += 1

;主人の魅力
SIF TALENT:MASTER:魅力
	TFLAG:97 += 1
;主人の魅惑
SIF TALENT:MASTER:魅惑
	TFLAG:97 += 1
;主人の謎の魅力
SIF TALENT:MASTER:謎の魅力
	TFLAG:97 += 1
;主人の人気
SIF TALENT:MASTER:人気
	TFLAG:97 += 1
;YASAIモード
SIF TALENT:MASTER:野菜の錬金術師 && TEQUIP:YASAIモードで使用
	TFLAG:97 += 1

;触手インプラント
SIF CFLAG:41
	CALL TENTACLE_INPLANT

TFLAG:97 += TFLAG:50 / 2
;相性による修正
LOCAL:1 = TRAIN_RELATION_CALC(MASTER)
IF LOCAL:1 > 0 && LOCAL:1 != 100 && TFLAG:97 > 0
	TFLAG:97 *= LOCAL:1
	TFLAG:97 /= 100
ENDIF

;反発刻印補正
SELECTCASE FLAG:3
	CASE IS < 3
		TFLAG:97 -= 2 * MARK:反発刻印
	CASE 3
		TFLAG:97 -= 4 * MARK:反発刻印
	CASEELSE
		TFLAG:97 -= 5 * MARK:反発刻印
ENDSELECT

;戦闘中
SIF EQUIP:戦闘中
	TFLAG:97 -= 1

;非陥落なら、恐怖刻印補正(難易度HARD以上のみ)
SIF FLAG:3 > 2 && TALENT:恋慕 == 0 && TALENT:服従 == 0 && TALENT:淫乱 == 0
	TFLAG:97 -= 2 * MARK:恐怖刻印

;ふぉーゆーっ！がしつこすぎると嫌われる
IF TFLAG:143 > 50
	TFLAG:97 -= 10
ELSEIF TFLAG:143 >= 5
	TFLAG:97 -= TFLAG:143 / 5
ENDIF

;神霊の場合、主人が[謎の魅力]を持っていないとなびきにくい
SIF TALENT:神霊 && TALENT:MASTER:謎の魅力 == 0 && TFLAG:97 > 0
	TIMES TFLAG:97 , 0.50
;半神の場合も主人が[謎の魅力]または[魅惑]を持っていないとなびきにくい
SIF TALENT:半神 && TALENT:MASTER:魅惑 == 0 && TALENT:MASTER:謎の魅力 == 0 && TFLAG:97 > 0
	TIMES TFLAG:97 , 0.75
;死神の場合、主人が[仙人]ならばなびきにくい
SIF TALENT:死神 && TALENT:MASTER:仙人
	TIMES TFLAG:97 , 0.75
;仙人の場合、主人が[死神]ならばなびきにくい
SIF TALENT:仙人 && TALENT:MASTER:死神
	TIMES TFLAG:97 , 0.75

;結果が一定数未満の場合
IF MARK:反発刻印 >= 3 && TFLAG:97 < -3
	TFLAG:97 = -3
ELSEIF MARK:反発刻印 == 2 && TFLAG:97 < -2
	TFLAG:97 = -2
ELSEIF MARK:反発刻印 == 1 && TFLAG:97 < -1
	TFLAG:97 = -1
ELSEIF TFLAG:97 < 0
	TFLAG:97 = 0
ENDIF

;精神崩壊の場合、好感度が変化しない
IF TALENT:精神崩壊
	TFLAG:97 = 0
;傀儡の場合、好感度が上昇しにくい
ELSEIF TALENT:傀儡
	TFLAG:97 /= 4
;無関心の場合、恋慕がないと好感度が上がりにくい
ELSEIF TALENT:無関心 && TALENT:恋慕 == 0
	SIF TFLAG:97 > 0
		TFLAG:97 = MAX(TFLAG:97 / 2, 1)
	SIF ABL:従順 >= 4
		TFLAG:97 += 1
ENDIF
;お香の効果(ムスク・フランキンセンス)
SIF (TEQUIP:89 == 5 || TEQUIP:89 == 6) && TEQUIP:野外プレイ == 0 && TEQUIP:お風呂場プレイ == 0 && TEQUIP:特殊風呂入浴中 == 0
	TFLAG:97 += RAND:3

;何もしないを使用した場合は上限を0にする
SIF TFLAG:97 > 0 && SELECTCOM == 9
	TFLAG:97 = 0
;戦闘中の場合は上限を0にする
SIF TFLAG:97 > 0 && EQUIP:戦闘中
	TFLAG:97 = 0
;ふぉーゆーっ！がしつこすぎると嫌われる
SIF TFLAG:143 > 10
	TFLAG:97 -= 1

;死亡中・睡眠中・時止め中・失神中は変動なし
IF TALENT:死亡 || EQUIP:睡眠薬 || TEQUIP:時間止め || TFLAG:899 > 0
	TFLAG:97 = 0
;獣姦系コマンドは好感度の上昇が最大で0
ELSEIF TFLAG:98 == 9 && TFLAG:97 > 0
	TFLAG:97 = 0
;触手プレイ中は好感度減少(触手中毒が大きいと減少値は小さくなる)
ELSEIF TEQUIP:触手調教
	TFLAG:97 -= (5 - ABL:触手中毒)
;裸エプロン装着中は好感度が2以上アップすると愛情経験が＋1
ELSEIF TFLAG:97 > 1 && TEQUIP:コスチュームプレイ == 1
	TCVAR:愛情経験 += 1
;相愛持ちの場合ウェディングドレスコスプレ中は好感度が5以上アップすると愛情経験が＋1（助手はだめ）
ELSEIF TFLAG:97 > 4 && TALENT:相愛 && TEQUIP:コスチュームプレイ == 19
	TCVAR:愛情経験 += 1
ENDIF

;好感度
SIF CFLAG:好感度 < 0 && TFLAG:97 > 0
	TFLAG:97 -= 1
TFLAG:238 += TFLAG:97
;好感度は0以下にも100万以上にもならない
IF CFLAG:好感度 < 0
	CFLAG:好感度 = MAX(CFLAG:好感度 + TFLAG:97, -999999)
ELSE
	CFLAG:好感度 = LIMIT(CFLAG:好感度 + TFLAG:97, 0, 999999)
ENDIF

;フラグが立ってなく、触手プレイ中以外は主人調教経験も追加
SIF TEQUIP:触手調教 == 0 && TFLAG:59 == 0 && !EQUIP:戦闘中
	TCVAR:主人調教経験 += 1

;-------------------------------------------------
;調教度
;-------------------------------------------------
;調教度は1000以上に上昇させることはできない
@TARGET_ACCEPTANCE_MAIN

TFLAG:550 = 0
;今回の調教ターンでのＣ絶頂、Ｖ絶頂、Ａ絶頂、Ｂ絶頂
REPEAT 4
	SIF NOWEX:COUNT > 0
		TFLAG:550 += 8
REND
;今回の調教ターンでの調教対象の射精
SIF TFLAG:30 > 0
	TFLAG:550 += 8
;今回の調教ターンでの調教対象の噴乳
SIF TFLAG:31 > 0
	TFLAG:550 += 8
;今回の調教ターンでの調教対象の放尿
SIF TFLAG:32 > 0
	TFLAG:550 += 8

;射精
FOR PC_VAR1, 10, 29
	SIF TFLAG:PC_VAR1 > 0 && (EXP:精液経験 + TCVAR:精液経験) >= EXPLV:3
		TFLAG:550 += TFLAG:PC_VAR1 * 4
NEXT

;対象の能力を計算
;ABL:従順をみる
SELECTCASE ABL:従順
CASE 0
	TFLAG:550 -= 25
CASE 1
	TFLAG:550 -= 17
CASE 2
	TFLAG:550 -= 9
CASE 3
	TFLAG:550 -= 0
CASE 4
	TFLAG:550 += 7
CASEELSE
	TFLAG:550 += 15
ENDSELECT

;属性補正
REPEAT 25
	SIF !(GROUPMATCH(COUNT, 12, 13, 14, 15, 16, 17, 20, 21, 22))
		CONTINUE
	GETPALAMLV PALAM:COUNT, ( TALENT:恋慕 || TALENT:服従 || TALENT:淫乱 ) ? 14 # 13
	LOCAL:COUNT = RESULT
REND
TFLAG:550 += (LOCAL:12 + LOCAL:13 + LOCAL:14 + LOCAL:15 + LOCAL:16 + LOCAL:17 - (LOCAL:20 + LOCAL:21 + LOCAL:22) * 2) * 3

;刻印補正
TFLAG:550 += (MARK:苦痛刻印 +  MARK:快楽刻印 +  MARK:屈服刻印 +  MARK:薬物刻印 +  MARK:恥辱刻印 +  MARK:恐怖刻印) * 4 -  MARK:反発刻印 * 12
SIF MARK:反発刻印 >= 3
	TFLAG:550 -= 8

TFLAG:550 += TFLAG:51

;主人と対象が同性
IF !(TALENT:MASTER:オトコ ^^ TALENT:オトコ)
	;男ならＢＬっ気、女ならレズっ気を見る
	LOCAL = 22 + TALENT:オトコ
	SELECTCASE ABL:LOCAL
		CASE 0
			TFLAG:550 -= 7
		CASE IS < 3
			TFLAG:550 += 0
		CASE IS < 5
			TFLAG:550 += 7
		CASEELSE
			TFLAG:550 += 14
	ENDSELECT
	;男ならＢＬ中毒、女ならレズ中毒を見る
	LOCAL = 32 + TALENT:オトコ
	IF ABL:LOCAL > 4
		TFLAG:550 += 14
	ELSEIF ABL:LOCAL > 2
		TFLAG:550 += 7
	ENDIF
	;両刀
	SIF TALENT:両刀
		TFLAG:550 += 7
ENDIF

;素質補正
IF TFLAG:550 > 0

;発情中
SIF TALENT:常時発情 || (TALENT:発情可 && (TALENT:危険日 || TALENT:排卵))
	TIMES TFLAG:550, 1.10
;反抗的
SIF TALENT:反抗的
	TIMES TFLAG:550, 0.85
;素直
SIF TALENT:素直
	TIMES TFLAG:550, 1.10
;自制心
SIF TALENT:自制心
	TIMES TFLAG:550, 0.85
;感情乏しい
SIF TALENT:感情乏しい
	TIMES TFLAG:550, 0.85
;抵抗
SIF TALENT:抵抗
	TIMES TFLAG:550, 0.85
;献身的
SIF TALENT:献身的
	TIMES TFLAG:550, 1.10
;快感に素直
IF TALENT:快感に素直
	TIMES TFLAG:550, 1.10
;快感の否定
ELSEIF TALENT:快感の否定
	TIMES TFLAG:550, 0.85
ENDIF
;男嫌い
IF TALENT:男嫌い && TALENT:MASTER:オトコ
	TIMES TFLAG:550, 0.85
;女嫌い
ELSEIF TALENT:女嫌い && TALENT:MASTER:オトコ == 0
	TIMES TFLAG:550, 0.85
ENDIF
;恋慕
SIF TALENT:恋慕
	TIMES TFLAG:550, 1.20
;妄信・相愛
SIF TALENT:妄信 || TALENT:相愛
	TIMES TFLAG:550, 1.20
;親愛・壊造人格
SIF TALENT:親愛 || TALENT:壊造人格
	TIMES TFLAG:550, 1.30
;服従
SIF TALENT:服従
	TIMES TFLAG:550, 1.20
;烙印
SIF TALENT:烙印
	TIMES TFLAG:550, 1.20
;隷属
SIF TALENT:隷属
	TIMES TFLAG:550, 1.30
;理性
SIF TALENT:理性
	TIMES TFLAG:550, 0.95
;調教度
IF CFLAG:3668 <= -700
	TIMES TFLAG:550, 0.70
ELSEIF CFLAG:3668 <= -350
	TIMES TFLAG:550, 0.80
ELSEIF CFLAG:3668 <= 0
	TIMES TFLAG:550, 0.90
ENDIF
;ＮＴＲ
SIF TALENT:思い人あり || TALENT:彼氏あり || TALENT:旦那あり
	TIMES TFLAG:550, 0.80

;主人の魅力
SIF TALENT:MASTER:魅力
	TIMES TFLAG:550, 1.10
;主人の魅惑
SIF TALENT:MASTER:魅惑
	TIMES TFLAG:550, 1.10
;主人の謎の魅力
SIF TALENT:MASTER:謎の魅力
	TIMES TFLAG:550, 1.10
;主人の人気
SIF TALENT:MASTER:人気
	TIMES TFLAG:550, 1.10
;YASAIモード
SIF TALENT:MASTER:野菜の錬金術師 && TEQUIP:YASAIモードで使用
	TIMES TFLAG:550, 1.10
	
;1週目
SIF FLAG:6 == 1
	TIMES TFLAG:550, 1.20

;HARD
IF FLAG:3 == 3
	TIMES TFLAG:550, 0.90
;LUNATIC/ULTRA
ELSEIF FLAG:3 == 4 || FLAG:3 == 6
	TIMES TFLAG:550, 0.75
;PHANTASM/OVERDRIVE
ELSEIF FLAG:3 >= 5
	TIMES TFLAG:550, 0.60
ENDIF

ELSEIF TFLAG:550 < 0

;発情中
SIF TALENT:常時発情 || (TALENT:発情可 && (TALENT:危険日 || TALENT:排卵))
	TIMES TFLAG:550, 0.85
;反抗的
SIF TALENT:反抗的
	TIMES TFLAG:550, 1.10
;素直
SIF TALENT:素直
	TIMES TFLAG:550, 0.85
;自制心
SIF TALENT:自制心
	TIMES TFLAG:550, 1.10
;感情乏しい
SIF TALENT:感情乏しい
	TIMES TFLAG:550, 1.10
;抵抗
SIF TALENT:抵抗
	TIMES TFLAG:550, 1.10
;献身的
SIF TALENT:献身的
	TIMES TFLAG:550, 0.85
;快感に素直
IF TALENT:快感に素直
	TIMES TFLAG:550, 0.85
;快感の否定
ELSEIF TALENT:快感の否定
	TIMES TFLAG:550, 1.10
ENDIF
;男嫌い
IF TALENT:男嫌い && TALENT:MASTER:オトコ
	TIMES TFLAG:550, 1.10
;女嫌い
ELSEIF TALENT:女嫌い && TALENT:MASTER:オトコ == 0
	TIMES TFLAG:550, 1.10
ENDIF
;恋慕
SIF TALENT:恋慕
	TIMES TFLAG:550, 0.80
;妄信・相愛
SIF TALENT:妄信 || TALENT:相愛
	TIMES TFLAG:550, 0.80
;親愛・壊造人格
SIF TALENT:親愛 || TALENT:壊造人格
	TIMES TFLAG:550, 0.70
;服従
SIF TALENT:服従
	TIMES TFLAG:550, 0.80
;烙印
SIF TALENT:烙印
	TIMES TFLAG:550, 0.80
;隷属
SIF TALENT:隷属
	TIMES TFLAG:550, 0.70
;理性
SIF TALENT:理性
	TIMES TFLAG:550, 1.05
;調教度
IF CFLAG:3668 <= -700
	TIMES TFLAG:550, 1.30
ELSEIF CFLAG:3668 <= -350
	TIMES TFLAG:550, 1.20
ELSEIF CFLAG:3668 <= 0
	TIMES TFLAG:550, 1.10
ENDIF
;ＮＴＲ
SIF TALENT:思い人あり || TALENT:彼氏あり || TALENT:旦那あり
	TIMES TFLAG:550, 1.20

;主人の魅力
SIF TALENT:MASTER:魅力
	TIMES TFLAG:550, 0.85
;主人の魅惑
SIF TALENT:MASTER:魅惑
	TIMES TFLAG:550, 0.85
;主人の謎の魅力
SIF TALENT:MASTER:謎の魅力
	TIMES TFLAG:550, 0.85
;主人の人気
SIF TALENT:MASTER:人気
	TIMES TFLAG:550, 0.85
;YASAIモード
SIF TALENT:MASTER:野菜の錬金術師 && TEQUIP:YASAIモードで使用
	TIMES TFLAG:550, 0.85
	
;1週目
SIF FLAG:6 == 1
	TIMES TFLAG:550, 0.80

;HARD
IF FLAG:3 == 3
	TIMES TFLAG:550, 1.10
;LUNATIC/ULTRA
ELSEIF FLAG:3 == 4 || FLAG:3 == 6
	TIMES TFLAG:550, 1.25
;PHANTASM/OVERDRIVE
ELSEIF FLAG:3 >= 5
	TIMES TFLAG:550, 1.40
ENDIF
	
ENDIF

;触手インプラント
SIF CFLAG:41
	CALL TENTACLE_INPLANT_2

;相性による修正
LOCAL:1 = TRAIN_RELATION_CALC(MASTER)
IF LOCAL:1 > 0 && LOCAL:1 != 100 && TFLAG:550 > 0
	TFLAG:550 *= LOCAL:1
	TFLAG:550 /= 100
ENDIF

;ふぉーゆーっ！がしつこすぎると嫌われる
IF TFLAG:143 > 60
	TFLAG:550 -= 15
ELSEIF TFLAG:143 >= 4
	TFLAG:550 -= TFLAG:143 / 4
ENDIF


;神霊の場合、主人が[謎の魅力]を持っていないとなびきにくい
SIF TALENT:神霊 && TALENT:MASTER:謎の魅力 == 0 && TFLAG:550 > 0
	TIMES TFLAG:550 , 0.50
;半神の場合も主人が[謎の魅力]または[魅惑]を持っていないとなびきにくい
SIF TALENT:半神 && TALENT:MASTER:魅惑 == 0 && TALENT:MASTER:謎の魅力 == 0 && TFLAG:550 > 0
	TIMES TFLAG:550 , 0.75
;死神の場合、主人が[仙人]ならばなびきにくい
SIF TALENT:死神 && TALENT:MASTER:仙人
	TIMES TFLAG:550 , 0.75
;仙人の場合、主人が[死神]ならばなびきにくい
SIF TALENT:仙人 && TALENT:MASTER:死神
	TIMES TFLAG:550 , 0.75

;従順をみる
SIF ABL:従順 < 2 && TFLAG:550 > 0
	TIMES TFLAG:550, 0.80

;主人による調教経験
SELECTCASE EXP:主人調教経験
	CASE IS >= 500
		TFLAG:550 += 30
	CASE IS >= 300
		TFLAG:550 += 20
	CASE IS >= 100
		TFLAG:550 += 10
ENDSELECT

;何もしないを使用した場合
SIF SELECTCOM == 9
	TIMES TFLAG:550, 0.50
;死亡中・睡眠中・時止め中・失神中は変動なし
SIF EQUIP:睡眠薬 || TEQUIP:時間止め || TFLAG:899 > 0
	TFLAG:550 = 0

TIMES TFLAG:550, 0.30
IF CFLAG:3668 < 1000
	CFLAG:3668 = LIMIT(CFLAG:3668 + TFLAG:550, -1000, 1000)
ELSE
	TFLAG:550 = 0
ENDIF
TFLAG:245 += TFLAG:550

;-------------------------------------------------
;主人による調教のボーナス
;-------------------------------------------------
@MASTER_SKILL_CHECK
;嫉妬
IF TALENT:嫉妬 && ASSI < 0
	TIMES SOURCE:情愛 , 1.30
	TIMES SOURCE:中毒充足 , 1.50
	TIMES SOURCE:逸脱 , 0.50
	TIMES SOURCE:反感追加 , 0.50
ENDIF

;主人による調教でなければ帰る
SIF ASSIPLAY
	RETURN 0

;主人による調教経験
SELECTCASE EXP:主人調教経験
	CASE IS >= 500
		TIMES SOURCE:快Ｃ , 1.20
		TIMES SOURCE:快Ｖ , 1.20
		TIMES SOURCE:快Ａ , 1.20
		TIMES SOURCE:快Ｂ , 1.20
		TIMES SOURCE:情愛 , 1.30
		TIMES SOURCE:不潔 , 0.70
		TIMES SOURCE:逸脱 , 0.70
	CASE IS >= 300
		TIMES SOURCE:快Ｃ , 1.10
		TIMES SOURCE:快Ｖ , 1.10
		TIMES SOURCE:快Ａ , 1.10
		TIMES SOURCE:快Ｂ , 1.10
		TIMES SOURCE:情愛 , 1.20
		TIMES SOURCE:不潔 , 0.80
		TIMES SOURCE:逸脱 , 0.80
	CASE IS >= 100
		TIMES SOURCE:情愛 , 1.10
		TIMES SOURCE:不潔 , 0.90
		TIMES SOURCE:逸脱 , 0.90
ENDSELECT

;淫乱、恋慕、親愛は主人経験との重複前提で計算
;淫乱
IF TALENT:淫乱
	TIMES SOURCE:快Ｃ , 1.80
	TIMES SOURCE:快Ｖ , 1.80
	TIMES SOURCE:快Ａ , 1.80
	TIMES SOURCE:快Ｂ , 1.80
ENDIF

;親愛
IF TALENT:親愛
	TIMES SOURCE:快Ｃ , 1.50
	TIMES SOURCE:快Ｖ , 1.50
	TIMES SOURCE:快Ａ , 1.50
	TIMES SOURCE:快Ｂ , 1.50
	TIMES SOURCE:情愛 , 2.00
	TIMES SOURCE:性行動 , 1.50
	TIMES SOURCE:達成感 , 1.50
	TIMES SOURCE:中毒充足 , 1.20
;恋慕
ELSEIF TALENT:恋慕
	TIMES SOURCE:快Ｃ , 1.30
	TIMES SOURCE:快Ｖ , 1.30
	TIMES SOURCE:快Ａ , 1.30
	TIMES SOURCE:快Ｂ , 1.30
	TIMES SOURCE:情愛 , 1.80
ENDIF
;[恋慕]か[親愛]持ちが処女(乙女ではなく)を今回の調教で散らせた場合
IF (TALENT:恋慕 || TALENT:親愛) && TALENT:処女 == 1 && TFLAG:2
	LOCAL:1 = 0
	LOCAL = NO:PLAYER
	;主人との相性が100%以上で痛みのソースが2000未満で反感追加のソースが3000以下
	SIF (RELATION:LOCAL == 0 || RELATION:LOCAL >= 100) && SOURCE:痛み < 2000 && SOURCE:反感追加 <= 3000
		LOCAL:1 += 1
	;Ｖ系装着器具、Ａ系装着器具、Ｃ系装着器具（コンドーム除く）、Ｕ系装着器具、Ｂ系装着器具、サラシを装着していない
	SIF TEQUIP:Ｖ系装着器具 == 0 && TEQUIP:クスコ == 0 && TEQUIP:Ａ系装着器具 == 0 && TEQUIP:氷柱 == 0 && TEQUIP:Ｃ系装着器具 == 0 && TEQUIP:Ｕ系装着器具 == 0 && TEQUIP:Ｂ系装着器具 == 0 && TEQUIP:サラシ == 0
		LOCAL:1 += 1
	;緊縛しておらず、目隠しせず、口封じせず、木馬に乗せず、ビデオを撮影してなくて、ビデオを鑑賞してなくて、野外プレイでなくて、シャワー中でなかったり、特殊な風呂に入ってなくて、触手プレイでない場合
	SIF TEQUIP:緊縛関連 == 0 && TEQUIP:目装着器具 == 0 && TEQUIP:口装着器具 == 0 && TEQUIP:三角木馬乗馬中 == 0 && TEQUIP:ビデオ撮影 == 0 && TEQUIP:ビデオ鑑賞 == 0 && TEQUIP:野外プレイ == 0 && TEQUIP:シャワープレイ == 0 && TEQUIP:特殊風呂入浴中 == 0 && TEQUIP:触手調教 == 0
		LOCAL:1 += 1
	;上の３条件を満たしてなおかつ調教テキストを表示する設定であるならば幸福を感じていることを表示し、なおかつ反発刻印回避フラグを立てる
	IF LOCAL:1 == 3 && FLAG:10
		PRINTFORML %CALLNAME:TARGET%は%CALLNAME:MASTER%に処女を捧げられた事に幸福を感じているようだ…
		TFLAG:105 = 1
	ENDIF
	;情愛のソース倍増
	TIMES SOURCE:情愛 , 2.00
	;親愛なら反感追加のソースが1/10に
	IF TALENT:親愛
		TIMES SOURCE:反感追加 , 0.10
	;親愛なくても反感追加のソースは30%に
	ELSE
		TIMES SOURCE:反感追加 , 0.30
	ENDIF
ENDIF

;-------------------------------------------------
;助手との調教経験のカウント（妊娠パッチ用）
;-------------------------------------------------
@ASSI_EXP_COUNT
;この経験の多さで妊娠発覚時の分岐が決まる
;要バランス調整
LOCAL = 100
LOCAL:1 = 100

LOCAL:2 = NO:ASSI + 10000
LOCAL:3 = NO:TARGET + 10000

;相性による補正
IF RELATION:(NO:ASSI) != 0
	LOCAL *= RELATION:(NO:ASSI)
	LOCAL /= 100
ENDIF
IF RELATION:ASSI:(NO:TARGET) != 0
	LOCAL:1 *= RELATION:ASSI:(NO:TARGET)
	LOCAL:1 /= 100
ENDIF

;共通部分
;これまでの経験がかなり多ければプラス補正
LOCAL += CFLAG:(LOCAL:2) / 100
LOCAL:1 += CFLAG:ASSI:(LOCAL:3) / 100
;欲情で補正
IF ABL:欲望 > 0
	LOCAL *= (100 + ABL:欲望 * ABL:欲望 * 4)
	LOCAL /= 100
ENDIF
IF ABL:ASSI:欲望 > 0
	LOCAL:1 *= (100 + ABL:ASSI:欲望 * ABL:ASSI:欲望 * 4)
	LOCAL:1 /= 100
ENDIF
;自制心で補正
SIF TALENT:自制心
	LOCAL /= 2
SIF TALENT:ASSI:自制心
	LOCAL:1 /= 2
;無関心で補正
SIF TALENT:無関心
	TIMES LOCAL, 0.80
SIF TALENT:ASSI:無関心
	TIMES LOCAL:1, 0.80
;感情乏しいで補正
SIF TALENT:感情乏しい
	LOCAL /= 4
SIF TALENT:ASSI:感情乏しい
	LOCAL:1 /= 4
;一線越えないで補正
SIF TALENT:一線越えない
	LOCAL /= 2
SIF TALENT:ASSI:一線越えない
	LOCAL:1 /= 2
;快感の否定で補正
SIF TALENT:快感の否定
	LOCAL /= 3
SIF TALENT:ASSI:快感の否定
	LOCAL:1 /= 3
;素直で補正
SIF TALENT:素直
	TIMES LOCAL, 1.2
SIF TALENT:ASSI:素直
	TIMES LOCAL:1, 1.2
;好奇心で補正
SIF TALENT:好奇心
	TIMES LOCAL, 1.2
SIF TALENT:ASSI:好奇心
	TIMES LOCAL:1 , 1.2
;献身的で補正
SIF TALENT:献身的
	TIMES LOCAL, 1.25
SIF TALENT:ASSI:献身的
	TIMES LOCAL:1, 1.25
;快感に素直で補正
SIF TALENT:快感に素直
	LOCAL *= 2
SIF TALENT:ASSI:快感に素直
	LOCAL:1 *= 2
;倒錯的で補正
SIF TALENT:倒錯的
	TIMES LOCAL, 1.5
SIF TALENT:ASSI:倒錯的
	TIMES LOCAL:1, 1.5
;魅力で補正
SIF TALENT:魅力
	TIMES LOCAL:1, 1.2
SIF TALENT:ASSI:魅力
	TIMES LOCAL, 1.2
;魅惑で補正
SIF TALENT:魅惑
	TIMES LOCAL:1, 1.2
SIF TALENT:ASSI:魅惑
	TIMES LOCAL, 1.2
;謎の魅力で補正
SIF TALENT:謎の魅力
	TIMES LOCAL:1, 1.3
SIF TALENT:ASSI:謎の魅力
	TIMES LOCAL, 1.3
;小悪魔で補正
SIF TALENT:小悪魔
	TIMES LOCAL:1, 1.1
SIF TALENT:ASSI:小悪魔
	TIMES LOCAL, 1.1
;人気で補正
SIF TALENT:人気
	TIMES LOCAL:1, 1.25
SIF TALENT:ASSI:人気
	TIMES LOCAL, 1.25

;素質依存の部分（オトコがらみ）
IF TALENT:オトコ == 0 && TALENT:ASSI:オトコ == 0
	;女嫌いならマイナス補正（両方）
	SIF TALENT:女嫌い
		LOCAL /= 2
	SIF TALENT:ASSI:女嫌い
		LOCAL:1 /= 2
	;両刀ならプラス補正
	SIF TALENT:両刀
		LOCAL *= 2
	SIF TALENT:ASSI:両刀
		LOCAL:1 *= 2
	;レズっ気の補正
	IF ABL:レズっ気 > 0
		LOCAL *= (100 + ABL:レズっ気 * 10)
		LOCAL /= 100
	ENDIF
	IF ABL:ASSI:レズっ気 > 0
		LOCAL:1 *= (100 + ABL:ASSI:レズっ気 * 10)
		LOCAL:1 /= 100
	ENDIF
	;レズ中毒の補正
	IF ABL:レズ中毒 > 0
		LOCAL *= (100 + ABL:レズ中毒 * 25)
		LOCAL /= 100
	ENDIF
	IF ABL:ASSI:レズ中毒 > 0
		LOCAL:1 *= (100 + ABL:ASSI:レズ中毒 * 25)
		LOCAL:1 /= 100
	ENDIF
ELSEIF TALENT:オトコ && TALENT:ASSI:オトコ == 0
	;女嫌いならマイナス補正（奴隷）
	SIF TALENT:女嫌い
		LOCAL /= 2
	;男嫌いならマイナス補正（助手）
	SIF TALENT:男嫌い
		LOCAL:1 /= 2
ELSEIF TALENT:オトコ == 0 && TALENT:ASSI:オトコ
	;男嫌いならマイナス補正（奴隷）
	SIF TALENT:男嫌い
		LOCAL:1 /= 2
	;女嫌いならマイナス補正（助手）
	SIF TALENT:女嫌い
		LOCAL /= 2
ELSE
	;男嫌いならマイナス補正（両方）
	SIF TALENT:男嫌い
		LOCAL /= 2
	SIF TALENT:ASSI:男嫌い
		LOCAL:1 /= 2
	;両刀ならプラス補正
	SIF TALENT:両刀
		LOCAL *= 2
	SIF TALENT:ASSI:両刀
		LOCAL:1 *= 2
ENDIF

;助手調教経験加算処理（100000まで）
CFLAG:(LOCAL:2) = MIN(CFLAG:(LOCAL:2) + LOCAL / 100, 100000)
CFLAG:ASSI:(LOCAL:3) = MIN(CFLAG:ASSI:(LOCAL:3) + LOCAL:1 / 100, 100000)

;助手調教中は助手経験も追加
TCVAR:ASSI:助手経験 += 1

;=============================================================================
;特殊絶頂処理
;=============================================================================
;-------------------------------------------------
;調教対象の射精チェック
;-------------------------------------------------
;奴隷の射精済みフラグTFLAG:705が立っていない場合はここで射精するかどうか判定
;・パターン1:COMFに射精処理があるコマンド（逆レイプやフェラするなど）を実行し、COMFの段階では射精に至らなかった場合
;			COMFを抜けた後でＣ敏感やPALAMの補正がかかるので、COMFの段階では射精に至らなくてもここの段階で射精に至る場合がありうる
;・パターン2:COMFに射精処理がないコマンド（愛撫や亀頭責めなど）を実行した場合
;			UP:0やUP:1の値によっては射精に至る。なお、亀頭責めは射精ゲージがMAXになっても空射精する特殊なコマンドである
@TARGET_EJAC_CHECK
LOCAL = UP:0 + UP:1 / 5 + UP:2 / 50 + UP:3 / 50

;自制心
SIF TALENT:自制心
	LOCAL /= 2
;快感に素直
IF TALENT:快感に素直
	TIMES LOCAL , 1.20
;快感の否定
ELSEIF TALENT:快感の否定
	TIMES LOCAL , 0.80
ENDIF
;淫乱
SIF TALENT:淫乱
	TIMES LOCAL , 1.10

;媚薬
SIF TEQUIP:媚薬
	LOCAL *= 2
;利尿剤
SIF TEQUIP:利尿剤
	LOCAL /= 2
;淫蟲
SIF TEQUIP:特殊風呂入浴中 == 1
	LOCAL *= 2

;触手インプラント
SIF CFLAG:41 & 1
	TIMES LOCAL , 1.25

LOCAL = 500 + LOCAL / 2
BASE:射精 += LOCAL

TFLAG:91 = SAMEN_CHECK(TARGET)

IF TFLAG:91 >= 1
	;射精した人物を設定
	TFLAG:92 = TARGET
	;射精された人物を設定
	TFLAG:94 = PLAYER
	;COMF内のデフォルト射精箇所タイプと射精箇所選択の可・不可（奴隷の射精では使わないが一応）をチェック
	;COMFに無い場合は、デフォルト射精箇所をその他にする
	TRYCCALLFORM COM_SHOOT_{SELECTCOM}
	CATCH
		TFLAG:703 = 15
		TFLAG:704 = 0
	ENDCATCH
	;汎用的な処理はこの関数で行う
	;（射精ゲージの再計算や射精経験の上昇と共通部分の表示）
	TFLAG:960 |= 3
	CALL SAMEN_SHOOT
ELSE
	TFLAG:960 = 0
ENDIF

;-------------------------------------------------
;調教対象の噴乳チェック
;-------------------------------------------------
@TARGET_MILK_CHECK
LOCAL = UP:0 / 50 + UP:1 / 50 + UP:2 / 50 + UP:3 * 3

;自制心
SIF TALENT:自制心
	LOCAL /= 2
;快感に素直
IF TALENT:快感に素直
	TIMES LOCAL , 1.20
;快感の否定
ELSEIF TALENT:快感の否定
	TIMES LOCAL , 0.80
ENDIF
;Ｂ敏感
SIF TALENT:Ｂ敏感
	TIMES LOCAL , 1.50
;貧乳
SIF TALENT:貧乳
	TIMES LOCAL , 0.50
;淫乱
SIF TALENT:淫乱
	TIMES LOCAL , 1.10

;媚薬
SIF TEQUIP:媚薬
	LOCAL *= 2
;利尿剤
SIF TEQUIP:利尿剤
	LOCAL /= 2
;淫蟲
SIF TEQUIP:特殊風呂入浴中 == 1
	LOCAL *= 2

;調教者が幼児
SIF TALENT:PLAYER:幼児
	LOCAL *= 2
;調教者が幼稚
SIF TALENT:PLAYER:幼稚
	LOCAL *= 2

;噴乳中毒のレベルを見る
SELECTCASE ABL:噴乳中毒
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.05
	CASE 2
		TIMES LOCAL , 1.10
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.30
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT

;触手インプラント
SIF CFLAG:41 & 8
	TIMES LOCAL , 1.25

LOCAL = 400 + 50 * RAND:3 + LOCAL / 2
BASE:母乳 += LOCAL

LOCAL:1 = BASE:母乳
EJAC = MAXBASE:3

IF LOCAL:1 > EJAC * 2
	LOCAL:2 = 2
ELSEIF LOCAL:1 > EJAC
	LOCAL:2 = 1
ELSE
	LOCAL:2 = 0
	TFLAG:959 = 0
ENDIF

;Ｂ系拡張コマンド有効の場合、Ｂ刺激がないと噴乳できない
IF LOCAL:2 >= 1 && FLAG:15 & 8 && UP:3 == 0 && NOWEX:23 == 0
	SOURCE:欲情追加 += ((BASE:母乳 * 10) / MAXBASE:3)
	SOURCE:痛み += ((BASE:母乳 * 5) / MAXBASE:3)
	TIMES SOURCE:欲情追加 , 1.10
	TIMES SOURCE:痛み , 1.10
	SETCOLOR COLOR("P-RED")
	PRINTL ＜噴乳渇望中＞
	RESETCOLOR
	BASE:母乳 = EJAC-1
	TFLAG:959 = 0
	;噴乳渇望中におけるイベント口上呼び出し
	CALL DISPLAY_KOJO_MESSAGE_SUB_EVENT, TARGET, 21
;大量噴乳寸止め
ELSEIF LOCAL:2 == 2 && TEQUIP:焦らしプレイ
	SOURCE:欲情追加 += 400
	SOURCE:屈従 += 500
	SETCOLOR COLOR("WHITE")
	PRINTFORML %CALLNAME:TARGET%大量噴乳寸止め
	RESETCOLOR
	BASE:母乳 = EJAC-1
	TSTR:91 = 大量噴乳寸止め
	TFLAG:959 |= 4
	NOWEX:31 += 2
	EX:31 += 2
;通常の噴乳寸止め
ELSEIF LOCAL:2 == 1 && TEQUIP:焦らしプレイ
	SOURCE:欲情追加 += 150
	SOURCE:屈従 += 250
	SETCOLOR COLOR("WHITE")
	PRINTFORML %CALLNAME:TARGET%噴乳寸止め
	RESETCOLOR
	BASE:母乳 = EJAC-1
	TSTR:91 = 噴乳寸止め
	TFLAG:959 |= 4
	NOWEX:31 += 1
	EX:31 += 1
;大量噴乳
ELSEIF LOCAL:2 == 2
	DOWNBASE:0 += 20
	DOWNBASE:1 += 100
	DOWNBASE:9 += 400

	;対象の噴乳経験を見る
	SELECTCASE EXP:噴乳経験
		CASE IS < EXPLV:1
			SOURCE:露出 += 20000
			SOURCE:屈従 += 10000
		CASE IS < EXPLV:2
			SOURCE:露出 += 10000
			SOURCE:屈従 += 8000
		CASE IS < EXPLV:3
			SOURCE:露出 += 7000
			SOURCE:屈従 += 6000
		CASE IS < EXPLV:4
			SOURCE:露出 += 5000
			SOURCE:屈従 += 4000
		CASE IS < EXPLV:5
			SOURCE:露出 += 3000
			SOURCE:屈従 += 2000
		CASEELSE
			SOURCE:露出 += 1800
			SOURCE:屈従 += 1200
	ENDSELECT

	SETCOLOR COLOR("WHITE")
	PRINTFORML %CALLNAME:TARGET%\@(TEQUIP:サラシ) ? が付けているサラシから勢いよく # の乳首から大量の\@母乳が噴出した。
	RESETCOLOR
	SIF EXP:噴乳経験 == 0
		TCVAR:異常経験 += 1
	TCVAR:噴乳経験 += 2
	;Ｂに母乳汚れ
	STAIN:胸 |= 16

	BASE:母乳 -= EJAC*2
	TSTR:91 = 大量噴乳
	TFLAG:959 |= 4

	;調教対象が噴乳フラグ
	TFLAG:31 += 2
	NOWEX:10 += 2
	EX:10 += 2

	;搾乳器で母乳が集められているかチェック
	SIF TEQUIP:Ｂ系装着器具 == 2
		TFLAG:126 += 2
;通常の噴乳
ELSEIF LOCAL:2 == 1
	DOWNBASE:1 += 40
	DOWNBASE:9 += 160

	;対象の噴乳経験を見る
	SELECTCASE EXP:噴乳経験
		CASE IS < EXPLV:1
			SOURCE:露出 += 10000
			SOURCE:屈従 += 5000
		CASE IS < EXPLV:2
			SOURCE:露出 += 5000
			SOURCE:屈従 += 4000
		CASE IS < EXPLV:3
			SOURCE:露出 += 2500
			SOURCE:屈従 += 2000
		CASE IS < EXPLV:4
			SOURCE:露出 += 1600
			SOURCE:屈従 += 1400
		CASE IS < EXPLV:5
			SOURCE:露出 += 800
			SOURCE:屈従 += 500
		CASEELSE
			SOURCE:露出 += 200
			SOURCE:屈従 += 250
	ENDSELECT

	SETCOLOR COLOR("WHITE")
	PRINTFORML %CALLNAME:TARGET%\@(TEQUIP:サラシ) ? が付けているサラシから母乳が滴り落ちている # の乳首から母乳が垂れ出ている\@。
	RESETCOLOR
	SIF EXP:噴乳経験 == 0
		TCVAR:異常経験 += 1
	TCVAR:噴乳経験 += 1
	;Ｂに母乳汚れ
	STAIN:胸 |= 16

	BASE:母乳 -= EJAC
	TSTR:91 = 噴乳
	TFLAG:959 |= 4

	;調教対象が噴乳フラグ
	TFLAG:31 += 1
	NOWEX:10 += 1
	EX:10 += 1

	;搾乳器で母乳が集められているかチェック
	SIF TEQUIP:Ｂ系装着器具 == 2
		TFLAG:126 += 1
ENDIF
BASE:母乳 = MIN(BASE:母乳, EJAC - 1)
BASE:母乳 = MAX(BASE:母乳, 0)

;母乳回収
SIF TFLAG:31 > 0 && FLAG:12 & 8 && TFLAG:125 == 0 && CFLAG:10 & 256 && TEQUIP:焦らしプレイ == 0
	CALL SWEET_POTATO_MILK

;-------------------------------------------------
;調教対象の放尿チェック
;-------------------------------------------------
@TARGET_PEE_CHECK
LOCAL = UP:0 / 3 + UP:1 / 10 + UP:2 / 50 + UP:3 / 50
;おもらし癖を持たない
IF TEQUIP:利尿剤 == 0 && TALENT:おもらし癖 == 0
	LOCAL /= 20
ENDIF

;飲み物
IF GROUPMATCH(SELECTCOM, 61, 62, 65, 66, 67, 68, 69, 70, 72)
	IF GROUPMATCH(PREVCOM, 61, 62, 65, 66, 67, 68, 69, 70, 72)
		LOCAL += MAX((TEQUIP:46 + 1) / 2, 1) * RAND(200, 301)
	ELSE
		LOCAL += MAX((TEQUIP:46 + 1) / 2, 1) * RAND(100, 201)
	ENDIF
ENDIF

;水を飲ませる
IF SELECTCOM == 253
	LOCAL += TEQUIP:46 * RAND(300, 501)
ELSEIF TEQUIP:46
	LOCAL += TEQUIP:46 * RAND(100, 201)
ENDIF

;臆病
SIF TALENT:臆病
	TIMES LOCAL , 1.30
;反抗的
SIF TALENT:反抗的
	TIMES LOCAL , 0.60
;プライド高い
IF TALENT:プライド高い
	TIMES LOCAL , 0.60
;プライド低い
ELSEIF TALENT:プライド低い
	TIMES LOCAL , 1.30
ENDIF
;自制心
SIF TALENT:自制心
	LOCAL /= 3
;目立ちたがり
SIF TALENT:目立ちたがり
	TIMES LOCAL , 1.30
;抑圧
SIF TALENT:抑圧
	TIMES LOCAL , 0.40
;抵抗
SIF TALENT:抵抗
	TIMES LOCAL , 0.40
;恥じらい
IF TALENT:恥じらい
	TIMES LOCAL , 0.50
;恥薄い
ELSEIF TALENT:恥薄い
	TIMES LOCAL , 1.50
ENDIF
;快感に素直
IF TALENT:快感に素直
	TIMES LOCAL , 1.30
;快感の否定
ELSEIF TALENT:快感の否定
	TIMES LOCAL , 0.60
ENDIF
;幼児or幼稚or幼児退行
SIF TALENT:幼児 || TALENT:幼稚 || TALENT:幼児退行
	TIMES LOCAL , 1.50
;パニック中
SIF TFLAG:108
	TIMES LOCAL , 1.50
;失神中
SIF TFLAG:899 >= 1
	TIMES LOCAL , 1.10

TIMES LOCAL , 0.50

;利尿剤
SIF TEQUIP:利尿剤
	LOCAL += 800 + 50 * RAND:5

;触手インプラント
SIF CFLAG:41 & 64
	TIMES LOCAL , 1.50

BASE:尿意 += LOCAL

LOCAL:1 = BASE:尿意
EJAC = MAXBASE:4

IF LOCAL:1 > EJAC * 2
	LOCAL:2 = 2
ELSEIF LOCAL:1 > EJAC
	LOCAL:2 = 1
ELSE
	LOCAL:2 = 0
	TFLAG:958 = 0
ENDIF

;Ｃ系拡張コマンド有効の場合、Ｃ刺激がないと放尿できない
IF LOCAL:2 >= 1 && FLAG:15 & 1 && UP:0 == 0 && NOWEX:20 == 0
	SOURCE:欲情追加 += ((BASE:尿意 * 30) / MAXBASE:4)
	SOURCE:痛み += ((BASE:尿意 * 15) / MAXBASE:4)
	TIMES SOURCE:欲情追加 , 1.10
	TIMES SOURCE:痛み , 1.10
	SETCOLOR COLOR("P-RED")
	PRINTL ＜放尿渇望中＞
	RESETCOLOR
	BASE:尿意 = EJAC-1
	TFLAG:958 = 0
	;放尿渇望中におけるイベント口上呼び出し
	CALL DISPLAY_KOJO_MESSAGE_SUB_EVENT, TARGET, 22
;大量放尿寸止め
ELSEIF LOCAL:2 == 2 && TEQUIP:焦らしプレイ
	SOURCE:欲情追加 += 800
	SOURCE:屈従 += 1000
	SETCOLOR 0xC0C070
	PRINTFORML %CALLNAME:TARGET%大量放尿寸止め
	RESETCOLOR
	BASE:尿意 = EJAC-1
	TSTR:92 = 大量放尿寸止め
	TFLAG:958 |= 5
	NOWEX:32 += 2
	EX:32 += 2
;通常の放尿寸止め
ELSEIF LOCAL:2 == 1 && TEQUIP:焦らしプレイ
	SOURCE:欲情追加 += 300
	SOURCE:屈従 += 500
	SETCOLOR 0xC0C070
	PRINTFORML %CALLNAME:TARGET%放尿寸止め
	RESETCOLOR
	BASE:尿意 = EJAC-1
	TSTR:92 = 放尿寸止め
	TFLAG:958 |= 5
	NOWEX:32 += 1
	EX:32 += 1
;強空放尿(オトコのみ)
ELSEIF LOCAL:2 == 2 && TALENT:オトコ && (TEQUIP:射精止め || SELECTCOM == 128)
	SOURCE:欲情追加 += ((BASE:尿意 * 60) / MAXBASE:4)
	SOURCE:痛み += ((BASE:尿意 * 30) / MAXBASE:4)
	TIMES SOURCE:欲情追加 , 1.20
	TIMES SOURCE:痛み , 1.20
	SETCOLOR 0xC0C070
	PRINTFORML %CALLNAME:TARGET%強空放尿
	RESETCOLOR
	BASE:尿意 -= EJAC*2
	TSTR:92 = 強空放尿
	TFLAG:958 |= 5
	NOWEX:43 += 2
	EX:43 += 2
;空放尿(オトコのみ)
ELSEIF LOCAL:2 == 1 && TALENT:オトコ && (TEQUIP:射精止め || SELECTCOM == 128)
	SOURCE:欲情追加 += ((BASE:尿意 * 30) / MAXBASE:4)
	SOURCE:痛み += ((BASE:尿意 * 15) / MAXBASE:4)
	TIMES SOURCE:欲情追加 , 1.10
	TIMES SOURCE:痛み , 1.10
	SETCOLOR 0xC0C070
	PRINTFORML %CALLNAME:TARGET%空放尿
	RESETCOLOR
	BASE:尿意 -= EJAC
	TSTR:92 = 空放尿
	TFLAG:958 |= 5
	NOWEX:43 += 1
	EX:43 += 1
;大量放尿
ELSEIF LOCAL:2 == 2
	DOWNBASE:0 += 10
	DOWNBASE:1 += 120
	DOWNBASE:9 += 480

	;対象の放尿経験を見る
	SELECTCASE EXP:放尿経験
		CASE IS < EXPLV:1
			SOURCE:露出 += 20000
			SOURCE:屈従 += 10000
		CASE IS < EXPLV:2
			SOURCE:露出 += 10000
			SOURCE:屈従 += 8000
		CASE IS < EXPLV:3
			SOURCE:露出 += 7000
			SOURCE:屈従 += 6000
		CASE IS < EXPLV:4
			SOURCE:露出 += 5000
			SOURCE:屈従 += 4000
		CASE IS < EXPLV:5
			SOURCE:露出 += 3000
			SOURCE:屈従 += 2000
		CASEELSE
			SOURCE:露出 += 1800
			SOURCE:屈従 += 1200
	ENDSELECT

	SETCOLOR 0xC0C070
	PRINTFORML %CALLNAME:TARGET%大量放尿
	RESETCOLOR
	IF EXP:放尿経験 == 0 && TALENT:おもらし癖 == 0
		CFLAG:放尿レベル += 1
		TCVAR:異常経験 += 1
	ELSEIF TALENT:おもらし癖 == 0
		CFLAG:放尿レベル += 2
	ENDIF
	TCVAR:放尿経験 += 2

	BASE:尿意 -= EJAC*2
	TSTR:92 = 大量放尿
	TFLAG:958 |= 5

	;利尿薬を解除
	SIF TEQUIP:利尿剤
		TEQUIP:利尿剤 = 0

	;調教対象が放尿フラグ
	TFLAG:32 = 2
	NOWEX:12 += 2
	EX:12 += 2
	;採尿器で尿が集められているかチェック
	SIF TEQUIP:Ｕ系装着器具 == 2
		TFLAG:127 += 2

	;挿しっぱなしでおしっこされちゃった場合
	SIF TFLAG:102
		CALL URINATION_IN_PLAYER
;通常の放尿
ELSEIF LOCAL:2 == 1
	DOWNBASE:1 += 50
	DOWNBASE:9 += 200

	;対象の放尿経験を見る
	SELECTCASE EXP:放尿経験
		CASE IS < EXPLV:1
			SOURCE:露出 += 10000
			SOURCE:屈従 += 5000
		CASE IS < EXPLV:2
			SOURCE:露出 += 5000
			SOURCE:屈従 += 4000
		CASE IS < EXPLV:3
			SOURCE:露出 += 2500
			SOURCE:屈従 += 2000
		CASE IS < EXPLV:4
			SOURCE:露出 += 1600
			SOURCE:屈従 += 1400
		CASE IS < EXPLV:5
			SOURCE:露出 += 800
			SOURCE:屈従 += 500
		CASEELSE
			SOURCE:露出 += 200
			SOURCE:屈従 += 250
	ENDSELECT

	SETCOLOR 0xC0C070
	PRINTFORML %CALLNAME:TARGET%放尿
	RESETCOLOR
	IF EXP:放尿経験 == 0 && TALENT:おもらし癖 == 0
		CFLAG:放尿レベル += 1
		TCVAR:異常経験 += 1
	ELSEIF TALENT:おもらし癖 == 0
		CFLAG:放尿レベル += 1
	ENDIF
	TCVAR:放尿経験 += 1

	BASE:尿意 -= EJAC
	TSTR:92 = 放尿
	TFLAG:958 |= 5

	;調教対象が放尿フラグ
	TFLAG:32 = 1
	NOWEX:12 += 1
	EX:12 += 1
	;採尿器で尿が集められているかチェック
	SIF TEQUIP:Ｕ系装着器具 == 2
		TFLAG:127 += 1

	;挿しっぱなしでおしっこされちゃった場合
	SIF TFLAG:102
		CALL URINATION_IN_PLAYER
ELSEIF BASE:尿意 >= EJAC / 2 && (SOURCE:痛み >= 1000 || SOURCE:痒み >= 1000 || SOURCE:トラウマ >= 1000 || NOWEX:0 || NOWEX:1 || NOWEX:2 || NOWEX:3) && RAND:10 == 0
	DOWNBASE:1 += 25
	DOWNBASE:9 += 100

	;対象の放尿経験を見る
	SELECTCASE EXP:放尿経験
		CASE IS < EXPLV:1
			SOURCE:露出 += 5000
			SOURCE:屈従 += 2500
		CASE IS < EXPLV:2
			SOURCE:露出 += 2500
			SOURCE:屈従 += 2000
		CASE IS < EXPLV:3
			SOURCE:露出 += 1250
			SOURCE:屈従 += 1000
		CASE IS < EXPLV:4
			SOURCE:露出 += 800
			SOURCE:屈従 += 700
		CASE IS < EXPLV:5
			SOURCE:露出 += 400
			SOURCE:屈従 += 250
		CASEELSE
			SOURCE:露出 += 140
			SOURCE:屈従 += 175
	ENDSELECT

	SETCOLOR 0xC0C070
	PRINTFORML %CALLNAME:TARGET%失禁
	RESETCOLOR
	TCVAR:放尿経験 += 1

	BASE:尿意 -= EJAC / 2
	TSTR:92 = 失禁
	TFLAG:958 |= 5

	;調教対象が放尿フラグ
	TFLAG:32 = 1
	NOWEX:12 += 1
	EX:12 += 1
	;採尿器で尿が集められているかチェック
	SIF TEQUIP:Ｕ系装着器具 == 2
		TFLAG:127 += 1

	;挿しっぱなしでおしっこされちゃった場合
	SIF TFLAG:102
		CALL URINATION_IN_PLAYER
ENDIF
BASE:尿意 = MIN(BASE:尿意, EJAC - 1)
BASE:尿意 = MAX(BASE:尿意, 0)

;-------------------------------------------------
;調教対象に挿しっぱなしでおしっこされた調教者チェック
;-------------------------------------------------
@URINATION_IN_PLAYER
;奴隷が挿入している場合のみを見る
SIF GROUPMATCH(SELECTCOM, 25, 35, 307, 308, 323, 324, 325, 332, 333, 334, 338, 651, 655, 656) == 0
	RETURN 0
;現状、主人がそうされた場合はTO DO
SIF ASSIPLAY == 0
	RETURN 0

;基礎値は対象の能力に依存する
LOCAL = ABL:欲望 + ABL:奉仕精神 + ABL:露出癖 + ABL:精液中毒
LOCAL:1 = 2 + RAND:LOCAL
LOCAL:2 = 1 + RAND:LOCAL
LOCAL:3 = 100 * (LOCAL:1 + LOCAL:2)
LOCAL:4 = LOCAL:3
LOCAL:5 = 400 * (LOCAL:1 + LOCAL:2)

;調教者が保守的
SIF TALENT:PLAYER:保守的
	TIMES LOCAL:5 , 3.00

;ABL:調教者の従順をみる
SELECTCASE ABL:PLAYER:従順
	CASE 0
		TIMES LOCAL:3 , 1.60
		TIMES LOCAL:4 , 1.40
		TIMES LOCAL:5 , 1.00
	CASE 1
		TIMES LOCAL:3 , 1.30
		TIMES LOCAL:4 , 1.20
		TIMES LOCAL:5 , 0.80
	CASE 2
		TIMES LOCAL:3 , 1.10
		TIMES LOCAL:4 , 1.00
		TIMES LOCAL:5 , 0.70
	CASE 3
		TIMES LOCAL:3 , 1.00
		TIMES LOCAL:4 , 0.80
		TIMES LOCAL:5 , 0.40
	CASE 4
		TIMES LOCAL:3 , 0.80
		TIMES LOCAL:4 , 0.50
		TIMES LOCAL:5 , 0.20
	CASEELSE
		TIMES LOCAL:3 , 0.50
		TIMES LOCAL:4 , 0.10
		TIMES LOCAL:5 , 0.00
ENDSELECT
;ABL:調教者の欲望をみる
SELECTCASE ABL:PLAYER:欲望
	CASE 0
		TIMES LOCAL:5 , 0.90
	CASE 1
		TIMES LOCAL:5 , 0.70
	CASE 2
		TIMES LOCAL:5 , 0.50
	CASE 3
		TIMES LOCAL:5 , 0.30
	CASE 4
		TIMES LOCAL:5 , 0.10
	CASEELSE
		TIMES LOCAL:5 , 0.00
ENDSELECT
;ABL:調教者の排泄中毒をみる
SELECTCASE ABL:PLAYER:排泄中毒
	CASE 0
		TIMES LOCAL:3 , 0.60
		TIMES LOCAL:4 , 1.00
	CASE 1
		TIMES LOCAL:3 , 0.40
		TIMES LOCAL:4 , 0.80
	CASE 2
		TIMES LOCAL:3 , 0.25
		TIMES LOCAL:4 , 0.60
	CASE 3
		TIMES LOCAL:3 , 0.10
		TIMES LOCAL:4 , 0.30
	CASE 4
		TIMES LOCAL:3 , 0.00
		TIMES LOCAL:4 , 0.10
	CASEELSE
		TIMES LOCAL:3 , 0.00
		TIMES LOCAL:4 , 0.00
ENDSELECT

;調教者がマゾ
SIF TALENT:PLAYER:マゾ
	TIMES LOCAL:5 , 0.50

;助手の反感と不快のパラに追加
PALAM:PLAYER:反感 += LOCAL:3 + LOCAL:5
PALAM:PLAYER:不快 += LOCAL:4

LOCAL:10 = TARGET
TARGET = PLAYER
;ここから否定の珠に変換する(助手のパラから珠変換処理は調教終了時には存在しないため)
LOCAL:20 = CALC_JUEL(20)
LOCAL:21 = CALC_JUEL(21)
LOCAL:100 = LOCAL:20 + LOCAL:21
IF JUEL:否定 >= 9999999
	LOCAL:100 = 0
ELSEIF JUEL:否定 + LOCAL:100 >= 9999999
	LOCAL:100 = MAX(9999999 - JUEL:否定, 0)
ENDIF
TARGET = LOCAL:10
;否定の珠を取得しなければここで処理終了
SIF LOCAL:100 < 1
	RETURN 0
;放尿された助手のイベント口上呼び出し(TFLAG:99にTARGETを入れている、%CALLNAME:(TFLAG:99)%で名前も表示可能)
SIF PLAYER == ASSI
	CALL DISPLAY_KOJO_MESSAGE_SUB_EVENT, ASSI, 37, TARGET
;放尿した対象のイベント口上呼び出し(TFLAG:99が1なら主人調教だが…)
IF TARGET > 0
	TFLAG:99 = (PLAYER == ASSI) ? 0 # 1
	CALL DISPLAY_KOJO_MESSAGE_SUB_EVENT, TARGET, 38, TFLAG:99
ENDIF
PRINTFORML 否定の珠(%CALLNAME:PLAYER%)＋{LOCAL:100}
JUEL:PLAYER:否定 += LOCAL:100

;-------------------------------------------------
;調教対象の精飲絶頂チェック
;-------------------------------------------------
;精飲絶頂の仕様を大きく変更。噴乳などの形式に近い形にしました
;強制精飲絶頂の経験回数、精飲絶頂ゲージをCFLAG:精飲開発度に格納
@TARGET_SEIIN_CHECK
;精液中毒を見る
SELECTCASE ABL:精液中毒
	CASE 0
		LOCAL = 0
	CASE 1
		LOCAL = 10
	CASE 2
		LOCAL = 50
	CASE 3
		LOCAL = 100
	CASE 4
		LOCAL = 150
	CASEELSE
		LOCAL = 200
ENDSELECT

;気丈
SIF TALENT:気丈
	TIMES LOCAL , 0.60
;保守的
SIF TALENT:保守的
	TIMES LOCAL , 0.60
;楽観的
IF TALENT:楽観的
	TIMES LOCAL , 1.20
;悲観的
ELSEIF TALENT:悲観的
	TIMES LOCAL , 0.80
ENDIF
;一線越えない
SIF TALENT:一線越えない
	TIMES LOCAL , 0.20
;抑圧
IF TALENT:抑圧
	TIMES LOCAL , 0.60
;解放
ELSEIF TALENT:解放
	TIMES LOCAL , 1.50
ENDIF
;汚臭鈍感
IF TALENT:汚臭鈍感
	TIMES LOCAL , 1.25
;汚臭敏感
ELSEIF TALENT:汚臭敏感
	TIMES LOCAL , 0.75
ENDIF
;快感に素直
IF TALENT:快感に素直
	TIMES LOCAL , 2.00
;快感の否定
ELSEIF TALENT:快感の否定
	TIMES LOCAL , 0.50
ENDIF
;倒錯的
SIF TALENT:倒錯的
	TIMES LOCAL , 1.80
;中毒しやすい
SIF TALENT:中毒しやすい
	TIMES LOCAL , 2.00
;淫乱
SIF TALENT:淫乱
	TIMES LOCAL , 1.80
;精愛味覚
SIF TALENT:精愛味覚
	TIMES LOCAL , 2.50

IF LOCAL <= 0
	RETURN 0
ELSE
	CFLAG:精飲開発度 += LOCAL
ENDIF
EJAC = 1000
IF CFLAG:精飲開発度 > EJAC * 2
	LOCAL:1 = 2
ELSEIF CFLAG:精飲開発度 > EJAC
	LOCAL:1 = 1
ELSE
	LOCAL:1 = 0
ENDIF

;対象が[精愛味覚]を持たない場合
IF TALENT:精愛味覚 == 0
    SETCOLOR COLOR("YELLOW")
	PRINTL 強制精飲絶頂
	RESETCOLOR
	DOWNBASE:0 += 10
	DOWNBASE:1 += 20
	DOWNBASE:9 += 80

	;精液中毒を見る
	SELECTCASE ABL:精液中毒
		CASE IS < 2
			SOURCE:屈従 += 1000
			SOURCE:トラウマ += 1000
		CASE IS < 4
			SOURCE:欲情追加 += 500
			SOURCE:屈従 += 1000
			SOURCE:トラウマ += 500
		CASEELSE
			SOURCE:欲情追加 += 1000
			SOURCE:屈従 += 1000
	ENDSELECT
ELSEIF LOCAL:1
	CALL SEIIN_ORGASM, LOCAL:1
ENDIF

;----------------------------------------------------------------
;精飲絶頂の処理
;----------------------------------------------------------------
@SEIIN_ORGASM, ARG
;精飲絶頂経験の回数追加
IF ARG == 2
	SETCOLOR COLOR("YELLOW")
	PRINTFORML %CALLNAME:TARGET%精飲強絶頂
	DOWNBASE:1 += 10
	DOWNBASE:9 += 40
	LOCAL = 2000
	LOCAL:1 = 2000
	LOCAL:2 = 5000
	LOCAL:3 = 8000
ELSE
	SETCOLOR COLOR("YELLOW")
	PRINTFORML %CALLNAME:TARGET%精飲絶頂
	DOWNBASE:1 += 5
	DOWNBASE:9 += 20
	LOCAL = 800
	LOCAL:1 = 1000
	LOCAL:2 = 2500
	LOCAL:3 = 5000
ENDIF
RESETCOLOR
NOWEX:13 += ARG
EX:13 += ARG
TCVAR:精飲絶頂経験 += ARG
TFLAG:33 = ARG
;初体験
IF EXP:精飲絶頂経験 <= 1
	TIMES LOCAL , 2.00
	TIMES LOCAL:3 , 3.00
ENDIF
;精液中毒
SELECTCASE ABL:精液中毒
	CASE 0
		TIMES LOCAL:1 , 0.40
		TIMES LOCAL:2 , 0.40
		TIMES LOCAL:3 , 2.00
	CASE 1
		TIMES LOCAL:1 , 0.60
		TIMES LOCAL:2 , 0.60
		TIMES LOCAL:3 , 1.50
	CASE 2
		TIMES LOCAL:1 , 0.80
		TIMES LOCAL:2 , 0.80
	CASE 3
		TIMES LOCAL:3 , 0.75
	CASE 4
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 1.50
		TIMES LOCAL:3 , 0.50
	CASEELSE
		TIMES LOCAL:1 , 2.00
		TIMES LOCAL:2 , 2.00
		TIMES LOCAL:3 , 0.00
ENDSELECT

SOURCE:露出 += LOCAL
SOURCE:欲情追加 += LOCAL:1
SOURCE:液体追加 += LOCAL:2
SOURCE:屈従 += LOCAL:3

CFLAG:精飲開発度 -= (EJAC * ARG - 100)
CFLAG:精飲開発度 = MIN(CFLAG:精飲開発度, EJAC - 1)

;=============================================================================
;ソース補正処理
;=============================================================================
;-------------------------------------------------
;同性の場合のチェック
;-------------------------------------------------
@SOURCE_SEX_CHECK
SIF TALENT:オトコ == 0 && TALENT:PLAYER:オトコ
	RETURN 0
SIF TALENT:オトコ && TALENT:PLAYER:オトコ == 0
	RETURN 0

;レズ
IF TALENT:オトコ == 0 && TALENT:PLAYER:オトコ == 0
	;ABL:レズっ気をみる
	SELECTCASE ABL:レズっ気
		CASE 0
			TIMES SOURCE:屈従 , 0.90

			TIMES SOURCE:不潔 , 0.80
			TIMES SOURCE:逸脱 , 0.80
		CASE 1
			SOURCE:中毒充足 += 100
			TIMES SOURCE:快Ｃ , 1.10
			TIMES SOURCE:快Ｖ , 1.10
			TIMES SOURCE:快Ａ , 1.10
			TIMES SOURCE:快Ｂ , 1.10
			TIMES SOURCE:達成感 , 1.10
			TIMES SOURCE:屈従 , 0.75

			TIMES SOURCE:不潔 , 0.60
			TIMES SOURCE:逸脱 , 0.60
		CASE 2
			SOURCE:中毒充足 += 200
			TIMES SOURCE:快Ｃ , 1.20
			TIMES SOURCE:快Ｖ , 1.20
			TIMES SOURCE:快Ａ , 1.20
			TIMES SOURCE:快Ｂ , 1.20
			TIMES SOURCE:達成感 , 1.20
			TIMES SOURCE:屈従 , 0.60

			TIMES SOURCE:不潔 , 0.40
			TIMES SOURCE:逸脱 , 0.40
		CASE 3
			SOURCE:中毒充足 += 350
			TIMES SOURCE:快Ｃ , 1.30
			TIMES SOURCE:快Ｖ , 1.30
			TIMES SOURCE:快Ａ , 1.30
			TIMES SOURCE:快Ｂ , 1.30
			TIMES SOURCE:達成感 , 1.30
			TIMES SOURCE:屈従 , 0.45

			TIMES SOURCE:不潔 , 0.25
			TIMES SOURCE:逸脱 , 0.25
		CASE 4
			SOURCE:中毒充足 += 500
			TIMES SOURCE:快Ｃ , 1.40
			TIMES SOURCE:快Ｖ , 1.40
			TIMES SOURCE:快Ａ , 1.40
			TIMES SOURCE:快Ｂ , 1.40
			TIMES SOURCE:達成感 , 1.40
			TIMES SOURCE:屈従 , 0.30

			TIMES SOURCE:不潔 , 0.15
			TIMES SOURCE:逸脱 , 0.15
		CASEELSE
			SOURCE:中毒充足 += 750
			TIMES SOURCE:快Ｃ , 1.60
			TIMES SOURCE:快Ｖ , 1.60
			TIMES SOURCE:快Ａ , 1.60
			TIMES SOURCE:快Ｂ , 1.60
			TIMES SOURCE:達成感 , 1.60
			TIMES SOURCE:屈従 , 0.15

			TIMES SOURCE:不潔 , 0.10
			TIMES SOURCE:逸脱 , 0.10
	ENDSELECT
	;ABL:レズ中毒をみる
	SELECTCASE ABL:レズ中毒
		CASE 1
			TIMES SOURCE:快Ｃ , 1.20
			TIMES SOURCE:快Ｖ , 1.20
			TIMES SOURCE:快Ａ , 1.20
			TIMES SOURCE:快Ｂ , 1.20
			TIMES SOURCE:達成感 , 1.20

			TIMES SOURCE:不潔 , 0.60
			TIMES SOURCE:逸脱 , 0.60
		CASE 2
			TIMES SOURCE:快Ｃ , 1.40
			TIMES SOURCE:快Ｖ , 1.40
			TIMES SOURCE:快Ａ , 1.40
			TIMES SOURCE:快Ｂ , 1.40
			TIMES SOURCE:達成感 , 1.40

			TIMES SOURCE:不潔 , 0.40
			TIMES SOURCE:逸脱 , 0.40
		CASE 3
			TIMES SOURCE:快Ｃ , 1.60
			TIMES SOURCE:快Ｖ , 1.60
			TIMES SOURCE:快Ａ , 1.60
			TIMES SOURCE:快Ｂ , 1.60
			TIMES SOURCE:達成感 , 1.60

			TIMES SOURCE:不潔 , 0.30
			TIMES SOURCE:逸脱 , 0.30
		CASE 4
			TIMES SOURCE:快Ｃ , 1.80
			TIMES SOURCE:快Ｖ , 1.80
			TIMES SOURCE:快Ａ , 1.80
			TIMES SOURCE:快Ｂ , 1.80
			TIMES SOURCE:達成感 , 1.80

			TIMES SOURCE:不潔 , 0.20
			TIMES SOURCE:逸脱 , 0.20
		CASE 5
			TIMES SOURCE:快Ｃ , 2.00
			TIMES SOURCE:快Ｖ , 2.00
			TIMES SOURCE:快Ａ , 2.00
			TIMES SOURCE:快Ｂ , 2.00
			TIMES SOURCE:達成感 , 2.00

			TIMES SOURCE:不潔 , 0.10
			TIMES SOURCE:逸脱 , 0.10
	ENDSELECT

	;調教者のABL:レズっ気
	SELECTCASE ABL:PLAYER:レズっ気
		CASE 0
			TIMES SOURCE:快Ｃ , 0.40
			TIMES SOURCE:快Ｖ , 0.40
			TIMES SOURCE:快Ａ , 0.40
			TIMES SOURCE:快Ｂ , 0.40
			TIMES SOURCE:情愛 , 0.20
			TIMES SOURCE:性行動 , 0.30
			TIMES SOURCE:達成感 , 0.30
		CASE 1
			TIMES SOURCE:快Ｃ , 0.70
			TIMES SOURCE:快Ｖ , 0.70
			TIMES SOURCE:快Ａ , 0.70
			TIMES SOURCE:快Ｂ , 0.70
			TIMES SOURCE:情愛 , 0.60
			TIMES SOURCE:性行動 , 0.70
			TIMES SOURCE:達成感 , 0.70
		CASE 2
			TIMES SOURCE:快Ｃ , 1.00
			TIMES SOURCE:快Ｖ , 1.00
			TIMES SOURCE:快Ａ , 1.00
			TIMES SOURCE:快Ｂ , 1.00
			TIMES SOURCE:情愛 , 1.00
			TIMES SOURCE:性行動 , 1.00
			TIMES SOURCE:達成感 , 1.00
		CASE 3
			TIMES SOURCE:快Ｃ , 1.10
			TIMES SOURCE:快Ｖ , 1.10
			TIMES SOURCE:快Ａ , 1.10
			TIMES SOURCE:快Ｂ , 1.10
			TIMES SOURCE:情愛 , 1.40
			TIMES SOURCE:性行動 , 1.30
			TIMES SOURCE:達成感 , 1.30
		CASE 4
			TIMES SOURCE:快Ｃ , 1.20
			TIMES SOURCE:快Ｖ , 1.20
			TIMES SOURCE:快Ａ , 1.20
			TIMES SOURCE:快Ｂ , 1.20
			TIMES SOURCE:情愛 , 1.80
			TIMES SOURCE:性行動 , 1.60
			TIMES SOURCE:達成感 , 1.60
		CASEELSE
			TIMES SOURCE:快Ｃ , 1.30
			TIMES SOURCE:快Ｖ , 1.30
			TIMES SOURCE:快Ａ , 1.30
			TIMES SOURCE:快Ｂ , 1.30
			TIMES SOURCE:情愛 , 2.50
			TIMES SOURCE:性行動 , 2.00
			TIMES SOURCE:達成感 , 2.00
	ENDSELECT
	;調教者のABL:レズ中毒
	SELECTCASE ABL:PLAYER:レズ中毒
		CASE 1
			TIMES SOURCE:快Ｃ , 1.10
			TIMES SOURCE:快Ｖ , 1.10
			TIMES SOURCE:快Ａ , 1.10
			TIMES SOURCE:快Ｂ , 1.10
			TIMES SOURCE:情愛 , 1.50
			TIMES SOURCE:性行動 , 1.50
			TIMES SOURCE:達成感 , 1.50
		CASE 2
			TIMES SOURCE:快Ｃ , 1.20
			TIMES SOURCE:快Ｖ , 1.20
			TIMES SOURCE:快Ａ , 1.20
			TIMES SOURCE:快Ｂ , 1.20
			TIMES SOURCE:情愛 , 2.00
			TIMES SOURCE:性行動 , 2.00
			TIMES SOURCE:達成感 , 2.00
		CASE 3
			TIMES SOURCE:快Ｃ , 1.40
			TIMES SOURCE:快Ｖ , 1.40
			TIMES SOURCE:快Ａ , 1.40
			TIMES SOURCE:快Ｂ , 1.40
			TIMES SOURCE:情愛 , 2.50
			TIMES SOURCE:性行動 , 2.50
			TIMES SOURCE:達成感 , 2.50
		CASE 4
			TIMES SOURCE:快Ｃ , 1.60
			TIMES SOURCE:快Ｖ , 1.60
			TIMES SOURCE:快Ａ , 1.60
			TIMES SOURCE:快Ｂ , 1.60
			TIMES SOURCE:情愛 , 3.50
			TIMES SOURCE:性行動 , 3.00
			TIMES SOURCE:達成感 , 3.00
		CASE 5
			TIMES SOURCE:快Ｃ , 1.80
			TIMES SOURCE:快Ｖ , 1.80
			TIMES SOURCE:快Ａ , 1.80
			TIMES SOURCE:快Ｂ , 1.80
			TIMES SOURCE:情愛 , 5.00
			TIMES SOURCE:性行動 , 4.00
			TIMES SOURCE:達成感 , 4.00
	ENDSELECT

	;調教者の自制心
	IF TALENT:PLAYER:自制心
		TIMES SOURCE:性行動 , 0.50
		TIMES SOURCE:達成感 , 0.50
	ENDIF
;ＢＬ
ELSEIF TALENT:オトコ && TALENT:PLAYER:オトコ
	;ABL:ＢＬっ気をみる
	SELECTCASE ABL:ＢＬっ気
		CASE 0
			TIMES SOURCE:達成感 , 0.50

			TIMES SOURCE:不潔 , 4.00
			TIMES SOURCE:逸脱 , 4.00
		CASE 1
			SOURCE:中毒充足 += 10
			TIMES SOURCE:快Ｃ , 1.10
			TIMES SOURCE:快Ｖ , 1.10
			TIMES SOURCE:快Ａ , 1.10
			TIMES SOURCE:快Ｂ , 1.10
			TIMES SOURCE:達成感 , 0.70

			TIMES SOURCE:不潔 , 2.00
			TIMES SOURCE:逸脱 , 2.00
		CASE 2
			SOURCE:中毒充足 += 40
			TIMES SOURCE:快Ｃ , 1.20
			TIMES SOURCE:快Ｖ , 1.20
			TIMES SOURCE:快Ａ , 1.20
			TIMES SOURCE:快Ｂ , 1.20
			TIMES SOURCE:達成感 , 0.90

			TIMES SOURCE:不潔 , 1.40
			TIMES SOURCE:逸脱 , 1.40
		CASE 3
			SOURCE:中毒充足 += 100
			TIMES SOURCE:快Ｃ , 1.30
			TIMES SOURCE:快Ｖ , 1.30
			TIMES SOURCE:快Ａ , 1.30
			TIMES SOURCE:快Ｂ , 1.30
			TIMES SOURCE:達成感 , 1.10

			TIMES SOURCE:不潔 , 1.00
			TIMES SOURCE:逸脱 , 1.00
		CASE 4
			SOURCE:中毒充足 += 200
			TIMES SOURCE:快Ｃ , 1.40
			TIMES SOURCE:快Ｖ , 1.40
			TIMES SOURCE:快Ａ , 1.40
			TIMES SOURCE:快Ｂ , 1.40
			TIMES SOURCE:達成感 , 1.20

			TIMES SOURCE:不潔 , 0.70
			TIMES SOURCE:逸脱 , 0.70
		CASEELSE
			SOURCE:中毒充足 += 350
			TIMES SOURCE:快Ｃ , 1.50
			TIMES SOURCE:快Ｖ , 1.50
			TIMES SOURCE:快Ａ , 1.50
			TIMES SOURCE:快Ｂ , 1.50
			TIMES SOURCE:達成感 , 1.30

			TIMES SOURCE:不潔 , 0.50
			TIMES SOURCE:逸脱 , 0.50
	ENDSELECT

	;調教者の自制心
	IF TALENT:PLAYER:自制心
		TIMES SOURCE:性行動 , 0.50
		TIMES SOURCE:達成感 , 0.50
	ENDIF
ENDIF

;-------------------------------------------------
;快感増加パッチの処理(EASY限定)
;-------------------------------------------------
;調教者が男かつ主人、かつ対象が女のとき快感増加
;[ふたなり]やペニバンよりも色々と不遇気味な[オトコ]の特権ということで
@SOURCE_SEX_MALE_CHECK_EASY
SELECTCASE CFLAG:好感度
	CASE IS < 2000
		TIMES SOURCE:快Ｃ , 1.10
		TIMES SOURCE:快Ｖ , 1.10
		TIMES SOURCE:快Ａ , 1.10
		TIMES SOURCE:快Ｂ , 1.10
		TIMES SOURCE:達成感 , 1.10
	CASE IS < 3000
		TIMES SOURCE:快Ｃ , 1.20
		TIMES SOURCE:快Ｖ , 1.20
		TIMES SOURCE:快Ａ , 1.20
		TIMES SOURCE:快Ｂ , 1.20
		TIMES SOURCE:達成感 , 1.20
	CASE IS < 5000
		TIMES SOURCE:快Ｃ , 1.50
		TIMES SOURCE:快Ｖ , 1.50
		TIMES SOURCE:快Ａ , 1.50
		TIMES SOURCE:快Ｂ , 1.50
		TIMES SOURCE:達成感 , 1.50
	;ここから主人に対する中毒が発生（マゾっ気Lv1相当）
	CASE IS < 10000
		SOURCE:中毒充足 += 100
		TIMES SOURCE:快Ｃ , 2.00
		TIMES SOURCE:快Ｖ , 2.00
		TIMES SOURCE:快Ａ , 2.00
		TIMES SOURCE:快Ｂ , 2.00
		TIMES SOURCE:達成感 , 2.00
	CASE IS < 15000
		SOURCE:中毒充足 += 350
		TIMES SOURCE:快Ｃ , 2.50
		TIMES SOURCE:快Ｖ , 2.50
		TIMES SOURCE:快Ａ , 2.50
		TIMES SOURCE:快Ｂ , 2.50
		TIMES SOURCE:達成感 , 2.50
	;好感度15000～19999、レズっ気5の中毒充足の750にならぶとともに女主人の限界すれすれに
	CASE IS < 20000
		SOURCE:中毒充足 += 750
		TIMES SOURCE:快Ｃ , 3.00
		TIMES SOURCE:快Ｖ , 3.00
		TIMES SOURCE:快Ａ , 3.00
		TIMES SOURCE:快Ｂ , 3.00
		TIMES SOURCE:達成感 ,3.00
	;好感度20000～30000、女主人による調教の最大値が3.2倍なんでそれに勝つのはここから
	CASE IS < 30000
		SOURCE:中毒充足 += 1000
		TIMES SOURCE:快Ｃ , 3.50
		TIMES SOURCE:快Ｖ , 3.50
		TIMES SOURCE:快Ａ , 3.50
		TIMES SOURCE:快Ｂ , 3.50
		TIMES SOURCE:達成感 , 3.50
	CASE IS < 50000
		SOURCE:中毒充足 += 1250
		TIMES SOURCE:快Ｃ , 5.00
		TIMES SOURCE:快Ｖ , 5.00
		TIMES SOURCE:快Ａ , 5.00
		TIMES SOURCE:快Ｂ , 5.00
		TIMES SOURCE:達成感 , 5.00
	;好感度50000～99999、ここで助手・奴隷ともにレズ中毒･レズっ気Lv5のとき（7.488倍）に勝てます
	CASE IS < 100000
		SOURCE:中毒充足 += 1500
		TIMES SOURCE:快Ｃ , 7.50
		TIMES SOURCE:快Ｖ , 7.50
		TIMES SOURCE:快Ａ , 7.50
		TIMES SOURCE:快Ｂ , 7.50
		TIMES SOURCE:達成感 ,7.50
	;好感度10万越え、ここまで来る人はまずいないとおもうけど…
	CASEELSE
		SOURCE:中毒充足 += 1000 + (CFLAG:好感度 / 100)
		SOURCE:快Ｃ *= 10
		SOURCE:快Ｖ *= 10
		SOURCE:快Ａ *= 10
		SOURCE:快Ｂ *= 10
		SOURCE:達成感 *= 10
ENDSELECT

;-------------------------------------------------
;快感増加パッチの処理(NORMAL以上)
;-------------------------------------------------
;調教者が男かつ主人、かつ対象が女のとき快感増加
;上昇幅の計算がEASYと違う([淫壷]補正もあり)
;[ふたなり]やペニバンよりも色々と不遇気味な[オトコ]の特権ということで
@SOURCE_SEX_MALE_CHECK_NORMAL
SELECTCASE CFLAG:好感度
	CASE IS < 2000
		LOCAL = 120
	CASE IS < 2500
		LOCAL = 125
	CASE IS < 3000
		SOURCE:中毒充足 += 100
		LOCAL = 150
	CASE IS < 5000
		SOURCE:中毒充足 += 250
		LOCAL = 175
	CASE IS < 7500
		SOURCE:中毒充足 += 500
		LOCAL = 200
	CASE IS < 10000
		SOURCE:中毒充足 += 1000
		LOCAL = 250
	CASEELSE
		SOURCE:中毒充足 += 2000
		LOCAL = 350
ENDSELECT
SIF TALENT:淫壷
	TIMES LOCAL , 1.50

IF LOCAL > 0
	SOURCE:快Ｃ *= LOCAL
	SOURCE:快Ｃ /= 100
	SOURCE:快Ｖ *= LOCAL
	SOURCE:快Ｖ /= 100
	SOURCE:快Ａ *= LOCAL
	SOURCE:快Ａ /= 100
	SOURCE:快Ｂ *= LOCAL
	SOURCE:快Ｂ /= 100
	SOURCE:達成感 *= LOCAL
	SOURCE:達成感 /= 100
ENDIF

;-------------------------------------------------
;調教者の素質・能力チェック
;-------------------------------------------------
@PLAYER_SKILL_CHECK
;調教者の[解放]をみる
IF TALENT:PLAYER:解放
	TIMES SOURCE:快Ｃ , 1.20
	TIMES SOURCE:快Ｖ , 1.20
	TIMES SOURCE:快Ａ , 1.20
	TIMES SOURCE:快Ｂ , 1.20
	TIMES SOURCE:情愛 , 1.20
ENDIF
;調教者の[小悪魔]をみる
SIF TALENT:PLAYER:小悪魔
	TIMES SOURCE:露出 , 1.60
;調教者の[魅惑]をみる
IF TALENT:PLAYER:魅惑
	TIMES SOURCE:快Ｃ , 1.20
	TIMES SOURCE:快Ｖ , 1.20
	TIMES SOURCE:快Ａ , 1.20
	TIMES SOURCE:快Ｂ , 1.20
	TIMES SOURCE:達成感 , 1.20

	TIMES SOURCE:不潔 , 0.50
	TIMES SOURCE:逸脱 , 0.50
ENDIF
;調教者の[謎の魅力]、[大甲斐性]をみる
IF TALENT:PLAYER:謎の魅力 || TALENT:PLAYER:大甲斐性
	TIMES SOURCE:快Ｃ , 1.20
	TIMES SOURCE:快Ｖ , 1.20
	TIMES SOURCE:快Ａ , 1.20
	TIMES SOURCE:快Ｂ , 1.20
	TIMES SOURCE:達成感 , 1.20

	TIMES SOURCE:不潔 , 0.50
	TIMES SOURCE:逸脱 , 0.50
ENDIF
;調教者の[幼児退行]をみる
IF TALENT:PLAYER:幼児退行
	TIMES SOURCE:快Ｃ , 1.10
	TIMES SOURCE:快Ｖ , 1.10
	TIMES SOURCE:快Ａ , 1.10
	TIMES SOURCE:快Ｂ , 1.10
	TIMES SOURCE:接触 , 1.20
	TIMES SOURCE:露出 , 1.50
	TIMES SOURCE:達成感 , 1.20

	TIMES SOURCE:不潔 , 1.20
	TIMES SOURCE:逸脱 , 1.50
ENDIF

;YASAIモード
IF TALENT:PLAYER:野菜の錬金術師 && TEQUIP:YASAIモードで使用
	TIMES SOURCE:快Ｃ , 1.50
	TIMES SOURCE:快Ｖ , 1.50
	TIMES SOURCE:快Ａ , 1.50
	TIMES SOURCE:快Ｂ , 1.50
	TIMES SOURCE:達成感 , 1.50

	TIMES SOURCE:不潔 , 0.50
	TIMES SOURCE:逸脱 , 0.50
ENDIF

;調教者のABL:技巧
SELECTCASE ABL:PLAYER:技巧
	CASE 0
		TIMES SOURCE:快Ｃ , 0.60
		TIMES SOURCE:快Ｖ , 0.60
		TIMES SOURCE:快Ａ , 0.60
		TIMES SOURCE:快Ｂ , 0.60
	CASE 1
		TIMES SOURCE:快Ｃ , 0.80
		TIMES SOURCE:快Ｖ , 0.80
		TIMES SOURCE:快Ａ , 0.80
		TIMES SOURCE:快Ｂ , 0.80
	CASE 2
		TIMES SOURCE:快Ｃ , 1.00
		TIMES SOURCE:快Ｖ , 1.00
		TIMES SOURCE:快Ａ , 1.00
		TIMES SOURCE:快Ｂ , 1.00
	CASE 3
		TIMES SOURCE:快Ｃ , 1.30
		TIMES SOURCE:快Ｖ , 1.30
		TIMES SOURCE:快Ａ , 1.30
		TIMES SOURCE:快Ｂ , 1.30
	CASE 4
		TIMES SOURCE:快Ｃ , 1.60
		TIMES SOURCE:快Ｖ , 1.60
		TIMES SOURCE:快Ａ , 1.60
		TIMES SOURCE:快Ｂ , 1.60
	CASEELSE
		TIMES SOURCE:快Ｃ , 2.00
		TIMES SOURCE:快Ｖ , 2.00
		TIMES SOURCE:快Ａ , 2.00
		TIMES SOURCE:快Ｂ , 2.00
ENDSELECT

;調教者が助手かつ[恋慕]で[嫉妬]であるとき
IF ASSIPLAY && TALENT:PLAYER:恋慕 && TALENT:PLAYER:嫉妬
	;助手のABL:サドっ気をみる
	SELECTCASE ABL:ASSI:サドっ気
		CASE 0
			TIMES SOURCE:痛み , 1.00
			TIMES SOURCE:痒み , 1.00
			TIMES SOURCE:支配 , 1.00
			TIMES SOURCE:逸脱 , 1.00
		CASE 1
			TIMES SOURCE:痛み , 1.10
			TIMES SOURCE:痒み , 1.00
			TIMES SOURCE:支配 , 1.00
			TIMES SOURCE:逸脱 , 1.05
		CASE 2
			TIMES SOURCE:痛み , 1.15
			TIMES SOURCE:痒み , 1.05
			TIMES SOURCE:支配 , 1.05
			TIMES SOURCE:逸脱 , 1.10
		CASE 3
			TIMES SOURCE:痛み , 1.20
			TIMES SOURCE:痒み , 1.05
			TIMES SOURCE:支配 , 1.10
			TIMES SOURCE:逸脱 , 1.15
		CASE 4
			TIMES SOURCE:痛み , 1.25
			TIMES SOURCE:痒み , 1.10
			TIMES SOURCE:支配 , 1.15
			TIMES SOURCE:逸脱 , 1.20
		CASEELSE
			TIMES SOURCE:痛み , 1.35
			TIMES SOURCE:痒み , 1.15
			TIMES SOURCE:支配 , 1.20
			TIMES SOURCE:逸脱 , 1.30
	ENDSELECT
ENDIF

;調教者が助手かつ[使い魔]であるとき
IF ASSIPLAY && TALENT:PLAYER:使い魔
	;主人のABL:技巧をみる
	SELECTCASE ABL:MASTER:技巧
		CASE 0
			TIMES SOURCE:快Ｃ , 0.80
			TIMES SOURCE:快Ｖ , 0.80
			TIMES SOURCE:快Ａ , 0.80
			TIMES SOURCE:快Ｂ , 0.80
		CASE 1
			TIMES SOURCE:快Ｃ , 0.90
			TIMES SOURCE:快Ｖ , 0.90
			TIMES SOURCE:快Ａ , 0.90
			TIMES SOURCE:快Ｂ , 0.90
		CASE 2
			TIMES SOURCE:快Ｃ , 1.00
			TIMES SOURCE:快Ｖ , 1.00
			TIMES SOURCE:快Ａ , 1.00
			TIMES SOURCE:快Ｂ , 1.00
		CASE 3
			TIMES SOURCE:快Ｃ , 1.10
			TIMES SOURCE:快Ｖ , 1.10
			TIMES SOURCE:快Ａ , 1.10
			TIMES SOURCE:快Ｂ , 1.10
		CASE 4
			TIMES SOURCE:快Ｃ , 1.15
			TIMES SOURCE:快Ｖ , 1.15
			TIMES SOURCE:快Ａ , 1.15
			TIMES SOURCE:快Ｂ , 1.15
		CASEELSE
			TIMES SOURCE:快Ｃ , 1.20
			TIMES SOURCE:快Ｖ , 1.20
			TIMES SOURCE:快Ａ , 1.20
			TIMES SOURCE:快Ｂ , 1.20
	ENDSELECT
	;主人の[魅惑]をみる
	IF TALENT:MASTER:魅惑
		TIMES SOURCE:不潔 , 0.90
		TIMES SOURCE:逸脱 , 0.90
	ENDIF
	;主人の[謎の魅力]をみる
	IF TALENT:MASTER:謎の魅力
		TIMES SOURCE:不潔 , 0.90
		TIMES SOURCE:逸脱 , 0.90
	ENDIF
	;主人の[小悪魔]をみる
	SIF TALENT:MASTER:小悪魔
		TIMES SOURCE:露出 , 1.15
	;主人のカリスマ(堕とした人数)を見る
	SELECTCASE FLAG:30
		CASE 0
		CASE IS < 5
			TIMES SOURCE:達成感 , 1.10
			TIMES SOURCE:支配 , 1.10
		CASE IS < 10
			TIMES SOURCE:達成感 , 1.20
			TIMES SOURCE:支配 , 1.20
		CASE IS < 100
			TIMES SOURCE:達成感 , 1.30
			TIMES SOURCE:支配 , 1.30
		CASE IS < 1000
			TIMES SOURCE:達成感 , 1.40
			TIMES SOURCE:支配 , 1.40
		CASEELSE
			TIMES SOURCE:達成感 , 1.50
			TIMES SOURCE:支配 , 1.50
	ENDSELECT
ENDIF

;調教者が[死神]で[仙人]を調教している、もしくは調教者が[仙人]で[死神]を調教しているとき
IF (TALENT:PLAYER:死神 && TALENT:仙人) || (TALENT:PLAYER:仙人 && TALENT:死神)
	TIMES SOURCE:快Ｃ , 0.70
	TIMES SOURCE:快Ｖ , 0.70
	TIMES SOURCE:快Ａ , 0.70
	TIMES SOURCE:快Ｂ , 0.70
	TIMES SOURCE:情愛 , 0.90
	TIMES SOURCE:達成感 , 0.90
	TIMES SOURCE:恭順追加 , 0.90
	TIMES SOURCE:屈従 , 0.90
	TIMES SOURCE:性技学習 , 0.90
	TIMES SOURCE:欲情追加 , 0.80
	TIMES SOURCE:液体追加 , 0.80
	TIMES SOURCE:痛み , 0.80
	TIMES SOURCE:支配 , 0.80
	TIMES SOURCE:逸脱 , 1.20
	TIMES SOURCE:反感追加 , 1.20
ENDIF

;調教者が[妖精知識]を持ち、かつ[妖精]を調教しているとき
IF TALENT:PLAYER:妖精知識 && TALENT:妖精
	LOCAL:1 = 0
	FOR LOCAL, 0, CHARANUM
		;失踪中、調教者、調教対象なら除外
		SIF CFLAG:LOCAL:4 || LOCAL == PLAYER || LOCAL == TARGET
			CONTINUE
		;熾烈なる妖精（とも）との戦いの中で精と子の狭間を見切った
		SIF (TALENT:LOCAL:恋慕 || TALENT:LOCAL:服従 || TALENT:LOCAL:淫乱) && TALENT:LOCAL:妖精
			LOCAL:1 += 1
	NEXT
	IF FLAG:32 > 999 && LOCAL:1 > 999
		TIMES SOURCE:快Ｃ , 3.00
		TIMES SOURCE:快Ｖ , 3.00
		TIMES SOURCE:快Ａ , 3.00
		TIMES SOURCE:快Ｂ , 3.00
		IF TEQUIP:触手調教 == 0
			TIMES SOURCE:情愛 , 2.00
			TIMES SOURCE:達成感 , 2.00
			TIMES SOURCE:恭順追加 , 2.00
			TIMES SOURCE:屈従 , 2.00
			TIMES SOURCE:性技学習 , 2.00
			TIMES SOURCE:欲情追加 , 2.50
			TIMES SOURCE:液体追加 , 2.50
			TIMES SOURCE:痛み , 2.50
			TIMES SOURCE:支配 , 2.50
		ENDIF
	ELSEIF FLAG:32 > 999 && LOCAL:1 > 499
		TIMES SOURCE:快Ｃ , 2.70
		TIMES SOURCE:快Ｖ , 2.70
		TIMES SOURCE:快Ａ , 2.70
		TIMES SOURCE:快Ｂ , 2.70
		IF TEQUIP:触手調教 == 0
			TIMES SOURCE:情愛 , 1.50
			TIMES SOURCE:達成感 , 1.50
			TIMES SOURCE:恭順追加 , 1.50
			TIMES SOURCE:屈従 , 1.50
			TIMES SOURCE:性技学習 , 1.50
			TIMES SOURCE:欲情追加 , 2.20
			TIMES SOURCE:液体追加 , 2.20
			TIMES SOURCE:痛み , 2.20
			TIMES SOURCE:支配 , 2.20
		ENDIF
	ELSEIF FLAG:32 > 999 && LOCAL:1 > 99
		TIMES SOURCE:快Ｃ , 2.40
		TIMES SOURCE:快Ｖ , 2.40
		TIMES SOURCE:快Ａ , 2.40
		TIMES SOURCE:快Ｂ , 2.40
		IF TEQUIP:触手調教 == 0
			TIMES SOURCE:情愛 , 1.30
			TIMES SOURCE:達成感 , 1.30
			TIMES SOURCE:恭順追加 , 1.30
			TIMES SOURCE:屈従 , 1.30
			TIMES SOURCE:性技学習 , 1.30
			TIMES SOURCE:欲情追加 , 2.00
			TIMES SOURCE:液体追加 , 2.00
			TIMES SOURCE:痛み , 2.00
			TIMES SOURCE:支配 , 2.00
		ENDIF
	ELSEIF FLAG:32 > 999
		TIMES SOURCE:快Ｃ , 2.10
		TIMES SOURCE:快Ｖ , 2.10
		TIMES SOURCE:快Ａ , 2.10
		TIMES SOURCE:快Ｂ , 2.10
		IF TEQUIP:触手調教 == 0
			TIMES SOURCE:情愛 , 1.20
			TIMES SOURCE:達成感 , 1.20
			TIMES SOURCE:恭順追加 , 1.20
			TIMES SOURCE:屈従 , 1.20
			TIMES SOURCE:性技学習 , 1.20
			TIMES SOURCE:欲情追加 , 1.50
			TIMES SOURCE:液体追加 , 1.50
			TIMES SOURCE:痛み , 1.50
			TIMES SOURCE:支配 , 1.50
		ENDIF
	;フェアリーロードからは心を掌握する能力も追加
	ELSEIF FLAG:32 > 499
		TIMES SOURCE:快Ｃ , 1.90
		TIMES SOURCE:快Ｖ , 1.90
		TIMES SOURCE:快Ａ , 1.90
		TIMES SOURCE:快Ｂ , 1.90
		IF TEQUIP:触手調教 == 0
			TIMES SOURCE:情愛 , 1.10
			TIMES SOURCE:達成感 , 1.10
			TIMES SOURCE:恭順追加 , 1.10
			TIMES SOURCE:屈従 , 1.10
			TIMES SOURCE:性技学習 , 1.10
			TIMES SOURCE:欲情追加 , 1.30
			TIMES SOURCE:液体追加 , 1.30
			TIMES SOURCE:痛み , 1.30
			TIMES SOURCE:支配 , 1.30
		ENDIF
	ELSEIF FLAG:32 > 99
		TIMES SOURCE:快Ｃ , 1.70
		TIMES SOURCE:快Ｖ , 1.70
		TIMES SOURCE:快Ａ , 1.70
		TIMES SOURCE:快Ｂ , 1.70
		IF TEQUIP:触手調教 == 0
			TIMES SOURCE:欲情追加 , 1.30
			TIMES SOURCE:液体追加 , 1.30
			TIMES SOURCE:痛み , 1.30
			TIMES SOURCE:支配 , 1.30
		ENDIF
	ELSEIF FLAG:32 > 19
		TIMES SOURCE:快Ｃ , 1.50
		TIMES SOURCE:快Ｖ , 1.50
		TIMES SOURCE:快Ａ , 1.50
		TIMES SOURCE:快Ｂ , 1.50
		IF TEQUIP:触手調教 == 0
			TIMES SOURCE:欲情追加 , 1.20
			TIMES SOURCE:液体追加 , 1.20
			TIMES SOURCE:痛み , 1.20
			TIMES SOURCE:支配 , 1.20
		ENDIF
	ELSEIF FLAG:32 > 9
		TIMES SOURCE:快Ｃ , 1.30
		TIMES SOURCE:快Ｖ , 1.30
		TIMES SOURCE:快Ａ , 1.30
		TIMES SOURCE:快Ｂ , 1.30
		IF TEQUIP:触手調教 == 0
			TIMES SOURCE:欲情追加 , 1.10
			TIMES SOURCE:液体追加 , 1.10
			TIMES SOURCE:痛み , 1.10
			TIMES SOURCE:支配 , 1.10
		ENDIF
	ENDIF
	LOCAL:1 = 0
ENDIF

LOCAL = 0
;調教者の[つるぺた堕し][大乳導]をみる
IF TALENT:PLAYER:大乳導 && TALENT:PLAYER:つるぺた堕し
	;[絶壁][爆乳]
	IF TALENT:絶壁 || TALENT:爆乳
		LOCAL = 4
	;[貧乳][巨乳]
	ELSEIF TALENT:貧乳 || TALENT:巨乳
		LOCAL = 3
	ENDIF
;調教者の[つるぺた堕し]をみる
;以下[つるぺた堕し]持ちの心の叫び(?)
ELSEIF TALENT:PLAYER:つるぺた堕し
	;[絶壁]！鉄壁！無敵！
	IF TALENT:絶壁
		LOCAL = 4
	;[貧乳]は品乳である
	ELSEIF TALENT:貧乳
		LOCAL = 3
	;[巨乳]は虚乳にして嘘乳である
	ELSEIF TALENT:巨乳
		LOCAL = 2
	;[爆乳]は人類の敵だ！
	ELSEIF TALENT:爆乳
		LOCAL = 1
	ENDIF
;調教者の[大乳導]をみる
ELSEIF TALENT:PLAYER:大乳導
	;[絶壁]
	IF TALENT:絶壁
		LOCAL = 1
	;[貧乳]
	ELSEIF TALENT:貧乳
		LOCAL = 2
	;[巨乳]
	ELSEIF TALENT:巨乳
		LOCAL = 3
	;[爆乳]
	ELSEIF TALENT:爆乳
		LOCAL = 4
	ENDIF
ENDIF
SELECTCASE LOCAL
	CASE 1
		TIMES SOURCE:快Ｃ , 0.90
		TIMES SOURCE:快Ｖ , 0.90
		TIMES SOURCE:快Ａ , 0.90
		TIMES SOURCE:快Ｂ , 0.90
		TIMES SOURCE:接触 , 0.90
		TIMES SOURCE:情愛 , 0.90
		TIMES SOURCE:露出 , 0.90
		TIMES SOURCE:屈従 , 0.90
		TIMES SOURCE:中毒充足 , 0.90
	CASE 2
		TIMES SOURCE:快Ｃ , 0.95
		TIMES SOURCE:快Ｖ , 0.95
		TIMES SOURCE:快Ａ , 0.95
		TIMES SOURCE:快Ｂ , 0.95
		TIMES SOURCE:接触 , 0.95
		TIMES SOURCE:情愛 , 0.95
		TIMES SOURCE:露出 , 0.95
		TIMES SOURCE:屈従 , 0.95
		TIMES SOURCE:中毒充足 , 0.95
	CASE 3
		TIMES SOURCE:快Ｃ , 1.10
		TIMES SOURCE:快Ｖ , 1.10
		TIMES SOURCE:快Ａ , 1.10
		TIMES SOURCE:快Ｂ , 1.10
		TIMES SOURCE:接触 , 1.10
		TIMES SOURCE:情愛 , 1.10
		TIMES SOURCE:露出 , 1.10
		TIMES SOURCE:屈従 , 1.10
		TIMES SOURCE:中毒充足 , 1.10
	CASE 4
		TIMES SOURCE:快Ｃ , 1.20
		TIMES SOURCE:快Ｖ , 1.20
		TIMES SOURCE:快Ａ , 1.20
		TIMES SOURCE:快Ｂ , 1.20
		TIMES SOURCE:接触 , 1.20
		TIMES SOURCE:情愛 , 1.20
		TIMES SOURCE:露出 , 1.20
		TIMES SOURCE:屈従 , 1.20
		TIMES SOURCE:中毒充足 , 1.20
ENDSELECT

;攻撃力が上昇することで定評のある国士無双の薬を調教者が飲んでいる
LOCAL = 0
IF ASSIPLAY && TFLAG:162
	SELECTCASE TFLAG:162
		CASE IS <= 10
			LOCAL = 1
		CASE IS <= 20
			LOCAL = 2
		CASE IS <= 30
			LOCAL = 3
	ENDSELECT
ELSEIF ASSIPLAY == 0 && TFLAG:161
	SELECTCASE TFLAG:161
		CASE IS <= 10
			LOCAL = 1
		CASE IS <= 20
			LOCAL = 2
		CASE IS <= 30
			LOCAL = 3
	ENDSELECT
ENDIF
SELECTCASE LOCAL
	CASE 1
		TIMES SOURCE:快Ｃ , 1.10
		TIMES SOURCE:快Ｖ , 1.10
		TIMES SOURCE:快Ａ , 1.10
		TIMES SOURCE:快Ｂ , 1.10
		TIMES SOURCE:痛み , 1.10
	CASE 2
		TIMES SOURCE:快Ｃ , 1.25
		TIMES SOURCE:快Ｖ , 1.25
		TIMES SOURCE:快Ａ , 1.25
		TIMES SOURCE:快Ｂ , 1.25
		TIMES SOURCE:痛み , 1.25
	CASE 3
		TIMES SOURCE:快Ｃ , 1.50
		TIMES SOURCE:快Ｖ , 1.50
		TIMES SOURCE:快Ａ , 1.50
		TIMES SOURCE:快Ｂ , 1.50
		TIMES SOURCE:痛み , 1.50
ENDSELECT

;-------------------------------------------------
;ストレスによるソース補正チェック
;-------------------------------------------------
@SOURCE_STRESS_CHECK
SELECTCASE CFLAG:ストレス
	;ストレスは僅か
	CASE IS < 100
		TIMES SOURCE:主導権 , 0.90
		TIMES SOURCE:性技学習 , 0.95
	;ちょっと気が重い
	CASE IS < 250
		TIMES SOURCE:情愛 , 0.90
		TIMES SOURCE:主導権 , 0.80
		TIMES SOURCE:性行動 , 0.90
		TIMES SOURCE:達成感 , 0.90
		TIMES SOURCE:性技学習 , 0.90
	;ある程度重い
	CASE IS < 500
		TIMES SOURCE:快Ｃ , 0.90
		TIMES SOURCE:快Ｖ , 0.90
		TIMES SOURCE:快Ａ , 0.90
		TIMES SOURCE:快Ｂ , 0.90
		TIMES SOURCE:接触 , 0.90
		TIMES SOURCE:情愛 , 0.80
		TIMES SOURCE:主導権 , 0.75
		TIMES SOURCE:性行動 , 0.85
		TIMES SOURCE:達成感 , 0.85
		TIMES SOURCE:恭順追加 , 0.95
		TIMES SOURCE:欲情追加 , 0.95
		TIMES SOURCE:液体追加 , 0.95
		TIMES SOURCE:性技学習 , 0.80
	;結構参ってる
	CASE IS < 1000
		TIMES SOURCE:快Ｃ , 0.80
		TIMES SOURCE:快Ｖ , 0.80
		TIMES SOURCE:快Ａ , 0.80
		TIMES SOURCE:快Ｂ , 0.80
		TIMES SOURCE:接触 , 0.85
		TIMES SOURCE:情愛 , 0.80
		TIMES SOURCE:主導権 , 0.70
		TIMES SOURCE:性行動 , 0.80
		TIMES SOURCE:達成感 , 0.80
		TIMES SOURCE:恭順追加 , 0.90
		TIMES SOURCE:欲情追加 , 0.90
		TIMES SOURCE:液体追加 , 0.90
		TIMES SOURCE:羞恥扇情 , 0.95
		TIMES SOURCE:性技学習 , 0.75
		TIMES SOURCE:反感追加 , 1.10
	;明らかに様子がおかしい
	CASE IS < 3000
		TIMES SOURCE:快Ｃ , 0.70
		TIMES SOURCE:快Ｖ , 0.70
		TIMES SOURCE:快Ａ , 0.70
		TIMES SOURCE:快Ｂ , 0.70
		TIMES SOURCE:接触 , 0.75
		TIMES SOURCE:情愛 , 0.70
		TIMES SOURCE:主導権 , 0.60
		TIMES SOURCE:性行動 , 0.75
		TIMES SOURCE:達成感 , 0.75
		TIMES SOURCE:恭順追加 , 0.80
		TIMES SOURCE:欲情追加 , 0.80
		TIMES SOURCE:液体追加 , 0.80
		TIMES SOURCE:羞恥扇情 , 0.90
		TIMES SOURCE:性技学習 , 0.70
		TIMES SOURCE:逸脱 , 1.05
		TIMES SOURCE:反感追加 , 1.15
	;重症～押し潰されそう
	CASEELSE
		TIMES SOURCE:快Ｃ , 0.60
		TIMES SOURCE:快Ｖ , 0.60
		TIMES SOURCE:快Ａ , 0.60
		TIMES SOURCE:快Ｂ , 0.60
		TIMES SOURCE:接触 , 0.70
		TIMES SOURCE:情愛 , 0.65
		TIMES SOURCE:露出 , 0.95
		TIMES SOURCE:主導権 , 0.55
		TIMES SOURCE:性行動 , 0.70
		TIMES SOURCE:達成感 , 0.70
		TIMES SOURCE:恭順追加 , 0.75
		TIMES SOURCE:欲情追加 , 0.75
		TIMES SOURCE:液体追加 , 0.70
		TIMES SOURCE:中毒充足 , 0.90
		TIMES SOURCE:羞恥扇情 , 0.80
		TIMES SOURCE:性技学習 , 0.60
		TIMES SOURCE:逸脱 , 1.10
		TIMES SOURCE:反感追加 , 1.25
ENDSELECT

;=============================================================================
;パラメーター補正処理
;=============================================================================
;-------------------------------------------------
;残り体力・気力や欲情・抑鬱による上下の処理(快感系)
;-------------------------------------------------
;快感系のパラメーターは残り気力や欲情が高いと上昇しやすく、抑鬱が高いと上昇しにくいように
;補正幅は1.25～0.5倍
@UP_VIGOR_CVA_CHECK
;残り体力が500以下補正
IF BASE:体力 <= 500
	CALL UP_VIGOR_CVA_CHECK_SUB, 0
ENDIF
;残り気力補正
SELECTCASE BASE:気力
	;残り気力が0
	CASE IS <= 0
		CALL UP_VIGOR_CVA_CHECK_SUB, 0
	;残り気力が25％以下
	CASE IS <= MAXBASE:1 / 4
		CALL UP_VIGOR_CVA_CHECK_SUB, 1
	;残り気力が50％以下
	CASE IS <= MAXBASE:1 / 2
		CALL UP_VIGOR_CVA_CHECK_SUB, 2
	;残り気力が50％以上
	CASEELSE
		CALL UP_VIGOR_CVA_CHECK_SUB, 3
ENDSELECT

;欲情補正
SELECTCASE PALAM:欲情
	;欲情が100未満
	CASE IS < 100
		CALL UP_VIGOR_CVA_CHECK_SUB, 0
	;欲情が500未満
	CASE IS < 500
		CALL UP_VIGOR_CVA_CHECK_SUB, 1
	;欲情が1500未満
	CASE IS < 1500
		CALL UP_VIGOR_CVA_CHECK_SUB, 2
	;欲情が5000未満
	CASE IS < 5000
		CALL UP_VIGOR_CVA_CHECK_SUB, 3
	;欲情が10000未満
	CASE IS < 10000
		CALL UP_VIGOR_CVA_CHECK_SUB, 4
	;欲情が10000以上
	CASEELSE
		CALL UP_VIGOR_CVA_CHECK_SUB, 5
ENDSELECT

;抑鬱補正
SELECTCASE PALAM:抑鬱
	;抑鬱が100未満
	CASE IS < 100
		CALL UP_VIGOR_CVA_CHECK_SUB, 5
	;抑鬱が500未満
	CASE IS < 500
		CALL UP_VIGOR_CVA_CHECK_SUB, 4
	;抑鬱が1500未満
	CASE IS < 1500
		CALL UP_VIGOR_CVA_CHECK_SUB, 3
	;抑鬱が5000未満
	CASE IS < 5000
		CALL UP_VIGOR_CVA_CHECK_SUB, 2
	;抑鬱が10000未満
	CASE IS < 10000
		CALL UP_VIGOR_CVA_CHECK_SUB, 1
	;抑鬱が10000以上
	CASEELSE
		CALL UP_VIGOR_CVA_CHECK_SUB, 0
ENDSELECT

;………………………………………………
;補助処理
;………………………………………………
@UP_VIGOR_CVA_CHECK_SUB, ARG
SELECTCASE ARG
	CASE 0
		TIMES UP:0 , 0.50
		TIMES UP:1 , 0.50
		TIMES UP:2 , 0.50
		TIMES UP:3 , 0.50
	CASE 1
		TIMES UP:0 , 0.60
		TIMES UP:1 , 0.60
		TIMES UP:2 , 0.60
		TIMES UP:3 , 0.60
	CASE 2
		TIMES UP:0 , 0.80
		TIMES UP:1 , 0.80
		TIMES UP:2 , 0.80
		TIMES UP:3 , 0.80
	CASE 4
		TIMES UP:0 , 1.10
		TIMES UP:1 , 1.10
		TIMES UP:2 , 1.10
		TIMES UP:3 , 1.10
	CASE 5
		TIMES UP:0 , 1.25
		TIMES UP:1 , 1.25
		TIMES UP:2 , 1.25
		TIMES UP:3 , 1.25
ENDSELECT

;-------------------------------------------------
;残り体力・気力や欲情・抑鬱による上下の処理
;-------------------------------------------------
;残り気力や欲情が高い、または抑鬱が低いと上昇しやすい：潤滑・習得・恭順・欲情・反感
;残り気力や欲情が低い、または抑鬱が高いと上昇しやすい：屈服・恥情・抑鬱
@UP_VIGOR_CHECK
;残り体力が500以下補正
IF BASE:体力 <= 500
	CALL UP_VIGOR_CHECK_SUB, 0
ENDIF
;残り気力補正
SELECTCASE BASE:気力
	;残り気力が0
	CASE IS <= 0
		CALL UP_VIGOR_CHECK_SUB, 0
	;残り気力が25％以下
	CASE IS <= MAXBASE:1 / 4
		CALL UP_VIGOR_CHECK_SUB, 1
	;残り気力が50％以下
	CASE IS <= MAXBASE:1 / 2
		CALL UP_VIGOR_CHECK_SUB, 2
	;残り気力が50％以上
	CASEELSE
		CALL UP_VIGOR_CHECK_SUB, 3
ENDSELECT

;欲情補正
SELECTCASE PALAM:欲情
	;欲情が100未満
	CASE IS < 100
		CALL UP_VIGOR_CHECK_SUB, 0
	;欲情が500未満
	CASE IS < 500
		CALL UP_VIGOR_CHECK_SUB, 1
	;欲情が1500未満
	CASE IS < 1500
		CALL UP_VIGOR_CHECK_SUB, 2
	;欲情が5000未満
	CASE IS < 5000
		CALL UP_VIGOR_CHECK_SUB, 3
	;欲情が10000未満
	CASE IS < 10000
		CALL UP_VIGOR_CHECK_SUB, 4
	;欲情が10000以上
	CASEELSE
		CALL UP_VIGOR_CHECK_SUB, 5
ENDSELECT

;抑鬱補正
SELECTCASE PALAM:抑鬱
	;抑鬱が100未満
	CASE IS < 100
		CALL UP_VIGOR_CHECK_SUB, 5
	;抑鬱が500未満
	CASE IS < 500
		CALL UP_VIGOR_CHECK_SUB, 4
	;抑鬱が1500未満
	CASE IS < 1500
		CALL UP_VIGOR_CHECK_SUB, 3
	;抑鬱が5000未満
	CASE IS < 5000
		CALL UP_VIGOR_CHECK_SUB, 2
	;抑鬱が10000未満
	CASE IS < 10000
		CALL UP_VIGOR_CHECK_SUB, 1
	;抑鬱が10000以上
	CASEELSE
		CALL UP_VIGOR_CHECK_SUB, 0
ENDSELECT

;………………………………………………
;補助処理
;………………………………………………
@UP_VIGOR_CHECK_SUB, ARG
SELECTCASE ARG
	CASE 0
		TIMES UP:10 , 0.50
		TIMES UP:11 , 0.50
		TIMES UP:12 , 0.50
		TIMES UP:13 , 0.50
		TIMES UP:20 , 0.50
		TIMES UP:14 , 1.25
		TIMES UP:15 , 1.25
		TIMES UP:22 , 1.25
	CASE 1
		TIMES UP:10 , 0.60
		TIMES UP:11 , 0.60
		TIMES UP:12 , 0.60
		TIMES UP:13 , 0.60
		TIMES UP:20 , 0.60
		TIMES UP:14 , 1.10
		TIMES UP:15 , 1.10
		TIMES UP:22 , 1.10
	CASE 2
		TIMES UP:10 , 0.80
		TIMES UP:11 , 0.80
		TIMES UP:12 , 0.80
		TIMES UP:13 , 0.80
		TIMES UP:20 , 0.80
	CASE 3
		TIMES UP:14 , 0.80
		TIMES UP:15 , 0.80
		TIMES UP:22 , 0.80
	CASE 4
		TIMES UP:10 , 1.10
		TIMES UP:11 , 1.10
		TIMES UP:12 , 1.10
		TIMES UP:13 , 1.10
		TIMES UP:20 , 1.10
		TIMES UP:14 , 0.60
		TIMES UP:15 , 0.60
		TIMES UP:22 , 0.60
	CASE 5
		TIMES UP:10 , 1.25
		TIMES UP:11 , 1.25
		TIMES UP:12 , 1.25
		TIMES UP:13 , 1.25
		TIMES UP:20 , 1.25
		TIMES UP:14 , 0.50
		TIMES UP:15 , 0.50
		TIMES UP:22 , 0.50
ENDSELECT

;-------------------------------------------------
;嫉妬しやすいによる上下の処理
;-------------------------------------------------
;[恋慕]が付いていること前提
;好感度が高いと恭順が上がりやすく、嫉妬度が高いと反感が上がりやすい
@UP_ENVY_CHECK
SELECTCASE CFLAG:好感度
	;好感度が1500未満
	CASE IS < 1500
		TIMES UP:12 , 1.00
	;好感度が2000未満
	CASE IS < 2000
		TIMES UP:12 , 1.25
	;好感度が5000未満
	CASE IS < 5000
		TIMES UP:12 , 1.50
	;好感度が5000以上
	CASEELSE
		TIMES UP:12 , 2.00
ENDSELECT

SELECTCASE CFLAG:嫉妬ポイント
	;嫉妬度が10未満
	CASE IS < 10
		TIMES UP:20 , 0.60
	;嫉妬度が25未満
	CASE IS < 25
		TIMES UP:20 , 0.80
	;嫉妬度が50未満
	CASE IS < 50
		TIMES UP:20 , 1.00
	;嫉妬度が75未満
	CASE IS < 75
		TIMES UP:20 , 1.25
	;嫉妬度が100未満
	CASE IS < 100
		TIMES UP:20 , 1.50
	;嫉妬度が100以上
	CASEELSE
		TIMES UP:20 , 2.00
ENDSELECT
;-------------------------------------------------
;理性値の処理
;-------------------------------------------------
@CALC_REASON
IF !TALENT:理性 || EQUIP:睡眠薬 || TFLAG:899 >= 1
	TIMES UP:12 , 1.25
	TIMES UP:13 , 1.25
	TIMES UP:14 , 1.25
	TIMES UP:15 , 0.90
	TIMES UP:20 , 0.80
	TIMES UP:21 , 0.80
	TIMES UP:22 , 0.80
ELSE
SELECTCASE (BASE:理性 / 120)
	;理性が0以下
	CASE IS <= 0
		TIMES UP:12 , 1.20
		TIMES UP:13 , 1.20
		TIMES UP:14 , 1.20
		TIMES UP:15 , 0.90
		TIMES UP:20 , 0.85
		TIMES UP:21 , 0.85
		TIMES UP:22 , 0.85
	;理性が20未満
	CASE IS < 20
		TIMES UP:12 , 1.10
		TIMES UP:13 , 1.10
		TIMES UP:14 , 1.10
		TIMES UP:15 , 0.90
		TIMES UP:20 , 0.90
		TIMES UP:21 , 0.90
		TIMES UP:22 , 0.90
	;理性が40未満
	CASE IS < 40
		TIMES UP:12 , 1.05
		TIMES UP:13 , 1.05
		TIMES UP:14 , 1.05
		TIMES UP:15 , 0.95
		TIMES UP:20 , 0.95
		TIMES UP:21 , 0.95
		TIMES UP:22 , 0.95
	;理性が60未満
	CASE IS < 60

	;理性が80未満
	CASE IS < 80
		TIMES UP:12 , 0.95
		TIMES UP:13 , 0.95
		TIMES UP:14 , 0.95
		TIMES UP:15 , 1.05
	;理性が100未満
	CASE IS < 100
		TIMES UP:12 , 0.85
		TIMES UP:13 , 0.85
		TIMES UP:14 , 0.85
		TIMES UP:15 , 1.15
	;理性が100以上
	CASEELSE
		TIMES UP:12 , 0.80
		TIMES UP:13 , 0.80
		TIMES UP:14 , 0.80
		TIMES UP:15 , 1.20
ENDSELECT
ENDIF

;-------------------------------------------------
;素質などによる上下の処理(快感系)
;-------------------------------------------------
@UP_TALENT_CVA_CHECK
;媚薬
IF TEQUIP:媚薬
	;[媚薬中毒]で効果微強化
	IF TALENT:媚薬中毒
		TIMES UP:0 , 2.25
		TIMES UP:1 , 2.25
		TIMES UP:2 , 2.25
		TIMES UP:3 , 2.25
	ELSE
		TIMES UP:0 , 2.00
		TIMES UP:1 , 2.00
		TIMES UP:2 , 2.00
		TIMES UP:3 , 2.00
	ENDIF
ENDIF
;利尿剤
IF TEQUIP:利尿剤
	TIMES UP:0 , 0.70
	TIMES UP:1 , 0.70
	TIMES UP:2 , 0.70
	TIMES UP:3 , 0.70
ENDIF
;失神中
IF TFLAG:899 > 0
	TIMES UP:0 , 0.25
	TIMES UP:1 , 0.25
	TIMES UP:2 , 0.25
	TIMES UP:3 , 0.25
;睡眠
ELSEIF EQUIP:睡眠薬
	TIMES UP:0 , 0.75
	TIMES UP:1 , 0.75
	TIMES UP:2 , 0.75
	TIMES UP:3 , 0.75
ENDIF
;触手言葉責め
IF TEQUIP:キャラ触手 & 4
	TIMES UP:14 , 1.20
	TIMES UP:15 , 2.80
	TIMES UP:17 , 1.20
	TIMES UP:20 , 1.80
ENDIF

;戦闘中
IF EQUIP:戦闘中
	IF !EQUIP:脱衣
		TIMES UP:0 , 0.9
		TIMES UP:1 , 0.9
		TIMES UP:2 , 0.9
		TIMES UP:3 , 0.9
	ENDIF
	;TARGETの防御
	IF TEQUIP:戦闘状態 == 5
		TIMES UP:0 , 0.7
		TIMES UP:1 , 0.7
		TIMES UP:2 , 0.7
		TIMES UP:3 , 0.7
	;受け入れる
	ELSEIF TEQUIP:戦闘状態 == 9
		TIMES UP:0 , 1.5
		TIMES UP:1 , 1.5
		TIMES UP:2 , 1.5
		TIMES UP:3 , 1.5
	;奉仕する
	ELSEIF TEQUIP:戦闘状態 == 10
		TIMES UP:0 , 1.2
		TIMES UP:1 , 1.2
		TIMES UP:2 , 1.2
		TIMES UP:3 , 1.2
	;Ｖ挿入防御
	ELSEIF TEQUIP:戦闘状態 == 11
		TIMES UP:0 , 1.5
		TIMES UP:1 , 0.5
		TIMES UP:2 , 1.5
		TIMES UP:3 , 1.5
	ENDIF
ENDIF

;理性
IF !TALENT:理性 || EQUIP:睡眠薬 || TFLAG:899 >= 1
	TIMES UP:0 , 1.20
	TIMES UP:1 , 1.20
	TIMES UP:2 , 1.20
	TIMES UP:3 , 1.20
ELSE
	SELECTCASE (BASE:理性 / 120)
		;理性が0以下
		CASE IS <= 0
			TIMES UP:0 , 1.15
			TIMES UP:1 , 1.15
			TIMES UP:2 , 1.15
			TIMES UP:3 , 1.15
		;理性が20未満
		CASE IS < 20
			TIMES UP:0 , 1.10
			TIMES UP:1 , 1.10
			TIMES UP:2 , 1.10
			TIMES UP:3 , 1.10
		;理性が40未満
		CASE IS < 40
			TIMES UP:0 , 1.05
			TIMES UP:1 , 1.05
			TIMES UP:2 , 1.05
			TIMES UP:3 , 1.05
		;理性が60未満
		CASE IS < 60
			TIMES UP:0 , 1.00
			TIMES UP:1 , 1.00
			TIMES UP:2 , 1.00
			TIMES UP:3 , 1.00
		;理性が80未満
		CASE IS < 80
			TIMES UP:0 , 0.95
			TIMES UP:1 , 0.95
			TIMES UP:2 , 0.95
			TIMES UP:3 , 0.95
		;理性が100未満
		CASE IS < 100
			TIMES UP:0 , 0.90
			TIMES UP:1 , 0.90
			TIMES UP:2 , 0.90
			TIMES UP:3 , 0.90
		;理性が100以上
		CASEELSE
			TIMES UP:0 , 0.85
			TIMES UP:1 , 0.85
			TIMES UP:2 , 0.85
			TIMES UP:3 , 0.85
	ENDSELECT
ENDIF

;陰核が成長しすぎていると感度減少
SIF BASE:陰核 > 200
	TIMES UP:0 , 0.75

;[肥大陰核]
SIF TALENT:肥大陰核
	TIMES UP:0 , 0.45
;[自制心]
IF TALENT:自制心
	TIMES UP:0 , 0.40
	TIMES UP:1 , 0.55
	TIMES UP:2 , 0.75
	TIMES UP:3 , 0.40
ENDIF
;映姫様補正
IF NO:TARGET == 1036 && TALENT:快感の否定
	IF (TALENT:恋慕 || TALENT:妄信 || TALENT:親愛 || TALENT:相愛) && ASSIPLAY == 0
		TIMES UP:0 , 1.50
		TIMES UP:1 , 1.50
		TIMES UP:2 , 1.50
		TIMES UP:3 , 1.50
	ELSE
		TIMES UP:0 , 0.75
		TIMES UP:1 , 0.75
		TIMES UP:2 , 0.75
		TIMES UP:3 , 0.75
	ENDIF
ENDIF
;[オトコ]
SIF TALENT:オトコ
	TIMES UP:2 , 1.30
;[精神崩壊]
IF TALENT:精神崩壊
	TIMES UP:0 , 0.20
	TIMES UP:1 , 0.20
	TIMES UP:2 , 0.20
	TIMES UP:3 , 0.20
ENDIF
;[壊造人格]
IF TALENT:壊造人格
	TIMES UP:0 , 1.25
	TIMES UP:1 , 1.25
	TIMES UP:2 , 1.25
	TIMES UP:3 , 1.25
ENDIF
;[淫魔]
IF TALENT:淫魔
	TIMES UP:0 , 1.75
	TIMES UP:1 , 1.75
	TIMES UP:2 , 1.75
	TIMES UP:3 , 1.75
;[即落ち]
ELSEIF TALENT:即落ち
	TIMES UP:0 , 1.50
	TIMES UP:1 , 1.50
	TIMES UP:2 , 1.50
	TIMES UP:3 , 1.50
ENDIF

;[キョンシー]
IF TALENT:キョンシー
	TIMES UP:0 , 0.60
	TIMES UP:1 , 0.60
	TIMES UP:2 , 0.60
	TIMES UP:3 , 0.60
ENDIF

;[發情中]
IF TALENT:常時発情
	TIMES UP:0 , 1.15
	TIMES UP:1 , 1.15
	TIMES UP:2 , 1.15
	TIMES UP:3 , 1.15
ELSEIF TALENT:発情可 && (TALENT:危険日 || TALENT:排卵)
	TIMES UP:0 , 1.1
	TIMES UP:1 , 1.1
	TIMES UP:2 , 1.1
	TIMES UP:3 , 1.1
ENDIF

;1週目
IF FLAG:6 == 1
	FOR PC_VAR1, 0, 4
		TIMES UP:PC_VAR1 , 1.20
	NEXT
ENDIF
;HARD
IF FLAG:3 == 3
	TIMES UP:0 , 0.80
	TIMES UP:1 , 0.80
	TIMES UP:2 , 0.80
	TIMES UP:3 , 0.80
;LUNATIC/ULTRA
ELSEIF FLAG:3 == 4 || FLAG:3 == 6
	TIMES UP:0 , 0.65
	TIMES UP:1 , 0.65
	TIMES UP:2 , 0.65
	TIMES UP:3 , 0.65
;PHANTASM/OVERDRIVE
ELSEIF FLAG:3 >= 5
	TIMES UP:0 , 0.50
	TIMES UP:1 , 0.50
	TIMES UP:2 , 0.50
	TIMES UP:3 , 0.50
ENDIF

;淫蟲
IF TEQUIP:特殊風呂入浴中 == 1
	TIMES UP:0 , 2.00
	TIMES UP:1 , 2.00
	TIMES UP:2 , 2.00
	TIMES UP:3 , 2.00
ENDIF

;クリトリスリング
IF CFLAG:42 & 1
	TIMES UP:0 , 2.00
	UP:0 += 100
ENDIF
;ラビアピアス
SIF CFLAG:42 & 16
	TIMES UP:1 , 0.60
;ニプルピアス
SIF CFLAG:42 & 32
	TIMES UP:3 , 0.25

;防御力が上昇することで定評のある国士無双の薬
IF TFLAG:160
	SELECTCASE TFLAG:160
		CASE IS <= 10
			TIMES UP:0 , 0.90
			TIMES UP:1 , 0.90
			TIMES UP:2 , 0.90
			TIMES UP:3 , 0.90
		CASE IS <= 20
			TIMES UP:0 , 0.75
			TIMES UP:1 , 0.75
			TIMES UP:2 , 0.75
			TIMES UP:3 , 0.75
		CASEELSE
			TIMES UP:0 , 0.50
			TIMES UP:1 , 0.50
			TIMES UP:2 , 0.50
			TIMES UP:3 , 0.50
	ENDSELECT
ENDIF

;-------------------------------------------------
;素質などによる上下の処理(快感系以外)
;-------------------------------------------------
@UP_TALENT_CHECK
;パイパン
IF TALENT:パイパン
	UP:14 += 100
	UP:15 += 200
	UP:22 += 100
	TIMES UP:14 , 1.20
	TIMES UP:15 , 2.50
	TIMES UP:22 , 1.50
	IF BASE:陰毛 > 50 && BASE:陰毛 <= 250
		;生えかけ
		UP:16 += 100
		UP:21 += 100
		TIMES UP:16 , 1.20
		TIMES UP:21 , 1.50
	ENDIF
ENDIF
;[發情中]
IF TALENT:常時発情
	TIMES UP:13 , 1.5
ELSEIF TALENT:発情可 && TALENT:危険日 || TALENT:排卵
	TIMES UP:13 , 1.3
ENDIF
;[生理]
IF TALENT:生理 || (TALENT:幼児 && DAY >= (CFLAG:誕生日 + 49))
	TIMES UP:20 , 1.3
	TIMES UP:21 , 1.3
ENDIF

;戦闘中
IF EQUIP:戦闘中
	IF EQUIP:脱衣
		TIMES DOWNBASE:0 , 0.8
		TIMES DOWNBASE:1 , 0.8
		TIMES DOWNBASE:9 , 1.2
	ELSE
		TIMES UP:20 , 0.8
		TIMES UP:21 , 0.8
		TIMES UP:22 , 1.2
		TIMES DOWNBASE:0 , 0.7
		TIMES DOWNBASE:1 , 0.7
		TIMES DOWNBASE:9 , 1.1
	ENDIF
	;TARGETの防御
	IF TEQUIP:戦闘状態 == 5
		TIMES UP:20 , 1.3
		TIMES UP:21 , 1.3
		TIMES UP:22 , 1.3
		TIMES DOWNBASE:0 , 0.5
		TIMES DOWNBASE:1 , 0.5
		;TIMES DOWNBASE:9 , 1.0
	;受け入れる
	ELSEIF TEQUIP:戦闘状態 == 9
		TIMES UP:13 , 1.5
		TIMES UP:20 , 0.8
		TIMES UP:21 , 0.8
		TIMES UP:22 , 0.8
		TIMES DOWNBASE:0 , 0.8
		TIMES DOWNBASE:1 , 0.8
		TIMES DOWNBASE:9 , 1.4
	;奉仕する
	ELSEIF TEQUIP:戦闘状態 == 10
		TIMES UP:12 , 1.5
		TIMES UP:14 , 1.5
		TIMES UP:20 , 0.6
		TIMES UP:21 , 0.6
		TIMES UP:22 , 0.6
		TIMES DOWNBASE:0 , 0.7
		TIMES DOWNBASE:1 , 0.7
		TIMES DOWNBASE:9 , 1.5
	;Ｖ挿入防御
	ELSEIF TEQUIP:戦闘状態 == 11
		TIMES UP:20 , 0.9
		TIMES UP:21 , 0.9
		TIMES UP:22 , 1.1
		TIMES DOWNBASE:0 , 0.9
		TIMES DOWNBASE:1 , 0.9
		TIMES DOWNBASE:9 , 1.3
	ENDIF
	;大成功
	IF TFLAG:551 == 1
		TIMES UP:20 , 0.7
		TIMES UP:21 , 0.7
		TIMES UP:22 , 0.7
		TIMES DOWNBASE:0 , 1.3
		TIMES DOWNBASE:1 , 1.3
		TIMES DOWNBASE:9 , 1.3
	ENDIF
ENDIF

;媚薬
IF TEQUIP:媚薬
	;媚薬中毒で効果微強化
	IF TALENT:媚薬中毒
		TIMES UP:12 , 1.30
		TIMES UP:13 , 2.25
		TIMES UP:14 , 1.30
		TIMES UP:20 , 0.60
		TIMES UP:21 , 0.30
	ELSE
		TIMES UP:12 , 1.20
		TIMES UP:13 , 2.00
		TIMES UP:14 , 1.20
		TIMES UP:20 , 0.75
		TIMES UP:21 , 0.50
	ENDIF
ENDIF
;利尿剤
IF TEQUIP:利尿剤
	TIMES UP:12 , 0.80
	TIMES UP:13 , 0.80
	TIMES UP:14 , 1.50
	TIMES UP:15 , 1.20
	TIMES UP:20 , 1.50
	TIMES UP:21 , 1.20
	TIMES UP:22 , 1.50
ENDIF
;睡眠中
IF EQUIP:睡眠薬
	TIMES UP:12 , 0.50
	TIMES UP:13 , 0.75
	TIMES UP:14 , 0.10
	TIMES UP:15 , 0.10
	TIMES UP:17 , 0.00
	TIMES UP:20 , 0.00
	TIMES UP:21 , 0.10
	TIMES UP:22 , 0.00
	TIMES DOWNBASE:1 , 0.25
	TIMES DOWNBASE:9 , 0.25
ENDIF
;失神中
IF TFLAG:899 >= 1
	;失神中は意識が無く、目覚めても失神中にされたことの内容は覚えていないので、快ＣＶＡＢ・潤滑・欲情・苦痛・薬毒・侵蝕・触手以外のPALAMは上げない
	UP:11 = 0
	UP:12 = 0
	UP:14 = 0
	UP:15 = 0
	UP:17 = 0
	UP:20 = 0
	UP:21 = 0
	UP:22 = 0
	UP:32 = 0
	UP:100 = 0
	;欲情にマイナス補正
	TIMES UP:13 , 0.75
ENDIF
;荊
IF TEQUIP:緊縛関連 == 5
	TIMES UP:16 , 2.00
	TIMES UP:17 , 2.00
	TIMES UP:20 , 0.75
	TIMES UP:21 , 0.50
ENDIF
;蜘蛛糸
IF TEQUIP:緊縛関連 == 6 || TEQUIP:緊縛関連 == 7
	TIMES UP:15 , 1.70
	TIMES UP:16 , 0.80
	TIMES UP:17 , 2.00
	TIMES UP:20 , 0.75
	TIMES UP:21 , 0.50
ENDIF
;淫蟲
IF TEQUIP:特殊風呂入浴中 == 1
	TIMES UP:13 , 2.00
	TIMES UP:14 , 1.20
	TIMES UP:17 , 2.00
	TIMES UP:20 , 0.75
	TIMES UP:21 , 0.50
ENDIF
;触手精神制御中
IF TEQUIP:精神制御系 == 2
	TIMES UP:12 , 1.50
	TIMES UP:13 , 1.50
	TIMES UP:14 , 1.20
	TIMES UP:15 , 1.20
	TIMES UP:17 , 0.80
	TIMES UP:20 , 0.30
	TIMES UP:21 , 0.40
	TIMES UP:22 , 0.50
	TIMES UP:31 , 1.80
	TIMES UP:32 , 0.75
ENDIF

;臆病
IF TALENT:臆病
	TIMES UP:17 , 2.00
	TIMES UP:20 , 0.50
	TIMES UP:22 , 0.25
ENDIF
;反抗的
IF TALENT:反抗的
	TIMES UP:12 , 0.25
	TIMES UP:13 , 0.50
	TIMES UP:20 , 1.50
ENDIF
;気丈
IF TALENT:気丈
	TIMES UP:12 , 0.30
	TIMES UP:13 , 0.75
	TIMES UP:17 , 0.80
	TIMES UP:20 , 2.00
	TIMES UP:22 , 2.00
ENDIF
;素直
IF TALENT:素直
	TIMES UP:12 , 2.00
	TIMES UP:20 , 0.60
ENDIF
;大人しい
SIF TALENT:大人しい
	TIMES UP:20 , 0.30
;プライド高い
IF TALENT:プライド高い
	TIMES UP:14 , 0.50
	TIMES UP:17 , 0.60
	TIMES UP:20 , 1.20
;プライド低い
ELSEIF TALENT:プライド低い
	TIMES UP:14 , 2.00
	TIMES UP:17 , 1.50
	TIMES UP:20 , 0.80
ENDIF
;無関心
IF TALENT:無関心
	TIMES UP:12 , 0.50
	TIMES UP:13 , 0.50
	TIMES UP:14 , 0.50
	TIMES UP:17 , 0.80
	TIMES UP:20 , 0.80
ENDIF
;感情乏しい
IF TALENT:感情乏しい
	TIMES UP:12 , 0.60
	TIMES UP:13 , 0.60
	TIMES UP:14 , 0.60
	TIMES UP:15 , 0.60
	TIMES UP:17 , 0.60
	TIMES UP:20 , 0.60
	TIMES UP:21 , 0.60
	TIMES UP:22 , 0.60
ENDIF
;好奇心
SIF TALENT:好奇心
	TIMES UP:11 , 1.20
;保守的
SIF TALENT:保守的
	TIMES UP:11 , 0.80
;楽観的
IF TALENT:楽観的
	TIMES UP:22 , 0.30
;悲観的
ELSEIF TALENT:悲観的
	TIMES UP:22 , 2.50
ENDIF
;貞操無頓着
IF TALENT:貞操無頓着
	TIMES UP:12 , 1.20
	TIMES UP:13 , 1.25
	TIMES UP:20 , 0.60
	TIMES UP:22 , 0.40
ENDIF
;抑圧
IF TALENT:抑圧
	TIMES UP:13 , 0.50
	TIMES UP:20 , 2.00
	TIMES UP:22 , 1.50
ENDIF
;解放
IF TALENT:解放
	TIMES UP:13 , 2.00
	TIMES UP:14 , 2.00
ENDIF
;抵抗
IF TALENT:抵抗
	TIMES UP:13 , 0.50
	TIMES UP:20 , 2.00
ENDIF
;痛みに弱い
IF TALENT:痛みに弱い
	TIMES UP:17 , 2.00
	TIMES UP:20 , 1.50
;痛みに強い
ELSEIF TALENT:痛みに強い
	TIMES UP:17 , 0.50
	TIMES UP:20 , 0.75
ENDIF
;薬毒耐性
IF TALENT:薬毒耐性
	TIMES UP:30 , 0.20
;媚薬中毒
ELSEIF TALENT:媚薬中毒
	TIMES UP:30 , 1.50
ENDIF
;習得早い
IF TALENT:習得早い
	TIMES UP:11 , 2.00
;習得遅い
ELSEIF TALENT:習得遅い
	TIMES UP:11 , 0.50
ENDIF
;献身的
SIF TALENT:献身的
	TIMES UP:14 , 2.00
;快感に素直
IF TALENT:快感に素直
	TIMES UP:13 , 2.00
;快感の否定
ELSEIF TALENT:快感の否定
	TIMES UP:13 , 0.50
	;映姫様補正(助手による調教か恋愛系素質を持っていない場合屈服のパラ上昇が抑制される）
	SIF NO:TARGET == 1036 && ((TALENT:恋慕 + TALENT:妄信 + TALENT:親愛 + TALENT:相愛) == 0 || ASSIPLAY)
		TIMES UP:14 , 0.75
ENDIF
;中毒しやすい
SIF TALENT:中毒しやすい
	TIMES UP:30 , 1.20
;巨躯
IF TALENT:巨躯
	TIMES UP:16 , 0.75
	TIMES UP:17 , 0.80
ENDIF
;妄信以外の恋慕系素質は主人調教でのみ効果を発揮
IF ASSIPLAY == 0
	;相愛
	IF TALENT:相愛
		TIMES UP:12 , 2.50
		TIMES UP:14 , 3.00
		TIMES UP:20 , 0.10
		TIMES UP:21 , 0.10
		TIMES UP:22 , 0.10
	;親愛
	ELSEIF TALENT:親愛
		TIMES UP:12 , 2.00
		TIMES UP:14 , 2.50
		TIMES UP:20 , 0.20
		TIMES UP:21 , 0.20
		TIMES UP:22 , 0.20
	;恋慕
	ELSEIF TALENT:恋慕
		TIMES UP:12 , 1.50
		TIMES UP:20 , 0.50
		TIMES UP:21 , 0.50
	ENDIF
ENDIF
;妄信
IF TALENT:妄信
	TIMES UP:14 , 4.00
	TIMES UP:20 , 0.50
ENDIF
;嫉妬
IF TALENT:狂気 && ASSI >= 0 && CFLAG:ASSI:好感度 >= 500 && ASSIPLAY == 0
	;相愛
	IF TALENT:ASSI:相愛
		TIMES UP:14 , 2.50
		TIMES UP:16 , 2.00
	;親愛
	ELSEIF TALENT:ASSI:親愛
		TIMES UP:14 , 2.00
		TIMES UP:16 , 1.50
	;恋慕
	ELSEIF TALENT:ASSI:恋慕
		TIMES UP:14 , 1.50
		TIMES UP:16 , 1.20
	ELSE
		TIMES UP:14 , 1.25
	ENDIF
ENDIF
;幼児退行
IF TALENT:幼児退行
	TIMES UP:12 , 1.50
	TIMES UP:16 , 1.50
	TIMES UP:17 , 2.00
	TIMES UP:20 , 2.00
	TIMES UP:30 , 1.20
	TIMES UP:11 , 0.25
	TIMES UP:13 , 0.50
	TIMES UP:15 , 0.25
	TIMES UP:22 , 0.50
ENDIF
;服従
IF TALENT:服従
	TIMES UP:14 , 2.00
	TIMES UP:20 , 0.50
ENDIF
;烙印
IF TALENT:烙印
	TIMES UP:14 , 2.00
	TIMES UP:15 , 2.00
	TIMES UP:20 , 0.30
	TIMES UP:21 , 0.30
ENDIF
;隷属
IF TALENT:隷属
	TIMES UP:12 , 1.80
	TIMES UP:14 , 2.50
	TIMES UP:20 , 0.25
	TIMES UP:21 , 0.25
	TIMES UP:22 , 0.20
ENDIF
;傷物
IF TALENT:傷物
	TIMES UP:12 , 0.50
	TIMES UP:16 , 0.80
	TIMES UP:17 , 1.50
	TIMES UP:20 , 1.20
	TIMES UP:22 , 2.50
ENDIF
;使い魔
IF TALENT:使い魔
	TIMES UP:12 , 1.75
	TIMES UP:13 , 1.75
	TIMES UP:14 , 1.75
	TIMES UP:20 , 0.60
	TIMES UP:21 , 0.60
ENDIF
;精神崩壊
IF TALENT:精神崩壊
	TIMES UP:11 , 0.40
	TIMES UP:12 , 0.20
	TIMES UP:13 , 0.40
	TIMES UP:14 , 0.20
	TIMES UP:15 , 0.20
	TIMES UP:17 , 0.20
	TIMES UP:20 , 0.20
	TIMES UP:21 , 0.20
	TIMES UP:22 , 0.20
	TIMES UP:30 , 0.20
ENDIF
;傀儡
IF TALENT:傀儡
	TIMES UP:12 , 0.40
	TIMES UP:13 , 0.40
	TIMES UP:14 , 0.40
	TIMES UP:15 , 0.40
	TIMES UP:17 , 0.40
	TIMES UP:20 , 0.40
	TIMES UP:21 , 0.40
	TIMES UP:22 , 0.40
ENDIF
;壊造人格
IF TALENT:壊造人格
	TIMES UP:10 , 1.25
	TIMES UP:11 , 1.50
	TIMES UP:12 , 1.50
	TIMES UP:13 , 1.50
	TIMES UP:14 , 1.50
	TIMES UP:15 , 1.25
	TIMES UP:16 , 1.25
	TIMES UP:17 , 1.25
	TIMES UP:20 , 0.20
	TIMES UP:21 , 0.20
	TIMES UP:22 , 0.20
ENDIF
;淫魔
IF TALENT:淫魔
	TIMES UP:13 , 3.00
;即落ち
ELSEIF TALENT:即落ち
	TIMES UP:13 , 2.00
ENDIF
;吸血鬼
IF TALENT:吸血鬼
	IF ABL:従順 < 3 && ABL:欲望 < 3
		TIMES UP:12 , 0.75
		TIMES UP:14 , 0.75
	ENDIF
	TIMES UP:17 , 0.50
ENDIF
;人形
IF TALENT:人形
	TIMES UP:10 , 0.75
	TIMES UP:13 , 0.75
ENDIF
;悪魔
SIF TALENT:悪魔
	TIMES UP:13 , 1.25
IF TALENT:PLAYER:悪魔
	TIMES UP:13 , 1.25
	TIMES UP:16 , 1.25
ENDIF
;河童
SIF TALENT:河童
	TIMES UP:11 , 1.50
SIF TALENT:PLAYER:河童
	TIMES UP:11 , 1.20
;妖狐
SIF TALENT:PLAYER:妖狐
	TIMES UP:15 , 2.50
;[半白澤](変身中)
IF TALENT:半白澤 == 2
	TIMES UP:13 , 1.80
	TIMES UP:14 , 0.80
	TIMES UP:15 , 0.80
	TIMES UP:17 , 0.80
	TIMES UP:20 , 0.60
	TIMES UP:21 , 0.60
	TIMES UP:22 , 0.60
	TIMES UP:32 , 1.50
ENDIF

;ＮＴＲ
IF TALENT:旦那あり
	TIMES UP:12 , 0.50
	TIMES UP:14 , 0.50
	TIMES UP:20 , 1.50
	TIMES UP:21 , 1.50
	TIMES UP:22 , 1.50
ELSEIF TALENT:彼氏あり
	TIMES UP:12 , 0.60
	TIMES UP:14 , 0.60
	TIMES UP:20 , 1.40
	TIMES UP:21 , 1.40
	TIMES UP:22 , 1.40
ELSEIF TALENT:思い人あり
	TIMES UP:12 , 0.70
	TIMES UP:14 , 0.70
	TIMES UP:20 , 1.30
	TIMES UP:21 , 1.30
	TIMES UP:22 , 1.30
ENDIF

;覚(心の目を閉ざしているか[精神崩壊]除く)
IF TALENT:覚 == 1 && TALENT:精神崩壊 == 0
	TIMES UP:17 , 1.25
	TIMES UP:20 , 1.25
ENDIF
IF TALENT:PLAYER:覚 && TALENT:PLAYER:精神崩壊 == 0 && NO:PLAYER != 1064
	TIMES UP:14 , 1.25
	TIMES UP:15 , 1.25
	TIMES UP:17 , 1.25
ENDIF
;鬼
IF TALENT:鬼
	IF ABL:従順 < 3 && ABL:欲望 < 3
		TIMES UP:12 , 0.80
		TIMES UP:14 , 0.50
	ENDIF
	TIMES UP:15 , 0.75
	TIMES UP:17 , 0.50
ENDIF
;[天狗]
IF TALENT:天狗
	IF ABL:従順 < 3 && ABL:欲望 < 3
		TIMES UP:12 , 0.60
		TIMES UP:14 , 0.60
	ENDIF
	TIMES UP:11 , 1.10
	TIMES UP:17 , 0.80
ENDIF
;[仙人]
IF TALENT:仙人
	IF ABL:従順 < 3 && ABL:欲望 < 3
		TIMES UP:13 , 0.50
		TIMES UP:14 , 0.80
	ENDIF
	TIMES UP:21 , 0.80
ENDIF
;[キョンシー]
IF TALENT:キョンシー
	TIMES UP:11 , 0.80
	TIMES UP:14 , 1.20
	TIMES UP:15 , 0.80
	TIMES UP:16 , 0.40
	TIMES UP:17 , 0.60
	TIMES UP:20 , 0.40
	TIMES UP:22 , 0.40
	TIMES UP:30 , 0.60
ENDIF
;[化け狸]
SIF TALENT:PLAYER:化け狸
	TIMES UP:14 , 2.50

;1週目
IF FLAG:6 == 1
	FOR PC_VAR1, 11, 18
		TIMES UP:PC_VAR1 , 1.20
	NEXT
	TIMES UP:20 , 0.80
	TIMES UP:21 , 0.80
	TIMES UP:22 , 0.80
ENDIF
;HARD
IF FLAG:3 == 3
	TIMES UP:12 , 0.80
	TIMES UP:13 , 0.80
	TIMES UP:14 , 0.80
	TIMES UP:17 , 0.80
	TIMES UP:21 , 1.50
;LUNATIC/ULTRA
ELSEIF FLAG:3 == 4 || FLAG:3 == 6
	TIMES UP:12 , 0.65
	TIMES UP:13 , 0.65
	TIMES UP:14 , 0.65
	TIMES UP:17 , 0.65
	TIMES UP:21 , 1.75
;PHANTASM/OVERDRIVE
ELSEIF FLAG:3 >= 5
	TIMES UP:12 , 0.50
	TIMES UP:13 , 0.50
	TIMES UP:14 , 0.50
	TIMES UP:17 , 0.50
	TIMES UP:21 , 2.00
ENDIF

;クリトリスリング
IF CFLAG:42 & 1
	UP:13 += 60
	UP:14 += 50
	UP:16 += 80
	TIMES UP:13 , 1.40
	TIMES UP:14 , 1.50
	TIMES UP:16 , 1.20
ENDIF

;調教者の技巧による反感と不快の軽減処理
SELECTCASE ABL:PLAYER:技巧
	CASE 0
		TIMES UP:20 , 1.20
		TIMES UP:21 , 1.20
	CASE 1
		TIMES UP:20 , 1.10
		TIMES UP:21 , 1.10
	CASE 2
		TIMES UP:20 , 1.00
		TIMES UP:21 , 1.00
	CASE 3
		TIMES UP:20 , 0.80
		TIMES UP:21 , 0.80
	CASE 4
		TIMES UP:20 , 0.55
		TIMES UP:21 , 0.55
	CASEELSE
		TIMES UP:20 , 0.30
		TIMES UP:21 , 0.30
ENDSELECT
;調教者の[半白澤](変身中)
IF TALENT:PLAYER:半白澤 == 2
	TIMES UP:13 , 1.20
	TIMES UP:14 , 1.40
	TIMES UP:17 , 1.40
ENDIF
;調教者の爆発物
IF TALENT:PLAYER:爆発物
	TIMES UP:12 , 0.80
	TIMES UP:13 , 0.75
	TIMES UP:15 , 0.80
	TIMES UP:10 , 1.25
	TIMES UP:14 , 1.40
	TIMES UP:17 , 2.00
ENDIF
;調教者の死神(相手が霊体なら屈服も上昇)
IF TALENT:PLAYER:死神 && TALENT:神霊 == 0
	SIF TALENT:霊体
		TIMES UP:14 , 1.25
	TIMES UP:17 , 1.25
ENDIF

;防御力が上昇することで定評のある国士無双の薬
IF TFLAG:160
	SELECTCASE TFLAG:160
		CASE IS <= 10
			TIMES UP:13 , 0.90
			TIMES UP:14 , 0.90
			TIMES UP:16 , 0.90
			TIMES UP:20 , 1.10
			TIMES UP:21 , 1.10
			TIMES UP:22 , 1.10
		CASE IS <= 20
			TIMES UP:13 , 0.75
			TIMES UP:14 , 0.75
			TIMES UP:16 , 0.75
			TIMES UP:20 , 1.25
			TIMES UP:21 , 1.25
			TIMES UP:22 , 1.25
		CASEELSE
			TIMES UP:13 , 0.50
			TIMES UP:14 , 0.50
			TIMES UP:16 , 0.50
			TIMES UP:20 , 1.50
			TIMES UP:21 , 1.50
			TIMES UP:22 , 1.50
	ENDSELECT
ENDIF

;恥辱刻印
SELECTCASE MARK:恥辱刻印
	CASE 1
		TIMES UP:15 , 1.20
		TIMES UP:22 , 0.90
	CASE 2
		TIMES UP:15 , 1.50
		TIMES UP:22 , 0.70
	CASE 3
		TIMES UP:15 , 1.80
		TIMES UP:22 , 0.40
ENDSELECT
;恐怖刻印
SELECTCASE MARK:恐怖刻印
	CASE 1
		TIMES UP:17 , 1.30
	CASE 2
		TIMES UP:17 , 1.80
	CASE 3
		TIMES UP:17 , 2.40
ENDSELECT
;反発刻印
SELECTCASE MARK:反発刻印
	CASE 1
		TIMES UP:12 , 0.70
	CASE 2
		TIMES UP:12 , 0.40
	CASE 3
		TIMES UP:12 , 0.10
ENDSELECT

;触手調教中か[寄生]・[懐卵]持ちでない限り侵蝕のパラメータは上昇しない
SIF TEQUIP:触手調教 == 0 && TALENT:懐卵 == 0 && TALENT:寄生 == 0
	UP:31 = 0

;=============================================================================
;刻印取得のチェック
;=============================================================================
@MARK_GOT_CHECK
;従順変動判定用
LOCAL:2 = ABL:従順
;-------------------------------------------------
;反発刻印
;-------------------------------------------------
TFLAG:44 = 0
LOCAL = UP:20 + UP:21
;特定の素質を持たない助手プレイ中は刻印が付きやすい
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:魅惑 == 0 && TALENT:ASSI:謎の魅力 == 0 && TALENT:ASSI:小悪魔 == 0 && TALENT:ASSI:鼓舞 == 0
	TIMES LOCAL , 1.20
SELECTCASE LOCAL
	CASE IS < 500
		LOCAL:1 = 0
	CASE IS < 2000
		LOCAL:1 = 1
	CASE IS < 4000
		LOCAL:1 = 2
	CASEELSE
		LOCAL:1 = 3
ENDSELECT
;調教コマンドにより反発確定している場合
IF TFLAG:84 > LOCAL:1
	LOCAL:1 = TFLAG:84
	TFLAG:84 = 0
ENDIF
IF MARK:反発刻印 < LOCAL:1 && MARK:97 < LOCAL:1 && TFLAG:105 == 0
	TFLAG:44 = LOCAL:1
;HARD以上の場合、あまりに反感および不快を味合わせると履歴に関わらず反発３を取得
ELSEIF LOCAL >= 40000000 && FLAG:3 > 2 && TFLAG:105 == 0
	LOCAL:1 = 3
	TFLAG:44 = LOCAL:1
ENDIF
IF TFLAG:44
	CALL COMMON_MARK_UP, TARGET, 9, LOCAL:1, 0
	;感情乏しい、傀儡、精神崩壊、壊造人格の場合は反発刻印による従順ダウンはなし
	IF TALENT:感情乏しい == 0 && TALENT:精神崩壊 == 0 && TALENT:傀儡 == 0 && TALENT:壊造人格 == 0
		IF ABL:従順 > 0 && ABL:従順 <= 2 && TFLAG:44 == 3
			ABL:従順 = 0
		ELSEIF ABL:従順 == 3 && TFLAG:44 == 3
			ABL:従順 = 2
		ELSEIF ABL:従順 && ABL:従順 <= 2 && TFLAG:44 == 2
			ABL:従順 -= 1
		ENDIF
	ENDIF
ENDIF

;-------------------------------------------------
;苦痛刻印
;-------------------------------------------------
TFLAG:40 = 0
LOCAL = UP:16
;特定の素質を持たない助手プレイ中は刻印が付きづらい
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:魅惑 == 0 && TALENT:ASSI:謎の魅力 == 0 && TALENT:ASSI:小悪魔 == 0 && TALENT:ASSI:鼓舞 == 0
	TIMES LOCAL , 0.80
SELECTCASE LOCAL
	CASE IS < 500
		LOCAL:1 = 0
	CASE IS < 1500
		LOCAL:1 = 1
	CASE IS < 3000
		LOCAL:1 = 2
	CASEELSE
		LOCAL:1 = 3
ENDSELECT
;調教コマンドにより苦痛確定している場合
IF TFLAG:80 > LOCAL:1
	LOCAL:1 = TFLAG:80
	TFLAG:80 = 0
ENDIF
SIF MARK:苦痛刻印 < LOCAL:1
	TFLAG:40 = LOCAL:1
IF TFLAG:40
	CALL COMMON_MARK_UP, TARGET, 0, LOCAL:1, 0
	;気丈・感情乏しい、傀儡、精神崩壊の場合は苦痛刻印による従順アップはなし
	SIF ABL:従順 == 0 && TALENT:気丈 == 0 && TALENT:感情乏しい == 0 && TALENT:精神崩壊 == 0 && TALENT:傀儡 == 0 && TFLAG:40 >= 2
		ABL:従順 = 1
	;[サド]または[針さばき]の調教者
	IF (TALENT:PLAYER:サド || (TALENT:PLAYER:針さばき && SELECTCOM == 222)) && TFLAG:40 == 3
		;地の文表示のときは説明する
		IF CFLAG:9 & 2 && FLAG:10 & 1
			PRINTL 
			PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の\@(TALENT:PLAYER:針さばき && SELECTCOM == 222) ? 針さばき # サディスティックなプレイ\@による苦痛に対し拭えない恐怖が刻み込まれた…
		ENDIF
		TCVAR:異常経験 += 1
	ENDIF
ENDIF

;-------------------------------------------------
;快楽刻印
;-------------------------------------------------
TFLAG:41 = 0
LOCAL = UP:0 + UP:1 + UP:2 + UP:3
;特定の素質を持たない助手プレイ中は刻印が付きづらい
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:魅惑 == 0 && TALENT:ASSI:謎の魅力 == 0 && TALENT:ASSI:小悪魔 == 0 && TALENT:ASSI:鼓舞 == 0
	TIMES LOCAL , 0.80
SELECTCASE LOCAL
	CASE IS < 1000
		LOCAL:1 = 0
	CASE IS < 3000
		LOCAL:1 = 1
	CASE IS < 6000
		LOCAL:1 = 2
	CASEELSE
		LOCAL:1 = 3
ENDSELECT
;調教コマンドにより快楽確定している場合
IF TFLAG:81 > LOCAL:1
	LOCAL:1 = TFLAG:81
	TFLAG:81 = 0
ENDIF
SIF MARK:快楽刻印 < LOCAL:1
	TFLAG:41 = LOCAL:1
IF TFLAG:41
	CALL COMMON_MARK_UP, TARGET, 1, LOCAL:1, 0
	;自制心・感情乏しい、傀儡、精神崩壊の場合は快楽刻印による従順アップはなし
	SIF ABL:従順 == 0 && TALENT:自制心 == 0 && TALENT:感情乏しい == 0 && TALENT:精神崩壊 == 0 && TALENT:傀儡 == 0 && TFLAG:41 == 3
		ABL:従順 = 1
ENDIF

;-------------------------------------------------
;屈服刻印
;-------------------------------------------------
TFLAG:42 = 0
LOCAL = UP:14 + UP:15 / 20 + UP:16 / 20 + UP:17 / 5
;特定の素質を持たない助手プレイ中は刻印が付きづらい
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:魅惑 == 0 && TALENT:ASSI:謎の魅力 == 0 && TALENT:ASSI:小悪魔 == 0 && TALENT:ASSI:鼓舞 == 0
	TIMES LOCAL , 0.60
SELECTCASE LOCAL
	CASE IS < 1000
		LOCAL:1 = 0
	CASE IS < 2500
		LOCAL:1 = 1
	CASE IS < 5000
		LOCAL:1 = 2
	CASEELSE
		LOCAL:1 = 3
ENDSELECT
;調教コマンドにより屈服確定している場合
IF TFLAG:82 > LOCAL:1
	LOCAL:1 = TFLAG:82
	TFLAG:82 = 0
ENDIF
SIF MARK:屈服刻印 < LOCAL:1
	TFLAG:42 = LOCAL:1
IF TFLAG:42
	CALL COMMON_MARK_UP, TARGET, 2, LOCAL:1, 0
	;感情乏しい、傀儡、精神崩壊の場合は屈服刻印による従順アップはなし
	IF ABL:従順 < 1 && TALENT:感情乏しい == 0 && TALENT:精神崩壊 == 0 && TALENT:傀儡 == 0 && TFLAG:42 == 1
		ABL:従順 = 1
	ELSEIF ABL:従順 < 2 && TALENT:感情乏しい == 0 && TALENT:精神崩壊 == 0 && TALENT:傀儡 == 0 && TFLAG:42 >= 2
		ABL:従順 = 2
	ENDIF
ENDIF

;-------------------------------------------------
;恥辱刻印
;-------------------------------------------------
TFLAG:46 = 0
LOCAL = UP:15 + UP:14 / 10 + UP:13 / 20
;特定の素質を持たない助手プレイ中は刻印が付きづらい
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:魅惑 == 0 && TALENT:ASSI:謎の魅力 == 0 && TALENT:ASSI:小悪魔 == 0 && TALENT:ASSI:鼓舞 == 0
	TIMES LOCAL , 0.60
SIF UP:15 < 1000
	LOCAL = 0
SELECTCASE LOCAL
	CASE IS < 1000
		LOCAL:1 = 0
	CASE IS < 2500
		LOCAL:1 = 1
	CASE IS < 5000
		LOCAL:1 = 2
	CASEELSE
		LOCAL:1 = 3
ENDSELECT
;調教コマンドにより恥辱確定している場合
IF TFLAG:86 > LOCAL:1
	LOCAL:1 = TFLAG:86
	TFLAG:86 = 0
ENDIF
SIF MARK:恥辱刻印 < LOCAL:1
	TFLAG:46 = LOCAL:1
IF TFLAG:46
	CALL COMMON_MARK_UP, TARGET, 4, LOCAL:1, 0
	;感情乏しい、傀儡、精神崩壊、露出癖Lv3以上の場合は恥辱刻印による従順アップはなし
	SIF ABL:従順 < 1 && ABL:露出癖 >= 3 && TALENT:感情乏しい == 0 && TALENT:精神崩壊 == 0 && TALENT:傀儡 == 0 && TFLAG:46 == 3
		ABL:従順 += 1
ENDIF

;-------------------------------------------------
;恐怖刻印
;-------------------------------------------------
TFLAG:43 = 0
LOCAL = UP:17 + UP:16 / 50
;特定の素質を持たない助手プレイ中は刻印が付きづらい
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:魅惑 == 0 && TALENT:ASSI:謎の魅力 == 0 && TALENT:ASSI:小悪魔 == 0 && TALENT:ASSI:鼓舞 == 0
	TIMES LOCAL , 0.80
SELECTCASE LOCAL
	CASE IS < 1000
		LOCAL:1 = 0
	CASE IS < 2500
		LOCAL:1 = 1
	CASE IS < 5000
		LOCAL:1 = 2
	CASEELSE
		LOCAL:1 = 3
ENDSELECT
;調教コマンドにより恐怖確定している場合
IF TFLAG:83 > LOCAL:1
	LOCAL:1 = TFLAG:83
	TFLAG:83 = 0
ENDIF
IF MARK:恐怖刻印 < LOCAL:1 && MARK:96 < LOCAL:1 && TFLAG:105 == 0
	TFLAG:43 = LOCAL:1
;HARD以上の場合、あまりに苦痛および恐怖を味合わせると履歴に関わらず恐怖３を取得
ELSEIF LOCAL >= 50000000 && FLAG:3 > 2 && TFLAG:105 == 0
	LOCAL:1 = 3
	TFLAG:43 = LOCAL:1
ENDIF
IF TFLAG:43
	CALL COMMON_MARK_UP, TARGET, 8, LOCAL:1, 0
	;感情乏しい、傀儡、精神崩壊の場合は恐怖刻印による従順アップはなし
	IF ABL:従順 < 3 && TALENT:感情乏しい == 0 && TALENT:精神崩壊 == 0 && TALENT:傀儡 == 0 && TFLAG:43 == 3
		ABL:従順 += 1
		;臆病の場合一気に2上がる
		SIF TALENT:臆病
			ABL:従順 += 1
	ELSEIF ABL:従順 < 2 && TALENT:感情乏しい == 0 && TALENT:精神崩壊 == 0 && TALENT:傀儡 == 0 && TFLAG:43 == 2
		ABL:従順 += 1
	ENDIF
ENDIF

;-------------------------------------------------
;刻印取得による従順変動
;-------------------------------------------------
IF LOCAL:2 != ABL:従順
	PRINTFORML そして従順がLV{ABL:従順}になった
	CALL JUJUN_UP_CHECK
ENDIF
TFLAG:105 = 0

;=============================================================================
;パラメーター上昇値による追加処理
;=============================================================================
;-------------------------------------------------
;○○快楽経験のチェック
;-------------------------------------------------
@EXP_GOT_CHECK
;アナル系である、Ａ快楽のチェック
LOCAL = UP:2
LOCAL:1 = 0

;快Ａのパラ上昇を見る
SELECTCASE UP:2
	CASE IS < 300
		LOCAL = 0
	CASE IS < 1000
		LOCAL *= 1
	CASE IS < 5000
		LOCAL *= 2
	CASE IS < 10000
		LOCAL *= 3
	CASEELSE
		LOCAL *= 4
ENDSELECT

;難易度HARD以上のとき不快のパラ上昇を見る
IF FLAG:3 > 2
	SELECTCASE UP:21
		CASE IS < 300
			TIMES LOCAL , 1.00
		CASE IS < 1000
			TIMES LOCAL , 0.90
		CASE IS < 5000
			TIMES LOCAL , 0.80
		CASE IS < 10000
			TIMES LOCAL , 0.70
		CASEELSE
			TIMES LOCAL , 0.60
	ENDSELECT
ENDIF

SELECTCASE LOCAL
	CASE IS >= 12000
		LOCAL:1 = 5
		TIMES UP:14 , 1.20
		TIMES UP:20 , 0.80
		TIMES UP:21 , 0.90
	CASE IS >= 8000
		LOCAL:1 = 4
		TIMES UP:14 , 1.15
		TIMES UP:20 , 0.85
		TIMES UP:21 , 0.90
	CASE IS >= 5000
		LOCAL:1 = 3
		TIMES UP:14 , 1.10
		TIMES UP:20 , 0.85
		TIMES UP:21 , 0.95
	CASE IS >= 3000
		LOCAL:1 = 2
		TIMES UP:14 , 1.05
		TIMES UP:20 , 0.90
		TIMES UP:21 , 0.95
	CASE IS >= 2000
		LOCAL:1 = 1
		TIMES UP:14 , 1.00
		TIMES UP:20 , 0.90
		TIMES UP:21 , 1.00
	CASE IS >= 1000
		LOCAL:1 = 1
		TIMES UP:14 , 1.00
		TIMES UP:20 , 0.95
		TIMES UP:21 , 1.00
ENDSELECT
IF LOCAL:1
	TCVAR:Ａ快楽経験 += LOCAL:1
	TFLAG:62 = LOCAL:1
ENDIF

;バスト系である、Ｂ快楽のチェック
LOCAL = UP:3
LOCAL:1 = 0

;快Ｂのパラ上昇を見る
SELECTCASE UP:3
	CASE IS < 500
		LOCAL = 0
	CASE IS < 1000
		LOCAL *= 1
	CASE IS < 5000
		LOCAL *= 2
	CASE IS < 10000
		LOCAL *= 3
	CASEELSE
		LOCAL *= 4
ENDSELECT

;難易度HARD以上のとき不快のパラ上昇を見る
IF FLAG:3 > 2
	SELECTCASE UP:21
		CASE IS < 300
			TIMES LOCAL , 1.00
		CASE IS < 1000
			TIMES LOCAL , 0.90
		CASE IS < 5000
			TIMES LOCAL , 0.80
		CASE IS < 10000
			TIMES LOCAL , 0.70
		CASEELSE
			TIMES LOCAL , 0.60
	ENDSELECT
ENDIF

SELECTCASE LOCAL
	CASE IS >= 18000
		LOCAL:1 = 5
		TIMES UP:14 , 1.20
		TIMES UP:20 , 0.80
		TIMES UP:21 , 0.90
	CASE IS >= 12000
		LOCAL:1 = 4
		TIMES UP:14 , 1.15
		TIMES UP:20 , 0.85
		TIMES UP:21 , 0.90
	CASE IS >= 7500
		LOCAL:1 = 3
		TIMES UP:14 , 1.10
		TIMES UP:20 , 0.85
		TIMES UP:21 , 0.95
	CASE IS >= 5000
		LOCAL:1 = 2
		TIMES UP:14 , 1.05
		TIMES UP:20 , 0.90
		TIMES UP:21 , 0.95
	CASE IS >= 3000
		LOCAL:1 = 1
		TIMES UP:14 , 1.00
		TIMES UP:20 , 0.90
		TIMES UP:21 , 1.00
	CASE IS >= 1500
		LOCAL:1 = 1
		TIMES UP:14 , 1.00
		TIMES UP:20 , 0.95
		TIMES UP:21 , 1.00
ENDSELECT
IF LOCAL:1
	TCVAR:Ｂ快楽経験 += LOCAL:1
	TFLAG:63 = LOCAL:1
ENDIF

;奉仕系である、奉仕快楽のチェック
LOCAL = UP:0 + UP:1 + UP:2 + UP:3
LOCAL:1 = 0

;このターンに奉仕快楽系調教フラグが立っていなければ奉仕快楽経験は入らない
IF (TFLAG:100 & 1) == 0
	LOCAL = 0
ELSE
	;恭順のパラ上昇を見る
	SELECTCASE UP:12
		CASE IS < 250
			LOCAL /= 2
		CASE IS < 500
			LOCAL *= 1
		CASE IS < 1000
			LOCAL *= 2
		CASE IS < 2000
			LOCAL *= 3
		CASEELSE
			LOCAL *= 4
	ENDSELECT
ENDIF

;習得のパラ上昇を見る
SELECTCASE UP:11
	CASE IS < 250
		TIMES LOCAL , 0.30
	CASE IS < 500
		TIMES LOCAL , 0.50
	CASE IS < 1000
		TIMES LOCAL , 1.00
	CASE IS < 2000
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT

;難易度HARD以上のとき反感のパラ上昇を見る
IF FLAG:3 > 2
	SELECTCASE UP:20
		CASE IS < 300
			TIMES LOCAL , 1.00
		CASE IS < 1000
			TIMES LOCAL , 0.90
		CASE IS < 5000
			TIMES LOCAL , 0.80
		CASE IS < 10000
			TIMES LOCAL , 0.70
		CASEELSE
			TIMES LOCAL , 0.60
	ENDSELECT
ENDIF

SELECTCASE LOCAL
	CASE IS >= 18000
		LOCAL:1 = 16
		TIMES UP:20 , 0.65
		TIMES UP:21 , 0.30
	CASE IS >= 12000
		LOCAL:1 = 12
		TIMES UP:20 , 0.65
		TIMES UP:21 , 0.40
	CASE IS >= 8000
		LOCAL:1 = 8
		TIMES UP:20 , 0.70
		TIMES UP:21 , 0.50
	CASE IS >= 5000
		LOCAL:1 = 6
		TIMES UP:20 , 0.75
		TIMES UP:21 , 0.55
	CASE IS >= 3000
		LOCAL:1 = 4
		TIMES UP:20 , 0.80
		TIMES UP:21 , 0.60
	CASE IS >= 2000
		LOCAL:1 = 2
		TIMES UP:20 , 0.85
		TIMES UP:21 , 0.70
	CASE IS >= 1000
		LOCAL:1 = 1
		TIMES UP:20 , 0.90
		TIMES UP:21 , 0.80
ENDSELECT
IF LOCAL:1
	TCVAR:奉仕快楽経験 += LOCAL:1
	TFLAG:53 = LOCAL:1
ENDIF

;露出快楽のチェック
LOCAL = UP:0 + UP:1 + UP:2 + UP:3
LOCAL:1 = 0
;このターンに露出快楽系調教フラグが立っていなければ露出快楽経験は入らない
IF (TFLAG:100 & 2) == 0
	LOCAL:1 = 0
;恥情のパラ上昇を見る
ELSEIF LOCAL >= 20000 && UP:15 >= 3000
	LOCAL:1 = 16
	TIMES UP:32 , 0.40
ELSEIF LOCAL >= 10000 && UP:15 >= 2000
	LOCAL:1 = 12
	TIMES UP:32 , 0.50
ELSEIF LOCAL >= 8000 && UP:15 >= 1500
	LOCAL:1 = 8
	TIMES UP:32 , 0.60
ELSEIF LOCAL >= 5000 && UP:15 >= 1000
	LOCAL:1 = 4
	TIMES UP:32 , 0.75
ELSEIF LOCAL >= 2500 && UP:15 >= 500
	LOCAL:1 = 2
	TIMES UP:32 , 0.80
ELSEIF LOCAL >= 1000 && UP:15 >= 250
	LOCAL:1 = 1
	TIMES UP:32 , 0.90
ENDIF
IF LOCAL:1
	TCVAR:露出快楽経験 += LOCAL:1
	TFLAG:56 = LOCAL:1
ENDIF

;苦痛快楽のチェック
LOCAL = UP:0 + UP:1 + UP:2 + UP:3
LOCAL:1 = 0

;対象のマゾっ気Lvと苦痛のパラ上昇を見る
IF (ABL:マゾっ気 >= 5 || LOCAL >= 3000) && UP:16 >= 2000
	LOCAL:1 = 16
	TIMES UP:20 , 0.65
ELSEIF (ABL:マゾっ気 >= 5 || LOCAL >= 2500) && UP:16 >= 1500
	LOCAL:1 = 12
	TIMES UP:20 , 0.70
ELSEIF (ABL:マゾっ気 >= 4 || LOCAL >= 1500) && UP:16 >= 1000
	LOCAL:1 = 8
	TIMES UP:20 , 0.75
ELSEIF (ABL:マゾっ気 >= 4 || LOCAL >= 1000) && UP:16 >= 500
	LOCAL:1 = 4
	TIMES UP:20 , 0.80
ELSEIF (ABL:マゾっ気 >= 3 || LOCAL >= 600) && UP:16 >= 300
	LOCAL:1 = 2
	TIMES UP:20 , 0.85
ELSEIF (ABL:マゾっ気 >= 3 || LOCAL >= 300) && UP:16 >= 100
	LOCAL:1 = 1
	TIMES UP:20 , 0.90
ENDIF
IF LOCAL:1
	TCVAR:苦痛快楽経験 += LOCAL:1
	TFLAG:54 = LOCAL:1
ENDIF

;ＳＭ教育経験のチェック
LOCAL = TFLAG:55
IF LOCAL:1 == 16
	LOCAL *= 3
ELSEIF LOCAL:1 >= 8
	LOCAL *= 2
ENDIF
;ＳＭ教育経験は助手プレイの時か、Ｗスパンキング実行時で主人プレイの時、助手に加算される
IF LOCAL > 0 && (ASSIPLAY || (ASSIPLAY == 0 && SELECTCOM == 311))
	TCVAR:ASSI:ＳＭ教育経験 += LOCAL
	TFLAG:55 = LOCAL
ENDIF

;-------------------------------------------------
;連動パラメーターチェック
;-------------------------------------------------
;特定のパラメーターが大きく上昇しそうな場合、対応するパラメーターの上昇値に＋補正が入ったり
;既に溜まっている別のパラメーターが減少する処理
;対応項目
;屈服大幅上昇：抑鬱↑・先導↓
;恥情大幅上昇：屈服↑・恐怖↑
;恐怖大幅上昇：恭順↓・欲情↓
;抑鬱大幅上昇：欲情↓・恥情↑
;侵蝕大幅上昇：屈服↑・恐怖↑
;先導大幅上昇：欲情↑・屈服↓
@VARIABLE_PALAM_CHECK
;屈服
SELECTCASE UP:14
	CASE IS >= 50000
		TIMES UP:22 , 1.40
		LOCAL = PALAM:先導 / 4
		LOCAL += 3000
	CASE IS >= 10000
		TIMES UP:22 , 1.20
		LOCAL = PALAM:先導 / 5
		LOCAL += 500
	CASE IS >= 3000
		TIMES UP:22 , 1.10
		LOCAL = PALAM:先導 / 10
		LOCAL += 100
	CASEELSE
		LOCAL = 0
ENDSELECT
DOWN:32 += LOCAL

;恥情
SELECTCASE UP:15
	CASE IS >= 50000
		TIMES UP:14 , 1.40
		TIMES UP:17 , 1.40
	CASE IS >= 10000
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.20
	CASE IS >= 3000
		TIMES UP:14 , 1.10
		TIMES UP:17 , 1.10
ENDSELECT

;恐怖
SELECTCASE UP:17
	CASE IS >= 50000
		LOCAL = PALAM:恭順 / 4
		LOCAL:1 = PALAM:欲情 / 4
		LOCAL += 3000
		LOCAL:1 += 3000
	CASE IS >= 10000
		LOCAL = PALAM:恭順 / 5
		LOCAL:1 = PALAM:欲情 / 5
		LOCAL += 500
		LOCAL:1 += 500
	CASE IS >= 3000
		LOCAL = PALAM:恭順 / 10
		LOCAL:1 = PALAM:欲情 / 10
		LOCAL += 100
		LOCAL:1 += 100
	CASEELSE
		LOCAL = 0
		LOCAL:1 = 0
ENDSELECT
DOWN:12 += LOCAL
DOWN:13 += LOCAL:1

;抑鬱
SELECTCASE UP:22
	CASE IS >= 50000
		LOCAL = PALAM:欲情 / 4
		TIMES UP:15 , 1.40
		LOCAL += 3000
	CASE IS >= 10000
		LOCAL = PALAM:欲情 / 5
		TIMES UP:15 , 1.20
		LOCAL += 500
	CASE IS >= 3000
		LOCAL = PALAM:欲情 / 10
		TIMES UP:15 , 1.10
		LOCAL += 100
	CASEELSE
		LOCAL = 0
ENDSELECT
DOWN:13 += LOCAL

;侵蝕
SELECTCASE UP:31
	CASE IS >= 50000
		TIMES UP:14 , 1.40
		TIMES UP:17 , 1.40
	CASE IS >= 10000
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.20
	CASE IS >= 3000
		TIMES UP:14 , 1.10
		TIMES UP:17 , 1.10
ENDSELECT

;先導
SELECTCASE UP:32
	CASE IS >= 50000
		TIMES UP:13 , 1.40
		LOCAL = PALAM:屈服 / 4
		LOCAL += 3000
	CASE IS >= 10000
		TIMES UP:13 , 1.20
		LOCAL = PALAM:屈服 / 5
		LOCAL += 500
	CASE IS >= 3000
		TIMES UP:13 , 1.10
		LOCAL = PALAM:屈服 / 10
		LOCAL += 100
	CASEELSE
		LOCAL = 0
ENDSELECT
DOWN:14 += LOCAL

;-------------------------------------------------
;酒酔いチェック(パラメータ関連は調教対象のみ)
;-------------------------------------------------
;絶頂における酔いの深度アップと酔いによるパラメーター変化の処理をここで行う
;補正は酔いが浅いと欲情が上がりやすく、反感が上がりにくい
;補正は酔いが深いと不快が上がり、欲情が下がる。また薬毒と侵蝕が上がりやすい
;酔いが深まるにつれ、体力・気力の消耗も大きくなる
@ALCOHOL_DRUNK_CHECK, ARG
;調教対象のみ○絶頂で酔いの深度が微弱上昇
IF ARG == TARGET
	LOCAL = 0
	LOCAL:1 = 0
	REPEAT 4
		IF NOWEX:COUNT
			LOCAL += NOWEX:COUNT
			LOCAL:1 += 1
		ENDIF
	REND
	SELECTCASE LOCAL:1
		CASE 0
			LOCAL *= 1
		CASE 1
			LOCAL *= 2
		CASE 2
			LOCAL *= 4
		CASE 3
			LOCAL *= 7
		CASEELSE
			LOCAL *= 10
	ENDSELECT
	BASE:ARG:酔い += LOCAL
ENDIF

;酔いにおけるパラメーター上昇下降補正
SELECTCASE (BASE:ARG:酔い *100) / MAXBASE:ARG:8
	CASE IS < 40
		;微酔
		LOCAL = 110
		IF ARG == TARGET
			TIMES DOWNBASE:ARG:9, 1.20
			TIMES UP:13 , 1.20
			TIMES UP:20 , 0.80
		ENDIF
	CASE IS < 80
		;酩酊
		LOCAL = 120
		IF ARG == TARGET
			TIMES DOWNBASE:ARG:9, 1.40
			TIMES UP:13 , 1.50
			TIMES UP:20 , 0.70
		ENDIF
	CASE IS < 120
		;泥酔
		LOCAL = 150
		IF ARG == TARGET
			TIMES DOWNBASE:ARG:9, 1.60
			TIMES UP:13 , 1.20
			TIMES UP:21 , 1.20
			TIMES UP:30 , 1.10
			DOWN:13 += 1000
		ENDIF
	CASE IS < 160
		;狂酔
		LOCAL = 180
		IF ARG == TARGET
			TIMES DOWNBASE:ARG:9, 1.80
			TIMES UP:21 , 1.50
			TIMES UP:30 , 1.20
			UP:31 +=1000
			DOWN:13 += 5000
		ENDIF
	CASEELSE
		;極酔
		LOCAL = 250
		IF ARG == TARGET
			TIMES DOWNBASE:ARG:9, 2.00
			TIMES UP:21 , 2.50
			TIMES UP:30 , 1.50
			UP:31 +=5000
			DOWN:13 += 10000
		ENDIF
ENDSELECT

;機械・鬼・黄昏の怪物
SIF TALENT:ARG:機械 || TALENT:ARG:鬼 || TALENT:ARG:黄昏の怪物
	LOCAL = 100
;河童・天狗
SIF (TALENT:ARG:河童 || TALENT:ARG:天狗) && LOCAL > 120
	LOCAL = 120

;酔いにおける体力・気力の消耗増加
IF LOCAL != 100
	REPEAT 2
		DOWNBASE:ARG:COUNT *= LOCAL
		DOWNBASE:ARG:COUNT /= 100
	REND
ENDIF

;-------------------------------------------------
;素質[爆発物]の引火及び引火判定処理
;-------------------------------------------------
;絶頂を迎えた、あるいは一定量以上の苦痛を受けたとき判定を行う。
;爆発すると調教に居合わせた面子全員の体力が激減する
@TRAIN_EXPLOSION_CHECK
;調教者が製作者のときは無条件で爆発しない。ただしアリスはEX化していないときのみ
;また、製作者番号が500のときは「あなた」が製作者
SIF (NO:PLAYER == TALENT:爆発物 && ((NO:PLAYER == 1014 && CFLAG:PLAYER:0 == 0) || NO:PLAYER != 1014)) || (NO:PLAYER == 1000 && TALENT:爆発物 == 500)
	RETURN 0

LOCAL = 0
REPEAT 4
	;潤滑が20000以下の時、Ｃ・Ｖ・Ａ・Ｂのいずれかの絶頂を迎えた場合
	SIF PALAM:潤滑 <= 20000 && NOWEX:COUNT > 0
		LOCAL += (NOWEX:COUNT == 1) ? 150 # 300
	;潤滑が10000以下で、入浴中でなく、シャワーも浴びていない時、噴乳・射精・放尿・精飲のいずれかの絶頂を迎えた場合
	SIF PALAM:潤滑 <= 10000 && TEQUIP:シャワープレイ == 0 && TEQUIP:特殊風呂入浴中 == 0 && NOWEX:(10+COUNT)
		LOCAL += 200
REND
;苦痛が10000以上上昇した、あるいは気力が最大値の半分以下の時に苦痛が3000以上上昇した場合
SIF UP:16 >= 10000 || (BASE:気力 <= MAXBASE:1 / 2 && UP:16 >= 3000)
	LOCAL += 1000
;[解放]もなく、露出癖がLv3未満で野外プレイまたはビデオ撮影中、恥情が10000以上になったあるいは恥情が2000以上上昇した場合
SIF TALENT:解放 == 0 && ABL:露出癖 < 3 && (TEQUIP:ビデオ撮影 || TEQUIP:野外プレイ) && (PALAM:恥情 >= 10000 || UP:15 >= 2000)
	LOCAL += 200
;反発刻印があるとダメージ悪化
SELECTCASE MARK:反発刻印
	CASE 1
		TIMES LOCAL , 1.25
	CASE 2
		TIMES LOCAL , 1.50
	CASE 3
		TIMES LOCAL , 2.00
ENDSELECT
;以上の条件を満たす場合、爆発処理に移行
IF LOCAL > 0
	SETCOLOR COLOR("P-RED")
	PRINTFORML ――強い刺激により%CALLNAME:TARGET%は爆発しました――
	RESETCOLOR
	IF (CFLAG:20 & 8192) == 0
		CFLAG:20 |= 8192
		CALL COMMON_UP_EXP, TARGET, 50, 1, 0, 2
	ENDIF
	;実績
	LOADGLOBAL
	SIF !(GLOBAL:2300 & 256)
		GLOBAL:2300 |= 256
	SAVEGLOBAL
	DOWNBASE:0 += LOCAL
	DOWNBASE:1 += LOCAL/2
	DOWNBASE:9 += LOCAL * 3 / 2
	DOWNBASE:MASTER:0 += LOCAL
	DOWNBASE:MASTER:1 += LOCAL/2
	IF ASSI >= 0
		DOWNBASE:ASSI:0 += LOCAL
		DOWNBASE:ASSI:1 += LOCAL/2
	ENDIF
ENDIF

;-------------------------------------------------
;お香処理
;-------------------------------------------------
;野外プレイ、お風呂場プレイ、特殊風呂プレイ中は呼び出されない
@TRAIN_INCENCE
;………………………………………………
;体力消費軽減(シダーウッド・フランキンセンス)
;………………………………………………
IF TEQUIP:89 == 1 || TEQUIP:89 == 6
	TIMES DOWNBASE:0 , 0.90
	TIMES DOWNBASE:9 , 0.95
	TIMES DOWNBASE:MASTER:0 , 0.90
	SIF ASSI >= 0
		TIMES DOWNBASE:ASSI:0 , 0.90
ENDIF
;………………………………………………
;気力消費軽減(ペパーミント・フランキンセンス)
;………………………………………………
IF TEQUIP:89 == 2 || TEQUIP:89 == 6
	TIMES DOWNBASE:1 , 0.90
	TIMES DOWNBASE:9 , 0.95
	TIMES DOWNBASE:MASTER:1 , 0.90
	SIF ASSI >= 0
		TIMES DOWNBASE:ASSI:1 , 0.90
ENDIF
;………………………………………………
;ネガティブパラメーターの上昇量を軽減(ラヴェンダー・フランキンセンス)
;………………………………………………
IF TEQUIP:89 == 4 || TEQUIP:89 == 6
	TIMES UP:20 , 0.80
	TIMES UP:21 , 0.80
	TIMES UP:22 , 0.80
ENDIF
;………………………………………………
;習得、薬毒、侵蝕パラメーターの上昇量を増加(触手豊穣淫香)
;………………………………………………
IF TEQUIP:89 == 99
	TIMES UP:11 , 1.20
	TIMES UP:30 , 1.20
	TIMES UP:31 , 1.20
ENDIF

;-------------------------------------------------
;[Debug]のチェック
;-------------------------------------------------
@DEBUG_CHECK
LOCAL = 0
SIF DEBUG_ABL_CHECK1(0, 0)
	LOCAL |= 1
SIF DEBUG_ABL_CHECK1(1, 1)
	LOCAL |= 2
SIF DEBUG_ABL_CHECK1(2, 2)
	LOCAL |= 4
SIF DEBUG_ABL_CHECK1(3, 3)
	LOCAL |= 8
SIF DEBUG_ABL_CHECK1(12, 10)
	LOCAL |= 16
SIF DEBUG_ABL_CHECK1(13, 11)
	LOCAL |= 32
SIF DEBUG_ABL_CHECK1(11, 12)
	LOCAL |= 64
SIF DEBUG_ABL_CHECK2(14, 13, 10)
	LOCAL |= 128
SIF DEBUG_ABL_CHECK2(15, 14, 11)
	LOCAL |= 256
SIF DEBUG_ABL_CHECK2(32, 20, 11)
	LOCAL |= 512
SIF DEBUG_ABL_CHECK2(16, 21, 11)
	LOCAL |= 1024
IF TALENT:オトコ == 0
	SIF DEBUG_ABL_CHECK3(12, 22, 11)
		LOCAL |= 2048
ELSE
	SIF DEBUG_ABL_CHECK3(13, 23, 11)
		LOCAL |= 4096
ENDIF

SIF LOCAL == 0
	RETURN 0
;Ｃ感覚上昇
SIF LOCAL & 1
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 0
;Ｖ感覚上昇
SIF LOCAL & 2
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 1
;Ａ感覚上昇
SIF LOCAL & 4
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 2
;Ｂ感覚上昇
SIF LOCAL & 8
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 3
;従順Lv上昇
SIF LOCAL & 16
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 10
;欲望Lv上昇
SIF LOCAL & 32
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 11
;技巧Lv上昇
SIF LOCAL & 64
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 12
;奉仕精神Lv上昇
SIF LOCAL & 128
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 13
;露出癖Lv上昇
SIF LOCAL & 256
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 14
;サドっ気Lv上昇
SIF LOCAL & 512
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 20
;マゾっ気Lv上昇
SIF LOCAL & 1024
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 21
;レズっ気Lv上昇
SIF LOCAL & 2048
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 22
;ＢＬっ気Lv上昇
SIF LOCAL & 4096
	CALL DEBUG_CHECK_DISPLAY_DIALOG, 23

;………………………………………………
;[Debug]のチェック能力上昇・表示処理
;………………………………………………
@DEBUG_CHECK_DISPLAY_DIALOG, ARG
ABL:ARG += 1
PRINTFORML %ABLNAME:ARG%LV{ABL:ARG}になった

;………………………………………………
;[Debug]のチェック処理用計算式中関数群
;………………………………………………
@DEBUG_ABL_CHECK1(ARG, ARG:1)
#FUNCTION
IF UP:ARG > 1 && ABL:(ARG:1) < 1
	RETURNF 1
ELSEIF UP:ARG > 30 && ABL:(ARG:1) < 2
	RETURNF 1
ELSEIF UP:ARG > 60 && ABL:(ARG:1) < 3
	RETURNF 1
ELSEIF UP:ARG > 200 && ABL:(ARG:1) < 4
	RETURNF 1
ELSEIF UP:ARG > 1000 && ABL:(ARG:1) < 5
	RETURNF 1
ENDIF
RETURNF 0

@DEBUG_ABL_CHECK2(ARG, ARG:1, ARG:2)
#FUNCTION
IF UP:ARG > 1 && ABL:(ARG:1) < 1 && ABL:(ARG:2) >= 1
	RETURNF 1
ELSEIF UP:ARG > 30 && ABL:(ARG:1) < 2 && ABL:(ARG:2) >= 2
	RETURNF 1
ELSEIF UP:ARG > 60 && ABL:(ARG:1) < 3 && ABL:(ARG:2) >= 3
	RETURNF 1
ELSEIF UP:ARG > 200 && ABL:(ARG:1) < 4 && ABL:(ARG:2) >= 4
	RETURNF 1
ELSEIF UP:ARG > 1000 && ABL:(ARG:1) < 5 && ABL:(ARG:2) >= 5
	RETURNF 1
ENDIF
RETURNF 0

@DEBUG_ABL_CHECK3(ARG, ARG:1, ARG:2)
#FUNCTION
IF UP:ARG > 1 && ABL:(ARG:1) < 1 && ABL:(ARG:2) >= 1
	RETURNF 1
ELSEIF UP:ARG > 5 && ABL:(ARG:1) < 2 && ABL:(ARG:2) >= 2
	RETURNF 1
ELSEIF UP:ARG > 20 && ABL:(ARG:1) < 3 && ABL:(ARG:2) >= 3
	RETURNF 1
ELSEIF UP:ARG > 40 && ABL:(ARG:1) < 4 && ABL:(ARG:2) >= 4
	RETURNF 1
ELSEIF UP:ARG > 100 && ABL:(ARG:1) < 5 && ABL:(ARG:2) >= 5
	RETURNF 1
ENDIF
RETURNF 0

;=============================================================================
;パニック処理関連
;=============================================================================
;そのうち実装する予定
;パニック状態になると「強制以外の奉仕系コマンド」や「自慰」が実行できなくなる
;-------------------------------------------------
;パニック状態の有効期間決定(素質により長短が変化)
;-------------------------------------------------
@PANIC_CHECK
#LOCALSIZE 1
;UP:恐怖をみる
SELECTCASE UP:17
	CASE IS < 500
		RETURN 0
	CASE IS < 1000
		LOCAL = 50
	CASE IS < 2500
		LOCAL = 100
	CASE IS < 5000
		LOCAL = 150
	CASE IS < 10000
		LOCAL = 200
	CASE IS < 50000
		LOCAL = 300
	CASEELSE
		LOCAL = 500
ENDSELECT
;UP:恥情をみる
SELECTCASE UP:13
	CASE IS < 1000
		TIMES LOCAL , 1.00
	CASE IS < 2500
		TIMES LOCAL , 1.20
	CASE IS < 5000
		TIMES LOCAL , 1.40
	CASE IS < 10000
		TIMES LOCAL , 1.60
	CASE IS < 50000
		TIMES LOCAL , 1.80
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT

;PALAM:恭順をみる
SELECTCASE PALAM:恭順
	CASE IS < PALAMLV:1
		TIMES LOCAL , 1.25
	CASE IS < PALAMLV:2
		TIMES LOCAL , 1.00
	CASE IS < PALAMLV:3
		TIMES LOCAL , 0.75
	CASE IS < PALAMLV:4
		TIMES LOCAL , 0.50
	CASEELSE
		TIMES LOCAL , 0.25
ENDSELECT
;PALAM:恥情をみる
SELECTCASE PALAM:欲情
	CASE IS < PALAMLV:1
		TIMES LOCAL , 0.25
	CASE IS < PALAMLV:2
		TIMES LOCAL , 0.50
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.00
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.20
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT
;PALAM:恐怖をみる
SELECTCASE PALAM:恐怖
	CASE IS < PALAMLV:1
		TIMES LOCAL , 0.10
	CASE IS < PALAMLV:2
		TIMES LOCAL , 0.50
	CASE IS < PALAMLV:3
		TIMES LOCAL , 1.00
	CASE IS < PALAMLV:4
		TIMES LOCAL , 1.50
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT
;PALAM:抑鬱をみる
SELECTCASE PALAM:抑鬱
	CASE IS < PALAMLV:1
		TIMES LOCAL , 1.20
	CASE IS < PALAMLV:2
		TIMES LOCAL , 1.00
	CASE IS < PALAMLV:3
		TIMES LOCAL , 0.50
	CASE IS < PALAMLV:4
		TIMES LOCAL , 0.25
	CASEELSE
		TIMES LOCAL , 0.10
ENDSELECT

;残り体力の割合をみる
SELECTCASE (BASE:体力 * 100) / MAXBASE:0
	CASE IS < 20
		TIMES LOCAL , 0.50
	CASE IS < 40
		TIMES LOCAL , 0.75
	CASE IS < 60
		TIMES LOCAL , 1.00
	CASE IS < 80
		TIMES LOCAL , 1.25
	CASEELSE
		TIMES LOCAL , 1.50
ENDSELECT
;残り気力の割合をみる
SELECTCASE (BASE:気力 * 100) / MAXBASE:1
	CASE IS < 20
		TIMES LOCAL , 1.50
	CASE IS < 40
		TIMES LOCAL , 1.25
	CASE IS < 60
		TIMES LOCAL , 1.00
	CASE IS < 80
		TIMES LOCAL , 0.75
	CASEELSE
		TIMES LOCAL , 0.50
ENDSELECT

;パニックに陥る
IF LOCAL >= 100
	CALL DISPLAY_KOJO_MESSAGE_SUB_EVENT, TARGET, 5, 1
	PRINTFORMW %CALLNAME:TARGET%は恐怖のあまりパニックを起こした
	TFLAG:108 = LOCAL / 10
ENDIF

;-------------------------------------------------
;時間経過によるパニックからの回復処理
;-------------------------------------------------
@PANIC_SANITY
#LOCALSIZE 1
;回復基礎値
LOCAL = 10
;臆病
SIF TALENT:臆病
	TIMES LOCAL , 0.50
;気丈
SIF TALENT:自制心
	TIMES LOCAL , 1.50
;大人しい
SIF TALENT:大人しい
	TIMES LOCAL , 1.20
;自制心
SIF TALENT:自制心
	TIMES LOCAL , 1.50
;狂気
SIF TALENT:狂気
	TIMES LOCAL , 0.75

;UP:恐怖をみる
SELECTCASE UP:17
	CASE IS < 100
		TIMES LOCAL , 1.50
	CASE IS < 1000
		TIMES LOCAL , 1.00
	CASE IS < 3000
		TIMES LOCAL , 0.75
	CASE IS < 6000
		TIMES LOCAL , 0.50
	CASE IS < 10000
		TIMES LOCAL , 0.25
	CASE IS < 30000
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

LOCAL = MAX(LOCAL, 0)
TFLAG:108 = MAX(TFLAG:108 - LOCAL, 0)
IF TFLAG:108 == 0
	CALL DISPLAY_KOJO_MESSAGE_SUB_EVENT, TARGET, 5, 0
	PRINTFORMW %CALLNAME:TARGET%はパニックからなんとか立ち直れたようだ
ENDIF

;-------------------------------------------------
;パニック状態下での補正
;-------------------------------------------------
@PANIC_CALC
TIMES DOWNBASE:0 , 1.20
TIMES DOWNBASE:1 , 1.50
TIMES DOWNBASE:9 , 2.00

TIMES UP:11 , 0.80
TIMES UP:12 , 0.80
TIMES UP:17 , 1.20
TIMES UP:21 , 1.20
TIMES UP:22 , 0.50
TIMES UP:31 , 0.80
TIMES UP:32 , 0.50

;パニック解除判定処理へ
CALL PANIC_SANITY

;=============================================================================
;失神処理関連
;=============================================================================
;--------------------------------------------------
;失神するかどうかチェックし、条件を満たせば失神する
;--------------------------------------------------
@PASSOUT_CHECK
;絶頂失神・苦痛失神・恐怖失神が起こる確率に使うためのLOCALを設定し、RAND:LOCALの形で使う
;最初はRAND:3で、調教失神経験が増えてくるとLOCALの数値が増えてRAND:LOCALの確率は少なくなる。RAND:6でストップ
;要するに、調教失神経験が増えてくると失神しにくくなってくる
LOCAL = MIN((EXP:調教失神経験 / 10 + 3) , 6)

;………………………………
;絶頂失神チェック
;………………………………
;激しい絶頂を２ターン以上連続で起こすと、ランダムで失神
IF TFLAG:51 >= 7
	;TFLAG:897の1ビットで連続かどうかを管理
	IF (TFLAG:897 & 1) == 0
		TFLAG:897 |= 1
	ELSEIF (TFLAG:897 & 1) && RAND:LOCAL == 0
		;絶頂失神したフラグを立てる。失神回復時に使用
		TFLAG:897 |= 2
	ENDIF
;連続が途切れたらまた数え直す
ELSE
	TFLAG:897 &= 1
ENDIF

;………………………………
;苦痛失神チェック
;………………………………
;一度に10000以上の苦痛を受けると、ランダムで失神
IF UP:16 >= 10000 && RAND:LOCAL == 0
	;苦痛失神したフラグを立てる。失神回復時に使用
	TFLAG:897 |= 4
	TFLAG:895 = UP:16
ENDIF

;………………………………
;恐怖失神チェック
;………………………………
;一度に10000以上の恐怖を受けると、ランダムで失神
IF UP:17 >= 10000 && RAND:LOCAL == 0
	;恐怖失神したフラグを立てる。失神回復時に使用
	TFLAG:897 |= 8
	TFLAG:896 = UP:17
ENDIF

;………………………………
;スタンガン失神チェック
;………………………………
;スタンガンを受けるとランダムで失神
IF SELECTCOM == 238 && RAND:10 < 8 && (!EQUIP:戦闘中 || !TFLAG:552)
	;スタンガン失神したフラグを立てる。失神回復時に使用
	TFLAG:897 |= 16
ENDIF

;………………………………
;失神する時の処理
;………………………………
;絶頂・苦痛・恐怖・スタンガン失神チェックの少なくとも１つに引っかかったら失神する
IF (TFLAG:897 & 2) || (TFLAG:897 & 4) || (TFLAG:897 & 8) || (TFLAG:897 & 16)
    SETCOLOR COLOR("P-RED")
	PRINTL 失神
	RESETCOLOR
	;失神経験
	TCVAR:調教失神経験 += 1
	;失神中フラグを立てる
	TFLAG:899 = 1
	;失神時にＶ挿入されていなければTFLAGの値を-1にする
	SIF TFLAG:9 != 1
		TFLAG:869 = -1
	;失神時にＡ挿入されていなければTFLAGの値を-1にする
	SIF TFLAG:9 != 2
		TFLAG:870 = -1
	;失神時にＶ装着器具を装着していなければTFLAGの値を-1にする
	SIF TEQUIP:Ｖ系装着器具 == 0
		TFLAG:871 = -1
	;失神時にＡ装着器具を装着していなければTFLAGの値を-1にする
	SIF TEQUIP:Ａ系装着器具 == 0
		TFLAG:872 = -1
	;失神時にＣ装着器具を装着していなければTFLAGの値を-1にする
	SIF TEQUIP:Ｃ系装着器具 == 0
		TFLAG:873 = -1
	;失神時にＢ装着器具を装着していなければTFLAGの値を-1にする
	SIF TEQUIP:Ｂ系装着器具 == 0
		TFLAG:874 = -1
	;失神時に緊縛されていなければTFLAGの値を-1にする
	SIF TEQUIP:緊縛関連 == 0
		TFLAG:875 = -1
	;失神時に目隠しされていなければTFLAGの値を-1にする
	SIF TEQUIP:目装着器具 == 0
		TFLAG:876 = -1
	;失神時に口枷をつけられていなければTFLAGの値を-1にする
	SIF TEQUIP:三角木馬乗馬中 == 0
		TFLAG:877 = -1
	;失神時に媚薬を投与されていなければTFLAGの値を-1にする
	SIF TEQUIP:媚薬 == 0
		TFLAG:878 = -1
	;失神時に触手が召喚されていなければTFLAGの値を-1にする
	SIF TEQUIP:触手調教 == 0
		TFLAG:879 = -1
	;失神時にビデオ撮影されていなければTFLAGの値を-1にする
	SIF TEQUIP:ビデオ撮影 == 0
		TFLAG:880 = -1
	;野外プレイ中に失神した場合は家に帰る
	IF TEQUIP:野外プレイ
		;野外プレイ解除
		TEQUIP:野外プレイ = 0
		TFLAG:150 = 0
		TFLAG:151 = 0
		;時間も少しだけ進行
		TFLAG:107 += 2
		PRINTL 
		PRINTFORMW %CALLNAME:TARGET%が失神したため、部屋に戻ることにした…
		;調教者の体力・気力が若干減少
		BASE:PLAYER:体力 = MAX(BASE:PLAYER:体力 - 20, 0)
		BASE:PLAYER:気力 = MAX(BASE:PLAYER:気力 - 10, 0)
	ENDIF
	;パニック状態は解除
	TFLAG:108 = 0
ENDIF

;-------------------------------------------------
;失神したターンの次のターン以降の処理
;-------------------------------------------------
@PASSOUT_DURING
;失神しているターン数を+1
TFLAG:899 += 1
;TFLAG:866に失神中の触手の射精量を記録
TFLAG:866 += TFLAG:37
;TFLAG:868に失神中に処女喪失したかを記録
SIF TFLAG:0
	TFLAG:868 = 1
;失神回復するかどうかチェックし、条件を満たせば失神回復する
CALL PASSOUT_WAKE

;-------------------------------------------------
;失神回復するかどうかチェックし、条件を満たせば失神回復する
;-------------------------------------------------
@PASSOUT_WAKE
;失神回復チェック
;失神中に強烈な絶頂・一度に10000以上の苦痛を受ける・3回以上コマンド実行＋ランダムのいずれかで失神から回復
IF TFLAG:51 >= 7 || UP:16 >= 10000 || (TFLAG:899 >= 4 && RAND:2 == 0)
    SETCOLOR COLOR("P-RED")
	PRINTL 失神から回復
	RESETCOLOR
	;失神回復フラグを立てる
	TFLAG:898 = 1
	;失神中フラグをリセット
	TFLAG:899 = 0
	;TFLAG:850=失神中にＶＡ以外の場所にぶっかけた場合に、ぶっかけた場所の数。TFLAG:850 >= 3なら失神中にＶＡ以外の３箇所にぶっかけたことになる
	TFLAG:850 = 0
	FOR PC_VAR1, 853, 865
		SIF TFLAG:PC_VAR1 > 0
			TFLAG:850 += 1
	NEXT

	;失神中にＶ挿入され、その状態で目覚めた
	SIF TFLAG:869 == -1 && TFLAG:9 == 1
		TFLAG:869 = 1
	;失神中にＶ挿入され、その状態で目覚めた
	SIF TFLAG:870 == -1 && TFLAG:9 == 2
		TFLAG:870 = 1
	;失神中にＶ装着器具をつけられ、その状態で目覚めた
	SIF TFLAG:871 == -1 && TEQUIP:Ｖ系装着器具 > 0
		TFLAG:871 = 1
	;失神中にＡ装着器具をつけられ、その状態で目覚めた
	SIF TFLAG:872 == -1 && TEQUIP:Ａ系装着器具 > 0
		TFLAG:872 = 1
	;失神中にＣ装着器具をつけられ、その状態で目覚めた
	SIF TFLAG:873 == -1 && TEQUIP:Ｃ系装着器具 > 0
		TFLAG:873 = 1
	;失神中にＢ装着器具をつけられ、その状態で目覚めた
	SIF TFLAG:874 == -1 && TEQUIP:Ｂ系装着器具 > 0
		TFLAG:874 = 1
	;失神中に緊縛され、その状態で目覚めた
	SIF TFLAG:875 == -1 && TEQUIP:緊縛関連 > 0
		TFLAG:875 = 1
	;失神中に目隠しされ、その状態で目覚めた
	SIF TFLAG:876 == -1 && TEQUIP:目装着器具 > 0
		TFLAG:876 = 1
	;失神中に口枷をつけられ、その状態で目覚めた
	SIF TFLAG:877 == -1 && TEQUIP:口装着器具 > 0
		TFLAG:877 = 1
	;失神中に媚薬を投与され、その状態で目覚めた(注射で投与可能)
	SIF TFLAG:878 == -1 && TEQUIP:媚薬 == 1
		TFLAG:878 = 1
	;失神中に触手が召喚され、その状態で目覚めた
	SIF TFLAG:879 == -1 && TEQUIP:触手調教 > 0
		TFLAG:879 = 1
	;失神中にビデオ撮影され、その状態で目覚めた
	SIF TFLAG:880 == -1 && TEQUIP:ビデオ撮影 > 0
		TFLAG:880 = 1

	;絶頂失神した場合、目覚めた時に屈服・恥情が発生
	IF TFLAG:897 & 2
		;屈服
		UP:14 += 2000
		;恥情
		UP:15 += 2000
	ENDIF
	;苦痛失神した場合、その苦痛の量に応じ、目覚めた時に屈服・恐怖・反感・不快が発生
	IF TFLAG:897 & 4
		LOCAL = TFLAG:895
		UP:14 += LOCAL / 12
		UP:17 += LOCAL / 12
		UP:20 += LOCAL / 12
		UP:21 += LOCAL / 12
	ENDIF
	;恐怖失神した場合、その恐怖の量に応じ、目覚めた時に屈服・恐怖・反感・不快が発生
	IF TFLAG:897 & 8
		LOCAL:1 = TFLAG:896
		UP:14 += LOCAL:1 / 14
		UP:17 += LOCAL:1 / 8
		UP:20 += LOCAL:1 / 10
		UP:21 += LOCAL:1 / 10
	ENDIF
	;スタンガン失神した場合、目覚めた時に恐怖・反感・不快が発生
	IF TFLAG:897 & 16
		UP:17 += 1000
		UP:20 += 1500
		UP:21 += 1000
	ENDIF

	;失神中にＶＡ以外の３箇所以上にぶっかけられた
	IF TFLAG:850 >= 3
		TIMES UP:14 , 1.20
		;精液中毒が高いと欲情加算
		IF ABL:精液中毒 >= 5
			UP:13 += 4000
		ELSEIF ABL:精液中毒 >= 3
			UP:13 += 2000
		ENDIF
		;恋慕でも淫乱でもないと反感・不快
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;失神中に膣内に射精された
	IF TFLAG:851 > 0
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.20
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;失神中にアナルに射精された
	IF TFLAG:852 > 0
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.20
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;失神中に触手に射精された
	IF TFLAG:866 > 0
		TIMES UP:14 , 1.20
		TIMES UP:31 , 1.20
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0 && ABL:触手中毒 < 3
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;失神中に処女喪失した
	IF TFLAG:868 > 0
		TIMES UP:17 , 2.00
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.30
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;目覚めるとＶ挿入されていた
	IF TFLAG:869 > 0
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.20
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;目覚めるとＡ挿入されていた
	IF TFLAG:870 > 0
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.20
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;目覚めるとＶＡＣＢに器具を装着させられていた
	FOR PC_VAR1, 871, 875
		IF TFLAG:PC_VAR1 > 0
			TIMES UP:14 , 1.10
			TIMES UP:17 , 1.10
			;マゾっ気が高ければ欲情加算
			SIF ABL:マゾっ気 >= 3
				UP:13 += 500
			IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
				TIMES UP:20 , 1.10
				TIMES UP:21 , 1.10
			ENDIF
		ENDIF
	NEXT
	;目覚めると緊縛されていた
	IF TFLAG:875 > 0
		TIMES UP:14 , 1.20
		TIMES UP:16 , 1.30
		TIMES UP:17 , 1.30
		;マゾっ気が高ければ欲情加算
		SIF ABL:マゾっ気 >= 3
			UP:13 += 800
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;目覚めると目隠しされていた
	IF TFLAG:876 > 0
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.40
		;マゾっ気が高ければ欲情加算
		SIF ABL:マゾっ気 >= 3
			UP:13 += 800
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;目覚めると口枷をされていた
	IF TFLAG:877 > 0
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.20
		;マゾっ気が高ければ欲情加算
		SIF ABL:マゾっ気 >= 3
			UP:13 += 800
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.20
			TIMES UP:21 , 1.20
		ENDIF
	ENDIF
	;目覚めると媚薬を投与されていた(注射で投与可能)
	IF TFLAG:878 > 0
		TIMES UP:13 , 1.50
		TIMES UP:15 , 1.50
	ENDIF
	;目覚めると触手を召喚されていた
	IF TFLAG:879 > 0
		TIMES UP:14 , 1.20
		TIMES UP:17 , 1.50
		TIMES UP:31 , 1.30
		;マゾっ気が高ければ欲情加算
		SIF ABL:マゾっ気 >= 3
			UP:13 += 800
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0 && ABL:触手中毒 < 3
			TIMES UP:20 , 1.30
			TIMES UP:21 , 1.30
		ENDIF
	ENDIF
	;目覚めるとビデオ撮影されていた
	IF TFLAG:880 > 0
		TIMES UP:14 , 1.20
		TIMES UP:15 , 1.40
		TIMES UP:17 , 1.20
		;マゾっ気が高ければ欲情加算
		SIF ABL:マゾっ気 >= 3
			UP:13 += 800
		IF TALENT:恋慕 == 0 && TALENT:淫乱 == 0
			TIMES UP:20 , 1.10
			TIMES UP:21 , 1.10
		ENDIF
	ENDIF
	
	;失神中の累積欲情値が一定以上
	SELECTCASE TFLAG:890
		CASE IS >= 10000
			TIMES UP:13 , 2.00
			TIMES UP:14 , 2.00
			TIMES UP:15 , 2.00
		CASE IS >= 6000
			TIMES UP:13 , 1.50
			TIMES UP:14 , 1.50
			TIMES UP:15 , 1.50
		CASE IS >= 3000
			TIMES UP:13 , 1.20
			TIMES UP:14 , 1.20
			TIMES UP:15 , 1.20
	ENDSELECT
	;失神中の累積苦痛値が一定以上
	SELECTCASE TFLAG:891
		CASE IS >= 10000
			TIMES UP:16 , 2.00
			TIMES UP:20 , 2.00
		CASE IS >= 6000
			TIMES UP:16 , 1.50
			TIMES UP:20 , 1.50
		CASE IS >= 3000
			TIMES UP:16 , 1.20
			TIMES UP:20 , 1.20
	ENDSELECT
	;失神中の累積薬毒値が一定以上
	SELECTCASE TFLAG:892
		CASE IS >= 10000
			TIMES UP:17 , 2.00
			TIMES UP:20 , 2.00
		CASE IS >= 6000
			TIMES UP:17 , 1.50
			TIMES UP:20 , 1.50
		CASE IS >= 3000
			TIMES UP:17 , 1.20
			TIMES UP:20 , 1.20
	ENDSELECT
ENDIF

;-------------------------------------------------
;今回実行したコマンドの種類をTFLAG:9に記録
;-------------------------------------------------
@CHECK_COM_KIND
;Ｖセックス系コマンド
IF GROUPMATCH(SELECTCOM, 20, 21, 22, 23, 24, 27, 28, 612, 613, 614, 615, 616, 617, 630, 632) || (SELECTCOM == 610 && (TFLAG:130 == 1 || TFLAG:131 == 1))
	TFLAG:9 = 1
;Ａセックス系コマンド
ELSEIF GROUPMATCH(SELECTCOM, 30, 31, 32, 33, 34, 37, 38, 618, 619, 633) || (SELECTCOM == 610 && (TFLAG:130 == 2 || TFLAG:131 == 2))
	TFLAG:9 = 2
;フェラチオ系コマンド
ELSEIF GROUPMATCH(SELECTCOM, 41, 54, 209, 230, 303, 304, 601, 602, 604) || (SELECTCOM == 610 && (TFLAG:130 == 3 || TFLAG:131 == 3))
	TFLAG:9 = 5
;素股系コマンド
ELSEIF GROUPMATCH(SELECTCOM, 43, 306, 629)
	TFLAG:9 = 10
;調教者のＶで逆レイプ系コマンド
ELSEIF GROUPMATCH(SELECTCOM, 25, 323, 324, 325, 651, 655)
	TFLAG:9 = 19
;調教者のＡで逆レイプ系コマンド
ELSEIF GROUPMATCH(SELECTCOM, 35, 333, 334, 335, 656)
	TFLAG:9 = 20
ENDIF
