;=============================================================================
;罵ってもらう
;=============================================================================
;--------------------------------------------------
;実行判定
;--------------------------------------------------
@COM_ABLE270
;個別設定コマンドフィルタ
SIF DITEMTYPE:999:270 > 0
	RETURN 0
;調教者奉仕・ウフフ系コマンドを有効にしてないとダメ
SIF (FLAG:15 & 2048) == 0
	RETURN 0
;奴隷がサド持ちまたはドＳ持ちまたはサドっ気Lv1以上じゃないとダメ
SIF TALENT:サド == 0 && TALENT:ドＳ == 0 && ABL:サドっ気 < 1
	RETURN 0
;睡眠中は不可
SIF EQUIP:睡眠薬
	RETURN 0
;パニック中は不可
SIF TFLAG:108 > 0
	RETURN 0
;失神中は不可
SIF TFLAG:899 > 0
	RETURN 0
;ボールギャグ使用中は不可
SIF TEQUIP:口装着器具
	RETURN 0
;時止め中は無理
SIF TEQUIP:時間止め
	RETURN 0
;距離のチェック
SIF EQUIP:戦闘中 && COM_ABLE_BATTLE(TARGET, PLAYER, 270) == 0
	RETURN 0
RETURN 1

;--------------------------------------------------
;コマンド本体
;--------------------------------------------------
@COM270
PRINTL 罵ってもらう

;戦闘判定
CALL COM_TRY_BATTLE, 270
;実行できない
SIF RESULT == 1
	RETURN 1

TSTR:0 = 罵ってもらう
CALL DISPLAY_KOJO_TRAIN_MESSAGE_F_COM

;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
DOWNBASE:0 += 0
DOWNBASE:1 += 20
DOWNBASE:PLAYER:1 += 15

SOURCE:主導権 = 250
SOURCE:達成感 = 30
SOURCE:恭順追加 = 30

;ABL:サドっ気をみる
IF ABL:サドっ気 <= 1
	TIMES SOURCE:主導権 , 0.8
	TIMES SOURCE:達成感 , 0.8
	TIMES SOURCE:恭順追加 , 0.7
ELSEIF ABL:サドっ気 == 2
	TIMES SOURCE:主導権 , 1.0
	TIMES SOURCE:達成感 , 1.0
	TIMES SOURCE:恭順追加 , 0.9
ELSEIF ABL:サドっ気 == 3
	TIMES SOURCE:主導権 , 1.4
	TIMES SOURCE:達成感 , 1.2
	TIMES SOURCE:恭順追加 , 1.0
ELSEIF ABL:サドっ気 == 4
	TIMES SOURCE:主導権 , 1.8
	TIMES SOURCE:達成感 , 1.5
	TIMES SOURCE:恭順追加 , 1.2
ELSE
	TIMES SOURCE:主導権 , 2.2
	TIMES SOURCE:達成感 , 2.0
	TIMES SOURCE:恭順追加 , 1.6
ENDIF

;ABL:調教者のマゾっ気をみる
IF ABL:PLAYER:マゾっ気 == 0
	TIMES SOURCE:主導権 , 0.9
	TIMES SOURCE:達成感 , 0.9
	TIMES SOURCE:恭順追加 , 0.9
ELSEIF ABL:PLAYER:マゾっ気 == 1
	TIMES SOURCE:主導権 , 1.0
	TIMES SOURCE:達成感 , 1.0
	TIMES SOURCE:恭順追加 , 1.0
ELSEIF ABL:PLAYER:マゾっ気 == 2
	TIMES SOURCE:主導権 , 1.2
	TIMES SOURCE:達成感 , 1.1
	TIMES SOURCE:恭順追加 , 1.0
ELSEIF ABL:PLAYER:マゾっ気 == 3
	TIMES SOURCE:主導権 , 1.5
	TIMES SOURCE:達成感 , 1.3
	TIMES SOURCE:恭順追加 , 1.1
ELSEIF ABL:PLAYER:マゾっ気 == 4
	TIMES SOURCE:主導権 , 1.8
	TIMES SOURCE:達成感 , 1.5
	TIMES SOURCE:恭順追加 , 1.2
ELSE
	TIMES SOURCE:主導権 , 2.0
	TIMES SOURCE:達成感 , 1.8
	TIMES SOURCE:恭順追加 , 1.5
ENDIF

;調教者がドＭ
IF TALENT:PLAYER:ドＭ
	TIMES SOURCE:主導権 , 1.5
	TIMES SOURCE:達成感 , 1.5
	TIMES SOURCE:恭順追加 , 1.5
	SOURCE:欲情追加 = 120
;調教者がマゾ
ELSEIF TALENT:PLAYER:マゾ
	TIMES SOURCE:主導権 , 1.2
	TIMES SOURCE:達成感 , 1.2
	TIMES SOURCE:恭順追加 , 1.2
	SOURCE:欲情追加 = 60
ENDIF
;ドＳ
IF TALENT:ドＳ
	TIMES SOURCE:主導権 , 1.5
	TIMES SOURCE:達成感 , 1.5
	TIMES SOURCE:恭順追加 , 1.5
;サド
ELSEIF TALENT:サド
	TIMES SOURCE:主導権 , 1.2
	TIMES SOURCE:達成感 , 1.2
	TIMES SOURCE:恭順追加 , 1.2
ENDIF
RETURN 1

;--------------------------------------------------
;調教時メッセージ
;--------------------------------------------------
@SYSTXT_TRAIN_MESSAGE_F_COM_270
PRINTFORML %CALLNAME:TARGET%は挑発するかのように%CALLNAME:PLAYER%の痴態を声に出して罵った…
