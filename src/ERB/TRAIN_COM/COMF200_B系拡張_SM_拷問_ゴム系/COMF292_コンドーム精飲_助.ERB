;=============================================================================
;コンドーム精飲(助手)
;=============================================================================
;--------------------------------------------------
;実行判定
;--------------------------------------------------
@COM_ABLE292
;個別設定コマンドフィルタ
SIF DITEMTYPE:999:292 > 0
	RETURN 0
;調教者奉仕・ウフフ系コマンドを有効にしてないとダメ
SIF (FLAG:15 & 2048) == 0
	RETURN 0
;触手調教中はダメ
SIF TEQUIP:触手調教
	RETURN 0
;助手がいないとダメ
SIF ASSI < 0
	RETURN 0
;それまでの調教でゴム射してないとダメ
SIF CFLAG:75 == 0
	RETURN 0
;助手が従順4以上かつ欲望4以上かつ奉仕精神3以上かつ精液中毒が3以上ないとダメ
SIF ABL:ASSI:従順 < 4 || ABL:ASSI:欲望 < 4 || ABL:ASSI:奉仕精神 < 3 || ABL:ASSI:精液中毒 < 3
	RETURN 0
;距離のチェック
SIF EQUIP:戦闘中 && COM_ABLE_BATTLE(TARGET, PLAYER, 292) == 0
	RETURN 0
RETURN 1

;--------------------------------------------------
;コマンド本体
;--------------------------------------------------
@COM292
PRINTL コンドーム精飲(助手)

;戦闘判定
CALL COM_TRY_BATTLE, 292
;実行できない
SIF RESULT == 1
	RETURN 1

TSTR:0 = コンドーム精飲(助手)
CALL DISPLAY_KOJO_TRAIN_MESSAGE_F_COM

;-------------------------------------------------
;実行決定
;-------------------------------------------------
;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
DOWNBASE:0 += 0
DOWNBASE:1 += 30

SOURCE:欲情追加 = 500

;ABL:欲情をみる
IF ABL:欲望 == 0
	TIMES SOURCE:欲情追加 , 0.25
ELSEIF ABL:欲望 == 1
	TIMES SOURCE:欲情追加 , 0.50
ELSEIF ABL:欲望 == 2
	TIMES SOURCE:欲情追加 , 0.75
ELSEIF ABL:欲望 == 3
	TIMES SOURCE:欲情追加 , 1.00
ELSEIF ABL:欲望 == 4
	TIMES SOURCE:欲情追加 , 1.25
ELSE
	TIMES SOURCE:欲情追加 , 1.50
ENDIF

;ABL:精液中毒をみる
IF ABL:精液中毒 == 0
	TIMES SOURCE:欲情追加 , 0.10
ELSEIF ABL:精液中毒 == 1
	TIMES SOURCE:欲情追加 , 0.40
ELSEIF ABL:精液中毒 == 2
	TIMES SOURCE:欲情追加 , 0.70
ELSEIF ABL:精液中毒 == 3
	TIMES SOURCE:欲情追加 , 1.00
ELSEIF ABL:精液中毒 == 4
	TIMES SOURCE:欲情追加 , 1.30
ELSE
	TIMES SOURCE:欲情追加 , 1.60
ENDIF

;助手の口に精液汚れ
STAIN:ASSI:口 |= 4

;コンドームの精液を初期化
CFLAG:75 = 0
RETURN 1

;--------------------------------------------------
;調教時メッセージ
;--------------------------------------------------
@SYSTXT_TRAIN_MESSAGE_F_COM_292
PRINTFORML %CALLNAME:MASTER%は%CALLNAME:ASSI%に使用済みコンドームを手渡した……
IF TALENT:ASSI:サド
	PRINTFORM %CALLNAME:ASSI%は%CALLNAME:TARGET%が舌をのばせば届きそうなぐらいの距離で、
ELSE
	PRINTFORM %CALLNAME:ASSI%は%CALLNAME:TARGET%に見せびらかすように
ENDIF
IF ABL:ASSI:精液中毒 == 5
	PRINTL 恍惚の表情で精液を味わっている……
ELSE
	PRINTL おいしそうに精液を味わっている……
ENDIF

IF EQUIP:睡眠薬 == 0 && TFLAG:899 == 0
	PRINTFORM %CALLNAME:TARGET%は
	IF ABL:精液中毒 == 0
		PRINTL その光景に呆れた顔をしている……
	ELSEIF ABL:精液中毒 < 3
		PRINTL 必死に目をそらそうとしているが、その目は目の前の光景に釘付けになっている……
	ELSEIF ABL:精液中毒 < 5
		PRINTL 物欲しげな表情でじっとその光景を見ている……
	ELSE
		PRINTL 我慢できないのか、涎を垂らしながらその光景を見ている……
	ENDIF
ENDIF
